[
  {
    "segment_id": "c8026cdd-4079-4c97-ab39-1aa3448491d9",
    "episode_id": "6416a8ae-bab1-4deb-a74f-ce75dfbc0358",
    "episode_number": 473,
    "segment_number": 6,
    "text": "Хорошо. Саша, ты не придумал тем на эту неделю? Из разряда чему я ничему не научился абсолютно вообще. Ну тогда на этой дилетантской ноте мы перейдем к архитектурным трейдофам, которые нам хотел поделать Ваня. Да, эту тему я притащил очень давно к нам в бэклог, но и, по-моему, даже кто-то из слушателей задавал спасибо вам за это. Но просто не находилось времени прочитать, а тут я прочитал и вот хотел немножечко обсудить. Меня очень зацепило название статьи, как потом оказалось об этом внутри не так много, но как бы в целом статья показалась в любом случае интересной Название статьи такое что Архитектурные трейд оффы это искусство минимизации несчастья несчастливости не знаю как это правильно сказать Не приумножения страданий. Да, спасибо большое. У меня тут это просто огромное шумо на заднем фоне. Я завидился и помолчал немножечко. Мы поняли. Мне вспоминается бывший коллега, который говорил: Пользователи не должны страдать. Во всяком случае не больше, чем они страдают обычно. Да-да-да. Я думаю здесь речь про страдания разработчиков. Да, здесь речь про страдания не только разработчиков, но и архитекторов, которые делают дизайн архитектуры приложений или каких-то проектов. Основная идея на самом деле наверное как раз в названии и отражается. Чуть больше я сейчас по пунктам пройдусь. Пак-пак-пак, да. Основной навык, который полезен у архитектора это умение делать, понимать в чём состоит trade of'ы и умение делать выбор в этих трейд-оффах. Как правильно перевести trade-off? Это Компромисс. Компромисс. Ну да, в русском языке на самом деле слово компромисс не полностью отражает сущность. Trade-off это такая вещь, когда у вас есть несколько возможных способов, куда вы можете двинуться, или способов решения проблемы. У каждого есть свои плюсы и минусы, свои достоинства и недостатки. И выбирая какой-то путь решения, какой-то путь развития, вы всегда должны понимать правильно, в чем плюсы и минусы каждого, и четко понимать точку, в которую вы хотите попасть. И вот это сравнение всего это trade of, а умение сделать выбор в этом trade of это как раз найти эту точку. Компромисс поэтому немножечко неточно, но, наверное, ближе ничего не получится. Ты буквально дал определение слову компромисс по этому сценарию. Нет, нет. В смысле да, но нет. Я не знаю, я готов поспорить на эту тему, я готов защищать свою точку зрения. Я считаю, что компромисс это чуть более широкое понятие, а а трейдов в Software Engineering это совершенно точное определение, более узкое. Тогда объясни, в чём различия. В более широком определении компромисс это есть в бытовом понимании компромисс это есть два мнения, и надо найти такое мнение, с которым согласятся оба. Смотри, разница в том, что у тебя в разных языках одно и то же слово может означать нести разный смысл в зависимости от контекста. Именно. Ты говоришь о компромиссе, когда у тебя там компромисс между двумя людьми или компромисс между какими-то двумя сущностями. Это тоже компромисс, но это другое значение того же слова, очень близко к этому. Именно так. И вот это называется коннотация. У каждого слова есть коннотация. Это дополнительные значения, которые из других смыслов приходят в этот смысл. Именно поэтому компромисс в русском языке немножечко не то, что trade of в английском. Я с тобой здесь полностью согласен, я поэтому так и говорю. Но не суть, пошли дальше. И в статье рассматривается этот вопрос с разных точек зрения. Мне понравилось несколько пунктов, давайте я их по очереди пройду. Итак, компромисс это всегда тыканья пальцем в небо. То есть когда ты делаешь выбор в любом трейд-оффе, ты всегда не знаешь, что на самом деле у тебя будет в будущем. Ты всегда не знаешь точно, какие будут требования у пользователей, какая будет нагрузка, какие будут паттерны поведения и так далее, и так далее. Поэтому, когда ты делаешь какой-то выбор, ты всегда делаешь такое предположение, основанное на своих догадках и предыдущем опыте, но это всегда пальцем в небо. И, соответственно, когда ты делаешь подобную догадку, ты очень часто можешь оказаться неправ. Вот эта вот неправость, она всегда экзультирует в том, что ты получишь какие-то проблемы в будущем. И поэтому чем больше ты работаешь с системами, тем больше ты хочешь и чем больше ты находишь эти трейдов и делаешь какой-то выбор, и находишь эти компромиссы, тем больше ты хочешь минимизировать свою будущую несчастливость, несчастность. Я забыл, как Валера, ты здорово перевел. Прости, буду говорить. Минимизировать свои страдания. Минимизировать страдания, да. Ну тут больше про счастье. Ну да, согласен, страдания тоже подходят. И соответственно, когда ты, когда, когда А, в качестве примера привели классный пример, что в квантовом computing, в квантовом вычислении, в квантовом вычислениях, в системе квантовых вычислений было много трейдов, было много разных необходимо было найти много разных компромиссов. И сделали компромисс о скрытии деталей реализации и сложных каких-то вещей для того, чтобы упростить работу учёным, которые не понимают этого, с квантовыми вычислениями. То есть упростили, грубо говоря, упростили UIUX для того, чтобы скрыть какие-то детали имплементации. Вот и вышла статья здесь, там дается ссылка на эту статью, что вот этот вот tradeoff и вот этот конкретный выбор, который сейчас тяжело поменять, который приняли какое-то время назад, привел к лимита к ограничению производительности. То есть именно выбор решения привел к тому, что мы сейчас не можем полностью, на полную воспользоваться нашим железом для того, чтобы получить то, что мы могли бы получить. Вот, это довольно интересно. Вот. Все компромиссы, которые мы, как мы помним этот тычок пальцем в небо, они всегда не могут быть идеальными. Как мы уже объясняли выше, я так и не понял про тыканье пальцем в небо, когда у меня есть проект. И я понимаю, что любой проект, большинство проектов в инженерии, которые мне приходят на ум, это, как правило, компромисс между стоимостью, повторяемостью и каким-то перформансом, который ты как-то измеряешь. Но когда я этот проект проектирую, я выбираю компромисс, выбираю трейдов, но не тыкаю пальцем в небо. Я просто знаю, что вот эти компоненты дешевые. Да, у него перфоманс будет, наверное, не так хорош, как на дорогих компонентах, зато он будет дешевый и повторяемый. Я хочу, чтобы мой проект был дешевым и повторяемым, поэтому я выбираю этот трейдов. Я не тыкаю пальцем в небо. Поэтому мне не очень понятно, когда ты говоришь, что любой компромисс это гадание на кофейной гуще. Это очень хороший вопрос. Давай послушаем ответ Валеры на этот вопрос. Валера, что ты думаешь по этому поводу? Я склонен согласиться с Сашей, потому что когда они на кофейной гуще, предполагая, что мы ничего не понимаем о том, что мы делаем. Мне кажется, обычно мы что-то понимаем. Забавно, что этот вопрос был переадресован Валере как главному специалисту по кофе. Вот ты специалист по кофе, поэтому вопрос о гадании на кофейной гуще передает с тебя. Нет, я тебя хотел спросить. Я еще хотел Алекс спросить. Алекс, ты что думаешь? Я на самом деле думаю несколько вещей по этому поводу. Во-первых, отчасти я согласен с Ваней, мы никогда не можем предсказать будущее точно. Например, если мы пытаемся оптимизировать производительность, мы можем сделать некоторую догадку на основе предыдущего опыта, но, допустим, точно гарантировать, что профиль нагрузки будет именно такой, как мы сейчас думаем, ну строго говоря, это маловероятно, что мы будем 100% правы. Возможно, он будет похожий, но возможно, спустя некоторое время у тебя нагрузка эволюционирует в другую форму, и ваша оптимизация и ваши компромиссы, которые вы выберете сейчас, начнут вам мешать. Поэтому в этом смысле это действительно догадки, но они информированные. И одна вещь, которая на самом деле мне вот в работе хорошо помогает справляться с этими догадками, это сесть и попытаться выделить предположения, которые, я не знаю, негласные предположения, которые у всех как бы где-то там в уме есть, но которые не озвучиваются. Зачастую вот в этих не озвученных предположениях и сидят возможности ошибиться и предсказать неверно. Я дополню чаще всего все споры, которые происходят в команде, они вот именно в этих не озвученных, неформализованных допущениях. Продолжай, пожалуйста. Это тоже правда, да. Для меня наверное в этом процессе важно то, что все вот эти предположения, которые просто были сделаны по какому-то негласному консенсусу, на самом деле они несут риск, что мы не рассмотрели тщательно альтернативы этим предположениям. И даже несмотря на то, что на практике, там не знаю, в 70% случаев это предположение разумное, правильное, построено на основании, там не знаю, пяти лет опыта работы с этой системой, а в остальных 30 процентов посмотреть критически на то, что вы предполагали, там о профиле нагрузки, о типе пользователя, о проблемах, с которыми придут к вам пользователи и тому подобных вещах, о том, что важно пользователям, о том, что важно для, не знаю, заработка денег. Попытаться проверить на прочность эти предположения зачастую имеет материальную и положительную результат на информированность компромиссов, которые вы принимаете. И в этом случае гадание на кофейной гуще получается чуть более научным, чем если просто почесал затылок и сказал как думаешь? Что вы по этому поводу думаете? Вы с ним сталкивались? Я в целом согласен с твоей мыслью. Я не согласен с автором статьи, который вместо того, чтобы написать, что выбирая компромиссы, вы как-то эвристически предсказываете будущее, и может быть не очень точно, он говорит, что вы просто тупо тыкаете пальцем в небо. Для меня есть разница между тыкать пальцем в небо и пытаться эгоистически предсказать результат. В одном случае я просто делаю на рандом и получу хрен пойми что. В другом случае я предполагаю, что если моя модель мира относительно верна и относительно точна, то я получу результат, близкий к ожидаемому. В этом случае ты никогда не можешь получить точно ожидаемое? Я говорю о том, что вот эта метафора автора про тыканье пальцем в небо это очень сильный эпитет Ну может быть он там сказал информированный тыканье пальцем в небо я точно не помню дословно но как бы вы сейчас здорово обсудили ровно то, что он описывает в статье. Но к этому нужно добавить, что обычно разработка какого-то проекта, какого-то продукта это итерационный процесс, как раз в силу причин названных выше. Я еще хотел добавить к этому, что качество компромиссов сильно зависит от того, насколько вы находитесь на острие прогресса. Если вы там делаете первую в мире распределенную полностью консистентную базу данных, то скорее всего у вас есть какие-то догадки о том, как работают базы данных вообще, но именно новизну распределенности и консистентности, скорее всего большое количество ваших догадок будет неправильным. Если вы делаете пятую такую базу данных и вам есть на что посмотреть, то тут уже это меньше догадки и больше анализ чего-то чужого опыта. Это уже гораздо более качественные компромиссы. В некотором смысле это действительно итерация, просто первые итерации сделали другие люди. Да, на самом деле вы многое обсудили из того, что у меня в заметках сказано. В частности про итерации, которые Саша рассказал. Автор тоже говорит, что итерации это один из способов снизить риски в предсказаниях и понемножку продвигаться к тому состоянию, куда вы хотите двинуться. То есть делать MVP, потом проверять свои гипотезы, потом делать следующие предположения, делать следующие версии и так далее, и так далее. Плюс обучение. Про это он тоже написал, что не обязательно учиться на своих ошибках. Можно попытаться использовать чужой опыт. Прочитайте статьи, поглядите пейперы, почитайте книги, и у вас повышается осознанность, повышается количество знаний, которое приводит к тому, что вы сделаете с большей вероятностью более правильный выбор, чем неправильный выбор. Вот. Дальше или еще что-то? Какие-то есть возражения? Тогда дальше. Дальше он делает большое отступление в сторону того, что вот этот компромисс, он не должен быть идеальным. Вы не должны пытаться искать идеальный компромисс, потому что его тяжело найти, если вообще возможно. И правильнее искать достаточно хороший компромисс. То есть вот вы увидели выбор между разными вариантами, найдите то, которое вас более-менее устраивает, с которым вы сможете жить, сделайте быструю итерацию, попробуйте это в деле, поглядите, как всё работает, двигайтесь дальше. Вот, и напоследок он даёт список советов как раз, как резюме того, что как правильно подходить к рассмотрению этого вопроса для того, чтобы получилось лучше с результатом. Первое больше Как это правильно перевести? Больше получайте опыта, больше учитесь для того, чтобы становиться лучше в поиске трейдов и альтернатив. То есть трейдов мы обсудили, альтернативы это как бы вы всегда должны пытаться для любого решения и для любой вот то что Алекс говорил каких-то дефолтных установок, вы должны всегда пытаться найти альтернативное решение, альтернативные причины и т. Д, и т. Д. То есть везде видеть возможность ветвления, тогда вы будете лучше представлять эту область. И вот этот навык, он нарабатывается, вы можете этому научиться, вы можете почитать больше статей, книг и т. Д, и это станет у вас сильной стороной. Как следствие, если вы так получилось, что вы работаете над задачей, где вы не понимаете, что вы делаете, сделайте MVP как можно скорее. Вы не понимаете, что происходит, но сделайте MVP. Это даст вам опыт, вы поймете, к чему привели выбранные вами компромиссы. И этот MVP можно будет выбросить. Вы не так уж много в него времени и сил вложили. И сделать следующую итерацию уже с учетом приобретенного опта. Да, всё так. Второе не ожидайте, что кто-то, что-то, в частности какая-то технология, в скобках AI, сделает за вас выбор. Он говорит, что автор говорит, что в последнее время часто видит людей, которые приходят к ChatGPT и говорят: слушай, вот у меня такой вопрос, найди мне решение. Вот, он говорит это не работает. Ну, по крайней мере пока. Третье улучшайте свой навык в построении каких-то гипотез и проведении очень быстрых, очень дешёвых экспериментов для того, чтобы быстро получить результат и ответ на ваш вопрос, на гипотезу. То, что Саша сказал. Четвёртое. Будьте готовыми и увеличивайте свой навык признавать свои собственные ошибки. О том, что вы предыдущую гипотезу или по пять гипотез назад в чём-то ошиблись, чтобы как можно быстрее развернуться и пойти в слегка другую сторону. Чем позже вы исправляете ошибку, тем больше вы за это заплатите. Поэтому если вы будете быстро признавать свои ошибки, вы будете меньше за это платить. Ну да, последнее это как раз про цену ошибки. Я не знаю, вы видели этот график или нет. Стоимость исправления ошибки на раннем этапе написания RFC это пять минут разговора с каким-то человеком, а на позднем этапе это миллионные чеки за стоимость работы компании, покупки железа и так далее, и так далее. Вот это вкратце всё. Но как вы видите здесь мало что есть про минимизацию страданий. Я хотел именно с точки зрения страданий прочитать статью, а оказалось, что там про это не так много. Я бы хотел, чтобы каждый пункт был написан в виде, не знаю, вот это была боль, а вот здесь будет меньше боли, а вот здесь будет больше боли с какими-то отсылками на какие-то пейперы, было бы любопытно. Мне кажется это очень сложно сделать вот так вне контекста какого-то конкретного проекта. Я не согласен, что вот этот выбор компромиссов простите, здесь кошечка трётся микрофон и бьётит его в процессе что выбор компромиссов является его целью является минимизация несчастья. Вы в любом случае будете несчастны. Безотносительно выбора конкретных компромиссов вы будете несчастны по разным причинам. То есть либо, как в примере выше, компоненты дешёвые хорошо, но перфоманс плохой. И вы несчастны из-за плохого перформанса в вашем проекте. Либо наоборот перформанс отличный, но проект не повторяемый. То есть несчастны вы будете всегда. Но вы можете утешить Поверь мне, Саша, бывает, что у тебя и компоненты дорогие, и качество плохое, и вы ещё более несчастные, чем у тебя. Хороший аргумент, принимается. Но я хотел сказать, что вы можете себя утешить тем, что конкретный проект, завершённый и доведённый до конца это конкретный пройденный путь, конкретные выбранные компромиссы, конкретный результат. И хоть сам проект получился неидеальным, вот то, что вы прошли этот путь, то, что вы его, если вы сообразительный код, вы его задокументировали, вы его выложили на GitHub. Вот он на GitHub лежит. Да, он не идеален, но он вот какой есть. И вы знаете, что если делать так, то результат будет следующим. Этот пройденный путь он сам по себе уникален и ценен. Ищите утешение в нём. Я наверное добавлю к плюсану Саши и добавлю, что пройти путь до конца это на самом деле суперважно. И возможно непопулярное мнение в нашей индустрии, но тот факт, что зачастую в нашей индустрии время работы на одном месте это 2-3 года, это начинает сильно мешать на более старших этапах карьеры, когда у тебя просто нет шанса увидеть последствия твоих решений. И это сильно осложняет обучение на своем собственном опыте. Я человек, который работает больше трех лет в одном месте, не согласен. Все равно не помогает. Ты в том плане, что даже в рамках одного места слишком часто меняются штуки, чтобы увидеть как твои решения дожили до продакшена, потому что они не дожили? Это вопрос мне или Алексу? У тебя да Мои решения они доезжают все в гитлоге, все на прозе Тогда не очень понял почему был твой комментарий. Я не согласен с тем, что если работать в крупной компании Я понял, то есть получается Алекс со мной типа соглашается, что в компании нужно работать долго, чтобы увидеть свои решения на фронте. Да. Но у постгресса годовой цикл, поэтому всё равно не принимается. Но я согласен, что в общем случае Через год оно будет принято на прот. А теперь нужно еще пару лет посмотреть, как оно там себя потом вело. К тому же PostGress это немножко особый случай. Он опенсорсный. В принципе, последствия видны на всю индустрию. Если ты работаешь над, не знаю, бэкендом для доставки пиццы, может быть, ты увидишь, что у них прилег бэкенд два года спустя. Но связано ли это с твоими архитектурными решениями три года назад или нет? Это большой вопрос. Я понял. То есть, твой аргумент был про то, что обычно инженеры работают в компаниях 2-3 года но работать нужно дольше, чтобы увидеть результат. Правильно? Я не хочу сказать, что работать нужно дольше. Я говорю, что это сильно осложняет обучение на собственном опыте. Просто теряйте эту возможность. Теперь я понял. Но тут я скорее согласен, чем нет. Мне кажется, отсюда есть следствие, что по возможности стоит пытаться находить работу, где вы задержитесь дольше чем два года. Я понимаю, что это не всегда осуществимо. Сам многократно сталкивался. Но тем не менее, если это будет одним из критериев при поиске работы это скорее выгодный критерий, чем нет. Имеет смысл? Наверное, есть компромисс, смотря что ты оптимизируешь. Если ты оптимизируешь рост собственной зарплаты, то прыгать с места на место каждые два года говорят, что гораздо эффективнее. Если ты оптимизируешь удовлетворение от собственной работы, свое мастерство ради искусства, то да, наверное, работать дольше на одном месте это лучше. А сколько раз нужно прыгать, чтобы больше не испытывать необходимости в прыжках с целью увеличения зарплаты или это бесконечно работает? А насколько ты жадный? Нет, я имею ввиду, что у тебя все равно по индустрии есть какой-то потолок зарплат для инженеров, даже какого-то uber уровня. И вот представим себе, что ты в течение 20 лет работаешь в инженерии, каждые 2 года прыгаешь, за счет чего получаешь свою прибавку к зарплате, но ты все равно рано или поздно, в моем понимании, упираешься в некий потолок. Или утверждается, что потолка не существует? Ну это такой вопрос провокационный, потому что в современной индустрии слоев, вероятно, ситуация немножко другая. С третьей стороны, я вообще неправильный человек, чтобы на этот вопрос отвечать, потому что я уже девятый год работаю на своем месте и пока не собираюсь уходить. Ты увидел результаты сделанных трейд-оффов? К сожалению, некоторые увидел. Я даже был онколл в это время. Мне кажется, мы хорошо эту тему обсудили. Я хотел ответить, Алекс, что могло быть хуже. Ты мог быть он-колл и увидеть результаты трейд-оффов, сделанных кем-то другим. Такое я тоже видел. Больше раз. Моя работа быть профессиональным пессимистом, поэтому в целом я Ох, наверное, Вселенная меня накажет за то, что я говорю. Но в целом мои трейд-оффы довольно консервативны и редко выстреливают в мою ногу. Но с другой стороны у меня есть много хороших знакомых оптимистов, которые делают другие придурки. Нет, ну ты скажешь, с другой стороны у меня много хороших ног. К сожалению, ног у меня всего две, поэтому я их берегу. Что мы еще бережем? Это наша тема слушателей. Так, сейчас, ожидай. Погоди-погоди, я занесу свою маленькую часть. А давай давай давай давай. Я хотел в прелло занести, но потом у меня не получилось залогиниться, поэтому извините, я потом ссылочку в чат положу.",
    "result": {
      "error": "API request failed: Error code: 400 - {'error': 'Trying to keep the first 5730 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input'}",
      "stack_trace": "Traceback (most recent call last):\n  File \"/home/andrei/Projects/podcast-shownotes/scripts/build_search_eval_dataset.py\", line 157, in generate_search_query\n    response = await self.client.chat.completions.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py\", line 1927, in create\n    return await self._post(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1767, in post\n    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1461, in request\n    return await self._request(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1562, in _request\n    raise self._make_status_error_from_response(err.response) from None\nopenai.BadRequestError: Error code: 400 - {'error': 'Trying to keep the first 5730 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input'}\n"
    }
  }
]