[
  {
    "segment_id": "f9bdb399-b6ed-449e-bff2-88ac2076588a",
    "episode_id": "ac1a041f-7c68-4246-b98f-c38f57958cb5",
    "episode_number": 276,
    "segment_number": 16,
    "text": "И тебе нужно пытаться Ретрайт транзакцию из разных мест А перед тем, как ты ее ретраешь, тебе Возникает вопрос А хочешь ли ты вернуть connect в pool Например, чтобы Может, он кому-то сейчас тоже нужен А ты такой бесконечно ретраешь Ну, там Может быть ты этого хочешь, может быть нет Короче, нам приходится думать Но оказывается В Pbx нет вот такой Или я не нашел Нет специальной ошибки, которая Говорит, что твою транзакцию надо заретрать Поэтому что мы делаем Мы берем ошибку Кастуем ее в string И в этом string ищем substring И я ничего не имею против того Чтобы искать Ну, в целом, не имею ничего против того Чтобы искать string в substring Но за тем исключением Что это не очень эффективно Ну, в смысле, это медленно Так, я против этого метода ничего не имею И в такие моменты У меня возникает очень сильное желание Пиши на java Или если нельзя на java, то хотя бы на kotlin Где у тебя просто есть исключение И ты просто пишешь код И не думаешь про то, где у тебя Может Забор твоей транзакции Законфликтовать Александр, я вас осуждаю Почему? Ну, как бы, вспомни, с чего мы начинали Ты должен хотеть не на java писать, не на kotlin Ты должен хотеть писать на языке Где у тебя тип эффекта Вернет какой-нибудь Не знаю, left write Что-нибудь С которым будет заведена такова-то аккуратненькая ошибка И ошибка будет строго типизирована И ты просто сможешь паттерн матчить по ней Вот, что ты должен хотеть на самом деле Ну, это уже совсем в идеальном мире, конечно Left write, да, и вот прям Конкретная ошибка, которая тебе конкретно говорит Что, чувак, надо заретрайс Но Я немножко реалист Я понимаю, что Postgres От версии к версии меняется И у него меняются коды ошибок И тексты ошибок, и еще что-то И просто из драйвера понять, что Эту транзакцию заретрайсить трудно И тебе нужно прийти в комьюнити И объяснить, что у нас такой сценарий И мы хотим систему эффектов Поэтому не могли бы вы в пакетах Передавать флажочек, что вот эта ошибка Она означает, что надо ретрайс При этом Postgres еще должен понимать Демантику того, что ты делаешь И это нужно пробросить по всему коду Ну, ты понимаешь, да, где начинает сложиться Мне кажется, ты усложняешь Мне кажется, что просто вот эту строку за тебя должны распарсить Обертка для твоего моднейшего Строго типизированного языка И по каким-то ключевым словам Просто тебе выдать тип Этой ошибки Так я тебе и говорю, что у тебя в следующей версии Postgres Эта строка может поменяться Более того Она, конечно, может, но Я не думаю, что Postgres это ломал, потому что Как раз таки Postgres полагает, что ты посмотришь в эту строку И поймешь, что тебе делать Более того, знаешь, что есть в Postgres? Что же? Я тебе подскажу, начинается на И и заканчивается на Н И посреди 18 букв, как в поле чудес Интернационализация, да Да, именно, есть И вы переходите во второй тур И поэтому Вот этот, на самом деле Поиск под строк это Там же в этой строке Есть код ошибки этой SQL state, который? Да, он обычно, по-моему, не меняется Именно потому, что там есть Потому что очень многие драйверы Не знаю, Рубеву, по-моему, драйвер Когда тебе эксепшн кидает, там та же самая Java Она знает, как Сформировать, потому что она посмотрела на этот код Ну, может быть Но так или иначе Сейчас этого нету Поэтому, если вы используете PGX, знайте, что Транзакция может поиметь конфликт Абсолютно в любом месте И это нужно хендлить, потому что в Go надо все хендлить Я, собственно, вел к тому, что я не хочу Везде это хендлить Я хочу это обернуть в один блок И в конце написать, что, а если был конфликт, то заретрайс Вот, но в Go так нельзя А если вы не используете PGX Но используете что-нибудь другое Тоже имейте это в виду Я хотел бы, чтобы Сейчас кто-нибудь за меня поговорил Ну, я про следующие темы Ну ты же книжку решил на Амазон заказать Ну ладно Что ж Блин, там все твои темы Что же делать-то, ёлки-палки Ты видишь, да, все проблемы Да, ладно, я нашел одну темку свою В общем, это, на самом деле, с легким Душком темка, потому что она произошла, по-моему Неделю-две назад, но поскольку мы болели Вот, и вообще путешествовали И, короче, не могли мы Собраться в очередной раз Она долежала до сегодняшнего дня Тема такая, что Sony Компания, которая делает приставки, телевизоры А также иногда камеры Они К своим камерам На данный момент поддерживаться будут Сольные Sony Alpha R4 7R4 И, по-моему, Alpha 9 II Вот, это топ высшие камеры Обещают потом расширить До более До более Крестьянских, рабочих-крестьянских Камер расширить SDK Да, собственно, SDK делают Можно будет просто взять, скачать себе Какой-то вот SDK И своими, короче Грязными ручонками добраться до Данных с камерой Даже взаимодействовать, заставлять Ее снимать, что-нибудь отдавать вам, ровки Это и раньше люди делали,",
    "result": {
      "query": "Postgres retry transaction handling"
    }
  }
]