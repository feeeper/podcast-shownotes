[
  {
    "segment_id": "d478752b-3f02-4268-aa2d-1354e44fde45",
    "episode_id": "98000153-80a0-43bc-8186-928ed567de9b",
    "episode_number": 215,
    "segment_number": 8,
    "text": "Серия из 6 постов, но посты короткие, поэтому это скорее такая одна статья среднего размера. И повествует она о следующем, что автор работал в некой компании, циск Portculis, и интересовался реверсингом и всяким таким, и кто-то из коллег дал ему задачку, я так понимаю это типа крякмя, то есть ему дали Dump, и как бы сформулировали задание так, что перед тобой Dump прошивки для ESP8266, который был в устройстве, который мы нашли воткнутым в какой-то роутер. И мы считаем, что это устройство куда-то сливало очень секретные данные, поэтому не мог бы ты зареверсить эту прошивку и разобраться, что она делает, куда она что сливает. И интересна эта серия постов тем, что фактически перед человеком был бинарный файл, там объемом не знаю, несколько мегабайт, наверное, и о нем ничего не известно. То есть не известен его формат, неизвестно с какого места он начинает выполняться, ничего не известно, и ему нужно разобраться в этом. И вот он описывает пошагово, как он разбирался, потом он писал небольшое расширение для IDPro, которое помогало ему это дело реверсить. Он изначально не знал вообще ничего про ESP8266, по Гугли узнал, что там используется архитектура процессора под названием Extensa, нагуглил к ней ISA, то есть как бы набор инструкций, его описание, ассемблера. Также вообще тут из этой статьи можно унести, что не следует пренебрегать Гуглом и не следует пренебрегать возможностью спросить что-то в интернете у кого-либо, там в чате неважно, потому что оказалось, что есть по этой теме некоторые наработки, то есть он нашел несколько скриптов на GitHub, которые ему в этом непростом деле пригодились, и в конечном счете он один засемблировал программу, он нашел, куда она ходит, там использовался некий сервер, который по умолчанию закрыт ото всех, ну там используется KnockD, то есть нужно в определенном порядке постучаться на определенные порты, и тогда этот сервер начинает тебя пускать, и когда он до конца дошел, ему показалось сообщение, что типа молодец, кряк мне пройден, и твой флаг он такой-то, ну то есть традиционно в Capture the Flag и кряк мне твоей целью является добыть какой-то флаг, который просто хитрая строчка, код, обладая которым ты можешь доказать, что ты задание прошел. Интересна эта серия статьи тем, что она довольно толково и интересно написана, просто ее интересно читать, и главная мысль, которую я для себя унес, что какой бы бинарный формат у вас не был, какой бы хитрый проприетарный код у вас не был написан, все равно всегда найдутся люди, ну при условии, что они по какой-то причине заинтересованы в том, чтобы инвестировать свое время в исследование этого формата, они в конечном счете все равно разоберутся. Особенно в embedded, где как правило люди не особо обфуцируют или как-то защищают код. Есть ли по этой статье вопросы или дополнения, возражения? Может кто-то считает, что проприетарный формат никогда никто не рассказывает? Всегда все рассказывают, было бы желание и деньги. Мне кажется вот интересно, почему ты считаешь, что в embedded не обфуцируют, мне кажется может быть sensitive embedded, где могут и обфуцировать. Он может быть, но к нам приходили гости с прошлого Zero Knights, у которых я, ну они вот прям специализируются, у них работа такая, реверсить embedded, и я специально их в секции вопросов после доклада спрашивал, часто ли вы встречаете какую-то обфускацию или антиотладочные приемы в embedded, они почесали голову и сказали, что ну никогда. То есть это возможно, но это не принято. Ну почему-то это не используется. Я думаю основная причина в том, что если ты разрабатываешь что-то для микроконтроллера, например, то микроконтроллер у него есть фьюзер, то есть ты можешь ему программно сказать, что я залил в тебя окончательную версию фирмваря и теперь закроюсь ото всех и никому это не показывай. Поэтому у тебя нет смысла усложнять программу, чтобы она там выполняла что-то лишнее, грелась и я в батарейку, ты можешь просто аппаратно ее от всех закрыть. То есть в этом случае, конечно, у тебя, если ты реверсер, у тебя в этом случае, конечно, проблема, но с другой стороны, если такие фьюзы не были выставлены, то у тебя вся программа как на ладони. Иногда их не выставляют по той причине, что хочется предусмотреть возможность обновить прошивку, если вдруг в ней найдут серьезные дефекты. В фьюзе, например, в VR микроконтроллерах мы можем выставить фьюз, что у нас прошивочка окончательная и все, типа, мы зашили, берется потом High Voltage программер и можно перепрошить. Это нельзя, как правило, сделать прямо в схеме, то есть надо или выпаивать, или из кроватки вынимать, но есть возможность обойти фьюзы и как минимум новую прошивку накатить. Не факт, что можно считать защищенную, наверное, все-таки это окончательно закрывается, но перепрошить можно. В одном из DevZen'ов не так давно мы обсуждали paper про атаку на микроконтроллеры ARM, по-моему, это были LPC какие-то, атака с помощью Glitch'а, то есть в нужный момент, если питание микроконтроллера в нужный момент определенным образом падает, то можно частично обойти фьюзы и в конечном счете сдобить все. Я думаю, если погуглить там типа ARM Glitch'ing Paper, то вы без труда найдете. Можно еще в железке ставить микроконтроллер с однократным прошиванием. У таких микроконтроллеров обычно нет возможности считать прошивку. Ну или есть такие, у которых просто так не считаешь, они фабрично программируются один раз и все. Ну и разрабатывать под них чуть менее приятно. А, и у тебя есть просто версия специальная, которая перепрошиваемая, она с такими же абсолютно характеристиками электрическими, ты просто надев в бордах, используешь ее, а при производстве просто закладываешь запеченные микроконтроллеры уже, которые с однократным прошиванием. Прикольно, я думал ты скажешь, что есть симулятор, но... Симуляторы тоже есть, и раньше это в том числе было оправдано, потому что однократные прошивания микроконтроллера были в общем-то прилично дешевле, то есть там просто стоял флеш-память сильно попроще, вот, была разница, а сейчас есть какие-то супер микрокопейшные микроконтроллеры с однократным записыванием, вот, китайцы любят такие штуки делать, вот, это обычно какие-то маленькие восьминожки, там с ледоедиком помигать, но вот они однократно прошиваемые. Недавно слушал подкаст Noise Security Beat с отчетом про конференцию Black Hat, и не только Black Hat, но и DEFCON, и есть еще интересный вид атак на железо, не гличинг по напряжению питания, а электромагнитный, и была показана демка, где у тебя работает какой-то микроконтроллер, там зажигает, например, все время красный светодиод, и если его поместить в особо интенсивное электромагнитное поле, специально сгенерированное, то он пропускает инструкции, и в итоге загорается другой светодиод, который не должен был сгораться, поэтому это тоже достаточно интересно. Что не менее интересно, это релиз Linux 4.19, который был на этой неделе, и я не скажу за всех, меня больше всего заинтересовал пункт про то, что была добавлена начальная поддержка Wi-Fi 6, напомню, что я не уверен, как это называется, Wi-Fi консорциум, альянс, да-да-да, то есть там есть IEI,",
    "result": {
      "query": "reverse engineer ESP8266 firmware dump"
    }
  }
]