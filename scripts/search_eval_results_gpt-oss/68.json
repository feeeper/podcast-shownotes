[
  {
    "segment_id": "1a30d401-3bdf-481d-a191-4a4015234298",
    "episode_id": "6924209c-90cf-4c28-9ba7-7eca549c4b5b",
    "episode_number": 68,
    "segment_number": 2,
    "text": "Очевидно, ничем. Очевидно, основная сложность в том, чтобы А. найти достаточно толкового интерна, который что-нибудь внятное, в принципе, был способен сделать. И Б. Сделать так, чтобы кипящая энергия этого интерна не пошла зазря. То есть, следить за ним, задачи ему боевые ставить, плотно с ним работать и, возможно, потратить на это обучение человека еще больше времени, чем ушло бы на то, чтобы сделать необходимый функционал самостоятельно. Вот программы типа гугловского Summer of Code, они отлично решают первую задачу. За счет масштабов гугла и каких-то денег, которые гугл заносит студентам за это участие, оно более-менее качественно решает задачу «давайте найдем пригодных студентов». Проблема конкретно с Google Summer of Code, она заключается в том, что я несколько лет подряд туда подавался, но оказался недостаточно хорош. После чего плюнул. Кстати, в чем, как заключается, ну в чем, что такое выбор... Критерий, какие критерии. Критерии, да, то есть, вот как это происходит. Мы же говорим о корпорации Google, у которой лозунг какой-то do no evil, которая декларирует полную прозрачность и полное благолепие. И одновременно с этим мы говорим о корпорации Google, которая, если кто не знает, срать хотела на поддержку пользователей, срать хотела на, например, статьи закона в некоторых случаях, налоги оптимизирует креативно и так далее. Ну ты же понимаешь, сейчас набегут такие недовольные слушатели и сотрудники Google. Которая, например, вот, меня в свое время очень радовала, как Google контрибьютит в open source. Форкнули Linux внутри себя, форкнули MySQL, переписали половину, используем на своих фермочках. И как бы выложить обратно, ну, да и мне не слышали. Ну и логично, для бизнес-целей компании Google это вот не важно совершенно. Вы почему-то думаете, что Google это прекрасная, значит, благодушная компания, у которой все прозрачно, они вам покажут, расскажут, обязательно помогут, как, значит, в следующий раз составить такую заявку, чтобы все проконало. Скажите спасибо, если вам, в принципе, ответят. Скорее всего этого не будет. Лично я так давно не читаю. Кстати, раз мы ругаем Google, я могу бампнуть маленькую темку. Я тут себе делал альтернативный ящик, для, ну, который, типа, никто не знает, для всяких рабочих вопросов и так далее. Поскольку у меня основной ящик, он на root-центре, на своем домине, я выбирал там типа на Яндексе, на Gmail. Завести паврову сначала на Gmail. И я ужаснулся от того, какой у них iMap. У меня все в почтовом клиенте. Клаус Мейл я пользуюсь. И это было ужасно, потому что там какие-то лишние папочки, которые я не создавал. Это ладно, полбеды. Потом я начал с этого ящика писать кому-то письмо. Это выглядело примерно так, что... Это было твоей третьей ошибкой? Большой. Я написал письмо, но писал его, не знаю, минут пять, да, как обычно, там, с редактированием. Нажал отправить. У меня отобразилось, как будто ушло штук 20 писем во всех возможных редакциях вот этому отправительству. Вы представляете, да, мой ужас? А это же очень серьезный ящик для очень серьезных вопросов. Оказалось, правда, что это только некорректное отображение. Ушло реально только одно письмо. Ну, по крайней мере, судя по папке исходящей. Было страшно. Да, то есть вот компания Google, которая за open source и вот это все так поддерживает RFC. В общем, в итоге я перешел на Яндекс, и вот у Яндекса с Аймэпом все нормально. Ну, компания Google, как и любая другая компания, она в первую очередь компания. То есть основная цель бизнеса, в отличие от основной цели нон-профита, является что? Правильно, не мир во всем мире, а зарабатывание бабла. С точки зрения зарабатывания бабла компания Google довольно мало претензий, очевидно, может быть. Бабло они зарабатывают прекрасно. Но, кроме того, как бы бабло можно зарабатывать по-разному. Вот в компании Google, с точки зрения пользователей и их сервисов, мне по большому счету не нравится ровно одно, и это не конкретные расхождения со стандартом, или наоборот, чрезмерное следование стандартам, тем или иным. А ровно тот факт, что у компании Google, мне кажется, в ДНК зашито одно. Все автоматизировать так, чтобы, значит, с пользователем, не дай бог, ни при каких условиях, не общалась живая поддержка, чтобы с пользователями общались строго боты, чтобы пользователь сам себе все делал. А в случае возникновения проблем, ну, одно из двух, или проблемы возникают достаточно массово, и мы их видим, или, прости-прощай, нам такой пользователь не нужен. Вот меня как пользователя, ну, как-то не знаю, не очень радует. Ну, то есть, понятное дело, что в большей части для компании Google продукт, а не пользователи. Это все понятно, но есть оговорка, что даже произвестные баги, которые прямо торчат наружу, они закрываются далеко не моментально. Я, по-моему, уже второй или третий год наблюдаю баг, что ты в фидбернере, когда подписываешься на ленту по e-mail, у тебя там типа со второго перехода, вот ты просто кликаешь на ссылку, подписаться по e-mail на RSS. У тебя там отображается битая газировка. Ну, это нормально совершенно. Ну, допустим, одного тебя беспокоит этот баг. И остальных он либо беспокоит, либо беспокоит недостаточно для того, чтобы они, простите, сделали клик в интерфейсе баг-трекера. И естественным образом ничего не происходит. У компании есть больше приоритета, чем в чей-то вдобранный баг. Второй баг, что там, я не уверен, это только в Linux или везде, очень долго в блогере отображалось две формы для ввода комментов. Может быть, до сих пор так отображается. Я говорю, странно осуждать компанию за подобное. Я не осуждаю. Такой баг, если я там открытым 3 года. Это нормальное сочинение. Я привожу контраргумент и я ему высказываю, что массовые баги фиксятся, в отличие от тех, которые не массовые. Массовые тоже не фиксятся. А, ну то есть есть баги, на которых, значит, 2000 сабскрайберов в течение последних 7 лет, и как бы компания Google не чешется. Чем не радует 2000 вот этих сабскрайберов? Я не понятно даже, куда их репортить. И если ты репортишь, оно там сразу в шревер так автоматически распечатывается, уходит или как? Ну вот, да, такое ощущение, что как бы либо сразу автоботом, который из одного девнула пересылают в другой девнул, либо в шрейдер. Ну ладно, Google поругали? Ну да, достаточно на нее. Но можем еще, или наоборот, вознести славу Google. Зато теперь можно многое нагуглить, что прежде приходилось в муках искать эльтависты. Вопросы, дополнения? Комментарии, предложения? Ну окей, как-то вяло-вяло. Я бы сейчас зажег, конечно, но анекдоту рудавмо не считал. Я тут недавно открыл для себя пикабу. Такой отличный сайт. Опасаюсь, что я по подобным сайтам хожу по ссылкам прицельным, картинку какую-нибудь веселую посмотреть, но прицельно не считаю. Хорошо, я достану вопрос, который забыла задать вначале. Вот ты говорил, что проработал в Gamedev от разработчик интерфейсов и до директора пусть прошел. От граф-программиста до директора. Граф-программист, вот. Разработчик интерфейсов – это совсем-совсем разная специальность, по которой никто работать не умеет. Вот, а расскажи, сколько времени у тебя это заняло? О, я не считал. Надо как бы трудовую книжку достать или что-то в этом роде. Ну то есть в какой момент меня, значит, официально обозвали техдиректором, я не знаю. Наверное, года, блин, ну два-три. Повисла неловкая пауза. Меня опять снесло, что ли? Нет-нет, тебя не снесло, мы позвали Аксенова, и ни у кого нет вопросов. Отлично вообще, молодцы ребята. Нет, ну давайте, как бы, просто, значит, системно подойдем к снаряду. Давайте забудем о том, что мы позвали Аксенова, поговорим о том, что, значит, волнует в нашу нелегкую эпоху как геополитически, так и разработчицки. Ой, меня волнует как бы локомонетизировать. Потому что, я не знаю, может, я зря эту тему поднял. Потому что в рекламную сеть Яндекса меня не берут, потому что из Гугла письмо... Секунду, давайте срежем, значит, конкретные ламентации света. То, что меня волнует, да, на данный момент. Ну что-то же должно. Мне очень интересно узнать про внутреннюю структуру Sphinx, как это работает внутри, давай кишочки. Внутреннюю структуру как технологическую или как компанию? Технологическую. То есть там и так, и так, ну, блин, ты задаешь опасный вопрос. Ну, натурально. Мы можем с тобой станцевать приватный танец. И буквально, я думаю, 40 часов кратких лекций хватит для того, чтобы описать внутреннюю структуру в более-менее внятных деталях. Если в это не прыгать, то как бы базово классический инвертированный файл с довольно нехитрым форматом, который переделываем. Поверх этого нехитрого инвертированного файла отдельными гвоздями прибит некий стораж атрибутов, документов. И любой запрос рассыпается на классический поиск по инвертированному файлу, плюс все дополнительные операции при помощи тех самых прибитых атрибутов и стоража. Базово вот так. Теперь, значит, на 40 часов деталей. Для того, чтобы новых разработчиков в курс вводить, в одно прекрасное светлое время был написан небольшой документ о том, как все более-менее внутри устроено. Здесь такая подсистема, здесь такая, здесь эта. Вот он на 20 страницах. Моя проблема в том, что я могу либо 20 страниц, либо вот так три строки. В чем вы ведете вот эту документацию? Я забыл, честно говоря. Это был либо вардовый документ, который лежал в каком-то SWN-либо git-репозитории, либо это сразу был Google Doc. Последние все заметки делаем строго в Google Doc, но там не такие серьезные документы, не настолько большие, точнее. Там довольно небольшие куски по конкретным частям. Типа, хотим переделать вот эту вот часть, надо на общее обсуждение, давайте напишем маленький план, дружно его поругаем, передактируем и так далее. В итоге рождается там маханький документ на пару страничек, в котором мы более-менее утрясаем, как будет выглядеть, например, подсистема хранения документов, хранения образов оригинальных документов, которые вот наконец-то решили предел. А вот расскажи, как у вас техническое вот это планирование происходит. Какая это проблема? Вы начинаете все вместе это обсуждать, правильно я понимаю? Ну, я как, значит, диктатор в крохотной компании, выступаю обычно инициатором, вбрасываю, пишу какой-нибудь драфт, цинично назначаю какого-нибудь ответственного разработчика, он какое-то время возится, мы обсуждаем с ним напрямую, если оно затрагивает всех подряд, то обсуждаем всей толпой. Ну, повторюсь, компания-то на самом деле крохотная, опять разработчик, господи, с укуром на смех. И поэтому все достаточно просто, неформально и так далее. Как вы решаете проблему, когда люди имеют разные точки зрения на решение проблемы, и вы никак не можете сойтись? То есть ты просто начинаешь выступать диктатором? У нас же есть диктатор, который еще не совсем забыл, как подпишется. И, ну, переубедить меня в том, что я дичайшо заблуждаюсь, наверное, в принципе можно. Будет оживленная дискуссия, по итогам которой я признаю, что да, вот тот вариант, который я предлагал, он полное говно, надо сделать не так, как я предлагал. Валера, что тебя больше всего беспокоит? Я уселся писать диск в ВБК, для что-то вроде, не знаю, вот как... Если бы в Кавке все топики можно было сложить в один файл. И на меня пришло сознание, что если взять, сделать хешик ключей, получается, ну, это что-то вроде временных рядов, на B3, в котором дальше индексы по... Как получается, sequence number внутри каждой серии, то оно даже, наверное, будет неплохо работать. И вот я сейчас с этим пытаюсь экспериментировать, это единственное, что меня сейчас волнует. У меня есть отличная идея. Тебе нужно сделать open source проект, залить его на GitHub, найти парочку знакомых, которым это нужно. Да, оно примерно так и работает, на самом деле. То есть ну нужно же для начала хотя бы осознать, что я делаю, прежде чем код писать. Да, вот немаловажные детали. И того мы в принципе поделились довольно доблестно на две фракции. Двух человек интересуют всевозможные технические кишки всякого, двух человек интересует тупо бабло. То есть ты себя причислил к баблу, я так понял? Ну, конечно. И интересных технических вопросов, об которых мне бы приходилось сильно ломать голову, я вот навскидку не припомню. Вот расскажи, какая там большая... Технические проблемы-то я умею решать, я продавать не умею. Вот точно та же проблема. Другое дело, что возможно у нас и продавать-то нечего, но с учетом того, что я продавать не умею, я даже этого не знаю. Прикинь, какая я раскоряка. Вообще, а вот... Извини, Света, одна фраза. Просто проблема-то в чем, что чтобы тебя начали волновать настоящие возвышенные технические вопросы, сначала нужно заработать бабла, чтобы тебя остальное не беспокоило. Когда бабло есть, ты уже начинаешь заморачиваться про хэш деревья или что там у тебя, Валер. Кавка, да? Я уловил кавку, не много про LSM, но буду откровенный. Там как раз LSM-а нет в том-то идее, чтобы LSM не делать. Так, и это некая техническая проблема. Да. Но техническими проблемами, если, значит, головам болит и про технические проблемы, ну, наверное, они основные. Если головам болит про бабло, ну, наверное, бабло основная проблема. То есть, мы заговорили про технические проблемы. Ты упомянул, что вы поддерживаете старые версии. И это, наверное, очень большая головная боль. А какая еще огромная головная боль была при разработке? Опять же, технологическая? Да, технологическая. Ну, как бы, как ни странно, поддерживать старые версии в текущем виде оно не так тяжело. То есть, поддержка своя, она жрет что-то. Но я бы не сказал, что она прям гирей тянет ко дну. Была смешная технологическая проблема довольно давно под названием мета-автоматического тестирования до определенного момента. Ровно в тот момент, когда оно стало серьезной проблемой, внедрили. Была проблема в свое время. Ну, это скорее хорошая проблема, как мне кажется. Что-то, как очень много дел не можем смасштабироваться по разработчикам. Найти к двум имеющимся разработчикам годного третьего. Ну, вот тоже как-то порешали. Выросли до состояния, когда вроде как имеем столько, сколько можем переварить. Есть как бы нудная технологическая проблема под названием, ну вот уже год, наверное, возимся с переписыванием всякого. И окончательная мега-версия еще как бы ну, уже видна сильно лучше, чем год назад. Но я бы ее не назвал чисто технологической. Ну, как бы, ну, понятно, да. Ну, вот, долго, нудно и печально. Это переделали, то переделали. И просто сфокусироваться там 16 часов в сутки сидеть и код писать тоже не удается. Из-за этого вот сроки тянутся. Ну, скажи подробнее. Ну, как бы странно, я бы этот мега-рефактор не назвал чисто технической проблемой. То, что он затянулся. То есть там технических проблем каких-то не разрешено. Что есть, как упс, совершенно непонятно, как вот это вот сделать. Такого нет. А можешь подробнее про вот эту автоматизацию, тестирование рассказать? Как это было до сделано? Ну, стандартный комбинаторный взрыв. Представь себе, у тебя есть система размером в 40 килобайт, которая ты приходишь на TCP порт, даешь ей три слова буквально текстом. Ну, давай для простоты, без каких-либо даже спецкоманд, спецпортаколов и так далее. И она тебе в ответ текстом дает список айдишников, документов, в которых это все нашлось. В этот момент, конечно, тоже, в принципе, неплохо бы какое-то тестирование устраивать. Но до определенного момента это тестирование может быть сугубо адхок. Что ты что-то поменял, руками на портик зашел, три своих тестовых запроса из файлика вбил, и оно вроде бы как-то работает. У нас оно до определенного момента, до достаточно нетривиального размера, когда базы, несколько сотен килобайт, если я правильно помню, именно килобайт, не килострок, оно жило в виде, что вроде бы как-то работает, прогнали вот такой, такой, такой адхок тест, и оно вроде что-то находит, какие-то привычные результаты дает. Окей. Ну, тут как бы пришла стандартная беда под названием комбинаторный взрыв в нашем случае настроек, мы делали несколько каких-то настроек, которые были не ортогональны друг другу, которые промеж себя взаимодействовали. И началась эпопея под названием крутишь одну настройку в одно из 3 возможных значений, в другую в одну из 4 возможных значений, потом еще одну настройку в одну из 2 возможных значений, у тебя все возможности перемножаются, и суммарное количество комбинаций получается 3 умножить на 4 умножить на 2 довольно быстро. Это известная боли, как вы это решали? Ну, как обычно, автоматизировали, написали маханьку, тестовую SUITU, на тот момент маханьку, с тех пор она разрослась. Написали некий простенький и до сих пор не сложненький POHAPI скрипт, который генерировал все возможные варианты, ты им перечисляешь список вариантов, в данном случае речь о настройках конфигурационного файла, о настройках конфига, ну вот он генерирует 12 разных конфигов условных, жахает 5 заранее записанных запросов и сверяет их с эталоном. Самый первый драфт автотестовки, он вот такой. Ну и потом сидишь и внимательно вычитываешь, что там за результаты, что получилось, фиксируешь эталонный отклик, и после этого наконец-то наступает счастье, что если ты, не дай бог, что-нибудь опять сломал, каким-нибудь изменением, то это можно отловить, простите, не ручным перебором, 24 вариантов конфигурации и 5 запросов в каждой из этих конфигураций. А, кнопочку нажал, и оно тебе за полсекунды все протестировало. Ну ты вот сейчас что-то довольно простое рассказал, а что если сломал не код, а сломал не логику, а перформанс? Ну это есть, соответственно, перформанс тесты, про которые мы подумали довольно давно, но при этом, как следует, до сих пор не внедрим, по-моему. То есть перформанс тестов вообще нету? Они есть, но их маловато, они недостаточно хорошо внедрены. Да, есть перформанс тесты точно так же. А у нас нет никаких супер достижений, это там революция в процессе разработки какой-то, которые надо срочно внедрить во всех компаниях подряд. Мы довольно прагматично в этом плане и были, и надеюсь до сих пор остаемся. Пока не болит, не чашем, так только начинает болеть, начинаем предпринимать какие-нибудь меры. Предпринимаем простейшие меры, которые решат проблему, и вот решаем. Каким-то образом на ad hoc тестировании оно жило довольно долгое время. Ну, хорошо, ну то есть плохо, конечно, но хорошо. Перестало жить на ad hoc тестировании, сделали автоматическое тестирование, повисла неловкая пауза, ну и так далее. Я тут залипаю на соседний скайп-чатик, прошу прощения. Там коллеги с бывших работ общаются. Со всех 19? С предпредыдущей. Тем не менее, да. Давайте перейдем что ли к темам, которые мы тут заметили. Давай я тогда еще последний вопрос. Да, конечно, давай. Смотри, вот у вас есть текущее решение, оно уже существует множество лет, но я говорю про Sphinx. И вот с высоты настоящего времени, если бы у тебя была возможность что-то переделать в архитектуре, вот какие, например, глобальные ошибки были совершены, вот что бы ты сейчас сделал совершенно по-другому, скажем, по отношению решений, которые были приняты давно, и ты бы сказал, нет, это было абсолютно неверно, я был неправ, и это плохое было решение. Но такие решения в микромасштабе возникают постоянно, да? И ты их просто переделаешь и не фиксируешь. Такое глобальное, просто косяк. Ну давай я резко разверну дискуссию и скажу, что я вообще, наверное, в open-source не пошел. Попоясни. А зачем? То есть я либо вообще не пошел, либо пошел совершенно не так. Технологически, ну я бы не сказал, что были какие-то просто чудовищные, супер вредоносные решения, которые потом выпили невероятное количество крови. Таких, как мне кажется, ну не то, что не было неверных решений, которые потом приходилось переделывать. Было, но такого, чтобы они там нам выпили всю кровь, не было и там пили кровь на протяжении года, ну по-моему, таких не было. То есть мы их как-то более-менее оперативно рефакторим, что ли. Началось, как это сказать, началось болезненное воспаление, ну давайте его выкорчевывать. То есть никаких сожалений о том, что, дескать, блин, ну а в 2006 году я вот в этом классике вот такой интерфейс задизайнил. Вот я дебью. Надо же было тут наплодить иерархию из трех других классиков. Нет, нет, ну имелось в виду такие глобальные архитектурные решения, которые потом привели к большим проблемам. Ну, не готов сказать. Ну то есть, опять-таки, ретроактивно понятное дело, что если бы я делал все тогда, то я бы делал как сейчас. Но опять-таки, это интересное сослагательное наклонение, потому что сейчас я делаю, вот мы переписываем всякое с учетом имеющегося опыта, который получен как раз набиванием шишек в течение десяток с лишним лет. Верни меня в текущем состоянии назад на десяток с лишним лет, ну я бы, понятное дело, технологически все делал совершенно не так.",
    "result": {
      "error": "API request failed: Error code: 400 - {'error': 'Trying to keep the first 5941 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input'}",
      "stack_trace": "Traceback (most recent call last):\n  File \"/home/andrei/Projects/podcast-shownotes/scripts/build_search_eval_dataset.py\", line 157, in generate_search_query\n    response = await self.client.chat.completions.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py\", line 1927, in create\n    return await self._post(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1767, in post\n    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1461, in request\n    return await self._request(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1562, in _request\n    raise self._make_status_error_from_response(err.response) from None\nopenai.BadRequestError: Error code: 400 - {'error': 'Trying to keep the first 5941 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input'}\n"
    }
  }
]