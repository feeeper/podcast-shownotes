[
  {
    "segment_id": "f33f48cc-b6be-4c98-b97d-4835dcd77b80",
    "episode_id": "e4f00f34-8f2f-4df4-b658-90a03f0cf1df",
    "episode_number": 242,
    "segment_number": 9,
    "text": "Вот поэтому метрики, которые более гранулярные, которые отражают более тонкие внутренние какие-то аспекты оперирования сервиса, работы сервиса, которые при этом могут быть невидимы пользователям, вот такие вещи показывать на дашбордах, как правило, полезно. Показывать все подряд, наверное, не очень полезно, потому что чем больше всего показываешь, тем сложнее найти нужный сигнал. Но тут уже работает здравый смысл. Вот. Какие-то комментарии? – Да нет, наверное, нет. – Ну, тогда, наверное, последний топик, про который я очень коротко хотел поговорить – это бюджет ошибок. – Почему? Вот это как раз очень большой топик должен быть. – Ну ладно. – Это одна из ключевых особенностей, мне кажется, работы с СРЕ. Давай. – Ну давай. Я дам короткое интро, а там посмотрим, как дискуссия пойдет. Бюджет ошибок – это такое понятие о том… Это некоторый инструмент, который позволяет вам балансировать с одной стороны скорость развития сервиса, а с другой стороны его реальную надежность. Идея состоит в том, что мы признаем, что люди делают ошибки, программисты делают ошибки, они время от времени проскакивают через все тесты и происходят аутеджи. И это нормальный спутник развивающейся системы. Трюк состоит в том, чтобы понять, сколько ошибок мы можем себе позволить, так, чтобы это, с одной стороны, не пронесло нам финансовых убытков, а с другой стороны, как бы не застопорило наше развитие полностью. И это одна из причин, по которой требовать стопроцентную доступность, наверное, плохая идея, даже если мы можем физически обеспечить. Поскольку это означает, что мы будем очень сильно бояться что-то изменить в сервисе, потому что вдруг мы сделаем что-то не так, вдруг релиз растется плохо, вдруг мы нажмем не ту кнопку, и, значит, все пропадет. Нас всех уволят, пользователи нас оштрафуют и так далее. Поэтому выбирается некоторый бюджет ошибок, некоторая метрика, по которой мы можем сказать, что вот мы, в принципе, как бы работали очень хорошо и надежно, и, наверное, мы можем немножко больше порисковать, выкатить какую-нибудь более рисковую фичу сегодня и, значит, таким образом продвинуть развитие нашего сервиса. Обратная сторона этой практики состоит в том, что если мы видим, что у нас бюджет ошибок исчерпан, у нас, не знаю, SLA был нарушен и так далее, то мы можем сказать, что, хей, давайте придержим нашу разработку, давайте будем выкатывать медленнее и осторожнее, потому что мы ломаем слишком много и теряем из-за этого деньги. Ну и, соответственно, то, что определяет бюджет ошибок, это, как правило, что-то вокруг вашего SLA. Чаще всего вы не хотите полностью исчерпывать бюджет вашего SLA на такого рода ошибки, но, допустим, 50% SLA удерживаются в рамках, не знаю, 50% недоступности, которая требует вашей SLA с закладкой на то, что у вас могут произойти какие-то нетредвиденные аутеджи. Вот это довольно неплохая точка для отправления. Вот, вопросы. У нас здесь много. Во-первых, я хотел бы прокомментировать, что вот этот бюджет, уменьшение этого бюджета, это фактически общая задача у разработчиков SLA, и за счет этого как раз Google и пытается снизить напряженность между командами. В исторической перспективе можно посмотреть и сказать, что да, всегда между админами, которые были, operations там, или как вы их хотите называете, и между разработчиками всегда был какой-то конфликт интересов. Разработчики хотят как можно больше зарелизить, operations хотят как можно меньше зарелизить, потому что от них, то есть KPI этих людей, этих команд как раз количество падений. Чем меньше будет релизов, тем меньше будет падений, тем больше их зарплата. Я сейчас утрирую специально намеренно. А получается, что SRE и разработчики, в отличие от админов и разработчиков, они делают общую цель, поставили себе это уменьшение ошибок, и соответственно есть бюджет у обоих, у всех. И не так, что админы пытаются не сделать релиз, или админы пытаются противостоять изменениям. В данном случае SRE, ну насколько я понимаю, я очень хочу подтверждение этой точки зрения моей, SRE пытаются помочь всем командам остаться внутри бюджета. И поэтому команды, получается, не противостоят админам, а команды с благодарностью принимают помощь админам. Я не работал ни разу в Гугле, и поэтому вся моя информация базируется исключительно на книжках, в лекциях, докладах и прочем. Я хотел бы как раз уточнить это. То есть бюджет на самом деле вот так работает в данном случае? Да, он имеет такой эффект, это эффект правильной установки ожиданий. То есть если мы устанавливаем ожидания о том, что у нас будет некоторое количество аутеджей, и это нормально, это в принципе благотворно влияет на напряжение всех участвующих людей. Ну и кроме того, собственно, как я уже говорил в начале, починка инцидентов аутеджей, операционная работа, это не основная цель существования SRE, это как раз предотвращение того, что они происходят. Соответственно, да, SRE, они заинтересованы в том, чтобы помочь команде разработки достигнуть надежности и не тратить error budget, но в то же время мы прекрасно понимаем, что если мы его реально не тратим совсем, то наверное мы все равно слишком сильно осторожничаем, и наверное можно позволить себе рисковать больше, потому что опять же важно понимать, что чем быстрее мы развиваемся, чем больше рисков мы берем, тем таким образом мы можем компенсировать, что называется opportunity cost, потому что если мы слишком сильно оптимизируем на понижение error budget, это означает, что мы не сможем зарелизить какую-то фичу, которая принесет нам дополнительные деньги. При этом, естественно, мы делаем все возможное, чтобы каждая отдельно взятая фича не вызвала outage, но если мы делаем это настолько хорошо, что outage нет вообще, это значит, что мы можем катить фичи еще быстрее, и мы должны их катить. То есть это такой интересный процесс балансирования между большим количеством outage и полным их отсутствием, такой, чтобы при этом убытки от происходящих outage не превышали прибыль от тех возможностей, которые соответствующие релизы позволили нам получить, развитие бизнеса и так далее. Как-то так. Это правда интересный концепт, который не сразу приходит в голову. То есть ты пытаешься уменьшить количество ошибок, а по факту ты замедляешь свою скорость. Да, верно. К сожалению, звучит это довольно здорово, но в большинстве случаев в моем опыте ситуация, когда у вас слишком мало outage, она, к сожалению, происходит довольно редко. Просто потому что сложные системы, и outage происходит там естественным образом. К сожалению, так. Я хочу продолжение предыдущего вопроса про конфликт интересов и R-Budget как способ, как общая цель команд. Насколько в сравнении с другими командами, я надеюсь, ты до этого работал в разных компаниях, хотя бы там два десятка компаний. Конечно. Трех. Насколько чувствуется меньше конфликтов? Это сложный вопрос. Поскольку до Google я не работал в роли Reliability инженера, мне немножко сложно обобщать это на другие команды, поэтому я буду основываться на том, что я вижу в своей и соседних командах. Это помогает ослаблению напряжения между Reliability командами и командами разработчиков, продуктовых разработчиков. Однако это все же не основная цель бюджета ошибок, в моем его понимании. Мое понимание как раз состоит в том, что главное это скорость разработки и развития против надежности, а тот факт, что мы признаем, что некоторое, ненулевое количество аутеджей будет происходить независимо от наших стараний и, возможно, как прямой эффект наших стараний, это просто немножко облегчает состояние психологическое всех вовлеченных. А не легче ли тогда сказать, что, ребят, эррор-баджет не может быть нулевым? Ну, эррор-баджет не может быть нулевым просто потому, что аутеджи случаются, правильно? Ну, в смысле что? Наказывать соответствующие команды, если у них нулевой? Я утрил, опять же, то есть наказания-то не должно быть, но мотивировать их, чтобы они выставляли себе эррор-баджет как цель, чтобы у них там был, не знаю. Ну да, да, в этом идея. Идея в том, чтобы сделать этот бюджет больше нуля, но таким, чтобы это не приносило существенных финансовых убытков. К сожалению, на практике я не сталкивался со случаем, когда этот бюджет бы... были проблемы с тем, чтобы использовать этот бюджет. Двигаться быстрее и ломать вещи всегда гораздо проще, поэтому вот. Понятно, спасибо. Так, ну что, о, я забыл зачитать комментарий, это очень весело, про остановку, то есть кардиостимулятор должен иногда останавливаться, чтобы пациент не привыкал к хорошей работе, этот, я считаю, лучший комментарий за сегодня. И разработчики иногда уходят в отпуск для профилактики Бас-Фактор. Что вы думаете про Бас-Фактор? Расскажешь что-нибудь? Даже не знаю, что рассказать, кроме очевидных вещей, что... Практики. А самое интересное, это практики, которые работают. То есть вот у нас есть команды, в команде один человек делает 90% работы, ну потому что остальные люди участвуют на более важных проектах, но нельзя же допустить, чтобы один человек знал только все и все. Ну, с точки зрения оперирования проекта, документация. Документация, в частности, плейбуки, которые мы обсуждали в прошлые разы, она по крайней мере позволяет уменьшить влияние Бас-Фактора в ситуации, когда у нас какой-то аутедж. Кроме того, хорошим тоном считается, например, делать некоторые 1-2 тех толпка по результатам твоего проекта. Допустим, если получилось, что ты разрабатывал какой-то компонент в одиночку, вот, там в месяц, ты накопил некоторое количество экспертизы, знаний, и после этого ты можешь просто взять и потратить час, чтобы рассказать своей команде, своим коллегам о том, что ты делал, какие были проблемы, почему ты выбрал те или иные подходы. И это не сделает всех остальных экспертами в той области, скорее всего, ты окажешься всё равно главным экспертом на эту тему, но при этом хотя бы это не оставит людей в потерях, когда вот ты уйдёшь в отпуск. Но вообще, комментарий о том, что разработчики уходят в отпуск для профилактики Бас-Фактора, это было бы смешно, если бы не было так грустно, потому что, к сожалению, несмотря на все усилия, ситуация, когда один, я не знаю, особенно, например, техлит, уходит в отпуск, и внезапно оказывается, что люди не знают каких-то важных вещей, и у них уходит много времени, чтобы вычитать это в коде, или найти правильную документацию, найти нужные контакты, это, к сожалению, проблема более частая, чем хотелось бы. Да, так и есть. Ну, это, к сожалению, проблема любой разработки, это не специфично для релайабилити инженеров, это даже не слишком специфично для разработки программного обеспечения, любая креативная работа подобного рода, она имеет проблемы с Бас-Фактором. Что-нибудь ещё? Да, пожалуй, всё. Слушай, ну получилось очень здорово, вот реально это прям погружение в СРР, я бы даже так и назвал выпуск, потому что то, что мы до этого обсуждали, это были какие-то, я не знаю, концептуальные вещи, а сейчас это просто технически ты прошёлся по всем вопросам, которые вы покрываете, и ответил на большинство вопросов начинающих админов, которые думали, так чем же это отличается? Ну, мне очень хотелось, чтобы как-то так оно и вышло, рад, что получилось. Так, у нас другие ведущие будут какие-то вопросы задавать? Да, это знаешь, тот случай, когда гость сам прекрасно обо всём поговорил. Кстати, да, сам приготовил план, сам к нему подготовился, сам подготовил ответы на свои же вопросы. Вот видишь, больше таких гостей. Это единственное преимущество большой корпоративной бюрократии, потому что меня заставили написать все эти вопросы и ответы. Да, ребята, работайте в Гугле и приходите к нам. Я уверен, что в других больших компаниях всё точно так же, так что… Ну, работайте в Гугле, а тут… Не всегда, не всегда, не в каждой большой компании так же. Ну, тогда я очень рад за вот эти вот не такие компании. Кстати, а вот это интересный вопрос. Я думаю, что не такие компании – это в основном компании, которые работают либо с open source много, либо с открытыми источниками, либо делают прозрачную, намеренно прозрачную как-то даже систему управления, наверное. Да, наверное. Я думаю, что, по крайней мере, моё понимание, почему большие компании типа Гугла, Майкрософта и тому подобных так много заморачиваются о публичном, о публичных взаимодействиях, о проволоках и всём таком, просто потому, что очень много репортерского внимания на них сосредоточено гораздо больше, чем на практически всех остальных компаниях. Соответственно, им приходится занимать некоторую более защитную стойку, чтобы убедиться, что всё, что будет сказано, было понято и интерпретировано именно так, как хотели, чтобы это было интерпретировано, а не в каком-то неправильном свете. По крайней мере, мне кажется, что вот это основная цель всех таких мер предосторожности. Ну да, соответственно, другие компании, которые не делают таких мер предосторожности, либо они очень бедны и на них сложно подавать в суд, потому что не выигрыш денег, либо они уже разорились. Ну, либо просто о них никто не знает и много хорошего заголовка из них не сделаешь, что не должно служить ни в коем смысле оскорблением, потому что так работает современная пресса. Современная пресса сильно зависит от того, сколько людей прочтут ту или иную статью. Соответственно, очень много людей заинтересованы в продуктах компаний Microsoft, Apple, Google, даже IBM и так далее. И гораздо меньше заинтересованы в продуктах какой-то гораздо более маленькой локальной компании, которая там работает только на рынке разработчиков, например. Ну вот, соответственно, пиар риски у компаний разные, отсюда и разные усилия. Я предлагаю пойти дальше по темам, Валер, команда идёт. Я на самом деле пошёл бы по маленьким, потому что я почти уверен, что мы с Local First, короче, или мы его один обсудим, или... Я предлагаю всё-таки дождаться выпуска без гостя. Для Local First. Да? Да, я не против, давай снова попрощаемся. Отлично. Извините, ребята, она большая. Ну, собственно, из маленьких тем, наверное, самое большое, что случилось за неделю, это выход ОТП-22. А вот тут я подсплэгаю. А что больше? Я считаю, что интеловские уязвимости – это более важная тема здесь. Есть приятных новостей, я вот так вот размажусь. Ну, в общем, где-то, если что, кто не знает, эрланговые релизы теперь, ну, они всегда так... Да, раньше это было Erlang-R что-нибудь, а с некоторых релизов, они ОТП... Чуть циферка. Вот ОТП-22 вышел, там довольно много всего интересного, и некоторые из этих вещей, мне такое ощущение, что их обещали, когда я ещё в универе был, то есть лет 10 назад. Там изменили компилятор, он теперь использует SSA для... Ну, в процессе компиляции, и тем самым начал уметь некоторые оптимизации, которые раньше не умел, в частности, байнери более лучше оптимизируют, в частности, локальные переходы внутрь модуля по функциям, например, не проверяют проверки, которые он уже делал раньше и так далее. Это вот такая первая вещь, которая... Ну, я, кстати, знаю вещь, которая сравнительно новая, но я вроде не помню, чтобы эти обсуждения велись давно.",
    "result": {
      "error": "API request failed: Error code: 400 - {'error': 'Reached context length of 4096 tokens with model (arch: gpt-oss) that does not currently support mid-generation context overflow. Try reloading with a larger context length or shortening the prompt/chat.'}",
      "stack_trace": "Traceback (most recent call last):\n  File \"/home/andrei/Projects/podcast-shownotes/scripts/build_search_eval_dataset.py\", line 157, in generate_search_query\n    response = await self.client.chat.completions.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py\", line 1927, in create\n    return await self._post(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1767, in post\n    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1461, in request\n    return await self._request(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1562, in _request\n    raise self._make_status_error_from_response(err.response) from None\nopenai.BadRequestError: Error code: 400 - {'error': 'Reached context length of 4096 tokens with model (arch: gpt-oss) that does not currently support mid-generation context overflow. Try reloading with a larger context length or shortening the prompt/chat.'}\n"
    }
  }
]