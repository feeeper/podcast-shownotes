[
  {
    "segment_id": "3a78f11f-3307-42f9-afcd-247dd68b3723",
    "episode_id": "e5183f88-0a18-4145-846c-b686c2660a28",
    "episode_number": 181,
    "segment_number": 8,
    "text": "Значит, история там такая, есть удостоверяющий центр Digicert, наверное, он так произносится, Digicert, который, собственно говоря, занимается выпуском сертификатов, и у него есть разные реселлеры, то есть это компании, которые делают там некий маркетинг, рекламу, привлекают к себе клиентов, но они сами не являются удостоверяющими центрами, они просто приходят к удостоверяющему центру, говорят, вот ко мне пришел клиент, я за некую комиссию отдаю ему сертификат. Удостоверяющий центр делает сертификат, отдает, соответственно, этому реселлеру, реселлер это дело передает своему клиенту. Ну и, соответственно, для клиента, клиент работает с реселлером, а реселлер работает с удостоверяющим центром, то есть такая вот перепродажа. Понятная схема достаточно, всем выгодная. И вот, значит, некая компания Trastica, которая является реселлером DigiCert, значит, в какой-то момент пришла к ним и сказала, что типа, ребята, вот у нас тут скомпрометировано 50 тысяч SSL сертификатов, и все плохо, типа, нужно их типа отзывать, потому что ненадежно. Ну, естественно, DigiCert удивился, и говорит, ну какие ваши доказательства, где описание, ну, понятно, DigiCert, это не очень выгодно просто так отзывать сертификаты, потому что это некий удар по всему этому хозяйству. Вот они начали расспрашивать, Trastica замялись, отправили им 23 тысячи сертификатов приватных ключей, соответственно, сертификатов, и, соответственно, DigiCert вот эти 23 тысячи отозвала. А потом, соответственно, Trastica предложила своим вот этим кастомерам, чьи сертификаты были, уже сертификаты от другой компании, от Commodore. Вот такой вот был попытка сменить поставщика сертификатов вот таким вот странным образом. Такой вывод мы из этого сделать должны, видимо, что реселлинг это плохо, что надо обращаться напрямую к удостоверяющим центрам, и не... А, да, важный момент, собственно говоря, то есть откуда у них оказались эти приватные ключи? Они, очевидно, их сохраняли к себе на диск, когда передавали клиенту, то есть перед тем, как передать клиенту, они это сохраняли себе на диск, где-то записывали. Что не есть, как бы, good. Ну и, как бы, да, что мы должны делать? Мы должны ходить напрямую к удостоверяющим центрам раз, два, а вообще не заниматься, не пользоваться этими веб-сервисами, которые генерят нам этот... Простите, приватный ключ на стороне сервера, да, а генерить приватный ключ самостоятельно и только подписывать его, заверять в удостоверяющем центре. Такие дела. То есть делаем ли мы глубокомысленные выводы о том, что вот ТЛС вообще ненадёжен и не стоило его создавать? Почему он ненадёжен? Ну вот видишь, какой бардак творится. Ну так самое как раз прекрасное, то что если, например, ты правильно приготовил forward secrecy, даже если у тебя твой реселлер сертификата идиот и хранит ключи у себя, то у тебя всё ещё трафик нельзя расшифровать. То есть даже если приватные ключи утекли, старый трафик расшифровать нельзя, даже если его кто-то записывал. Ну офигеть. Это, конечно, в корне решает все проблемы. Нет, ну в смысле, у тебя институт шифрования всё ещё есть. Так, вот теперь можешь заметить. Трафик не зашифруется, но вот этот зелёненький значок можно подделать. Правильно я понимаю? Валер, какой ещё нафиг институт шифрования, если мои приватные ключи генерятся на стороне сервера, потому что так людям удобнее? Ну смотри, короче, скажем так, у тебя есть всякие вещи, где у тебя SSL и так далее, он служит для защиты твоих личных данных, например, если ты общаешься, если ты пересылаешь нам какие-то данные, кредитные карты этих людей, их всё-таки, ну да, тут всё ещё могут быть людские проблемы, но мыслими это человеческий фактор. Но, по крайней мере, можно быть уверенным в том, что какой-то аудит там был и, скорее всего, приватный ключ, который хранится где-то ещё, это там поймают и дадут пинга. Опять же, все крупные компании типа Google, Dropbox и так далее так делать не будут. Если мы говорим о какой-то шараге, которая используется, ну как это, которая использует шифрование, потому что сейчас браузеры так требуют, а не потому что им это зачем-то нужно. Ну пусть они хранят, то есть даже если они идиоты и потеряли приватные ключи или там, не знаю, никогда их не имели, отдали какому-то стрёмному дяде, на самом деле там это просто служит во многом для того, что у тебя твой провайдер не может влезать в твой трафик и шепить твой трафик на основе «ага, это у тебя хтп пошёл», а вот это у тебя видос качается, для него весь твой трафик становится просто невидим. И там, не знаю, твой провайдер не может отдать данные о том, что ты браузишь какому-то третьему лицу и тебе не начнёт, не знаю, реклама в почтовый ящик физически сыпаться в основе того, что ты вчера браузил, потому что твой провайдер продаёт эти данные кому-то. А никто не может, не знаю, ты сидишь в кафешке и ты не очень технически подкованный человек, но у тебя теперь весь трафик, вся твоя, твой имейл, твой, то, что ты браузишь, тоже же зашифрован, и владелец точки в кафешке не может делать то же самое и так далее. То есть это всё ещё очень важная штука. То есть странно говорить, что «ага, можно митмить», значит вся штука пошла нафиг. Мы уже про это даже говорили, по-моему, то ли в октябре, то ли в ноябре прошлого года, что вот тот факт, что у нас где-то какая-то защита не идеальна, её наличие хоть какое-то уже лучше, чем её просто временное шифрование и так далее. Если это хороший, правильный сертификационный центр, то конечно, у вас будет высокая степень защиты, и если у вас держатели сайта не идиоты, у вас будет высокая степень защиты. Если держатели сайта идиоты, ТЛС сам по себе это не инструмент предотвращения от того, что держатели сайта идиоты. Окей, они не приватные ключи потеряют, так что они ещё потеряют. То есть не знаю, приватные ключи, допустим, у них хорошо сохранены, но они, ваши пароли куда-то утекли. Несмотря на то, что ваши пароли хорошо передавались, это не было никакого митма. Ну то есть как бы… Ты сейчас всё правильно говоришь с точки зрения пользователя интернета, то, что хорошо, что в почту не будет сайта рекламы, основанная на том, какой у тебя трафик, и я с этим согласен. Но меня вопрос больше интересовал с точки зрения секьюрити-задрота, который хочет, чтобы весь трафик был надёжно зашифрован в сети у всех. И меня на самом деле беспокоило не утешение, что зато у тебя рекламы не будет, а интересовал вопрос, будет ли у нас когда-нибудь реально зашифрованный интернет нормальный или не бывать этому никогда. Нет, смотри, ещё раз, я не только про это с точки зрения пользователя, я и эту точку зрения тоже пытался на самом деле сказать. Ну то есть смотри, у тебя всё равно, у тебя даже если приватные ключи утекают, это как бы… Это разные концерны. Есть один концерн, что у тебя есть защита пользователя в момент передачи данных, и другой концерн, что у тебя есть другой контрагент, с которым ты обмениваешься данными, и он идиот. Как бы ТЛС от второго не спасает. ТЛС спасает в первом случае, даже если твои приватные ключи куда-то утекли, по камере большинства сессий, если вот прямо кто-то прямо сейчас не митмит, то данные будут шифроваться, и данные о том, что пользователь передавал, оно всё равно никуда не улетит, скорее всего, с хорошей вероятностью. Опять же, если у вас даже есть правильный ТЛС без каких-то потерь, у вас правильно всё зашифровано, нет никакого митма, повторюсь, если контрагент идиот, он может утечь всё равно какие-то данные, которые для вас были важны. Понимаешь примерно, о чём я? Ну ты примерно о том, что даже безотносительно ТЛС, допустим, ТЛС идеальный весь интернет шифрованный, но в PayPal, условном PayPal кто-то идиот, и поэтому, если я ввожу у них свою банковскую карту, то даже безотносительно ТЛС это может утечь каким-то другим каналом. Да, да, то есть если контрагент безответственно относится к чувствителю информации, то это проблема на стороне контрагента, и мы не можем технологически это починить, наверное. А ещё в свете этой новости мне ужасно интересно, сколько людей, которые пользуются Let's Encrypt, а это по последней статистике, которую я видел, там процентов 40 всех SSL-сертификатов, правда неизвестно, сколько это в проценте от трафика в интернете, сколько пользователей Let's Encrypt смотрели реальный исходный код, как он называется, Cryptobot, Cypherbot, я не помню, и какие у него возможности по самообновлению и генерации приватных ключей на своей стороне и вот этому всему. Ну то есть по сути, Let's Encrypt, он сам генерирует приватные ключи, просто делает это на твоём компьютере, и возникает вопрос, сколько людей, и звучало вопрос, как это делается, и может ли оно как-то самообновиться в будущем, и я лично не смотрел. Ну смотри, тут в теории такого рода вещи можно заложить на доверие технологии третьей стороны, которой нет никакого профита утекать в свои ключи. То есть условно возьмём Docker, ну или другую эквивалентную технологию, сделаем какую-то такую инструкцию, с которой очевидно следует, что это запускает контейнер без сети, то есть вообще без сети, то есть данные физически не могут никуда утечь, оно подмонтирует тебе, то есть грубо говоря, строчка, которую нужно запустить от Let's Encrypt, она стартует контейнер без сети, генерирует приватный ключ, кладёт его, не знаю, как файлик на файловую систему, и потом генерирует какую-то штуку, которую нужно курлом дёрнуть, но курл пойдёт строго по одному урлу, очевидно. И так или иначе, ну это, конечно, усложняет процесс генерации, у нас это паранойка, это даёт тебе хорошую степень гарантий того, что ни курлу, ни к докеру невыгодно иметь какие-то специальные дырки для того, чтобы утечь твои Let's Encrypt ские приватные ключи. Лёш, а ты пользуешься Let's Encrypt? Да, конечно. Зачем? Да для всего вообще, соответственно, мой сайт личный и за Let's Encryption, просто потому что зелёненький значок, это красиво. На работе всякие временные сервисы тоже Let's Encrypt делаются, удобно. Я тут недавно изучал вопрос на тему за Let's Encrypt эти подкасты целиком, столкнулся с рядом проблем, одна из них, ну то, что у нас много серверов, которым нужно прописать доменные имена, потом все урлы перевесены на эти доменные имена, это ещё решаемая проблема. А потом ты выясняешь, что в DigitalOcean ты поднял форум, ну как бы кнопкой «сделай мне форум на дискорсе», и эта кнопка у тебя внутри развернула докер-контейнер с Nginx в этом докер-контейнере. Теперь у тебя выбор между поднять всё с нуля по-нормальному, как-то выкорчевать из докер-контейнера Nginx и поставить его снаружи, потому что тебе докер уже не очень для этого подходит, потому что у тебя вот этот, я правда не помню, как он называется, Cypherbot или Cryptobot, он должен писать… Certbot. Certbot, спасибо. Он будет писать в диск, и контейнер тут не в тему совершенно, то есть Nginx должен снаружи контейнера стоять, а ставить два Nginx, один из которых пробраться за другое, это довольно толком. Да ладно, нормально, работает, что тут такого? Работает, не трожь. А ещё одна проблема, я не уверен, в чём заключалась, но я помню, что их было больше. Я могу на самом деле посмотреть, у меня есть карточка в личном контроле. Devzen, прикрутить Let's Encrypt. А, почту ещё надо перенести, но это тоже решаемо. А что ты имеешь в виду под переносить урлы на домены, вот этого ты вообще не понял? У тебя сертификат на IPшник не выдается в Let's Encrypt, правда ведь? То есть у нас сейчас прямое вещание, оно идёт с, сейчас скажу, 5.111.105.97, а чтобы прикрутить сертификат, должно быть Live Devzen.ru. Так, ну хорошо. Ну нет, я к тому, что это решаемо, но просто нужно аккуратненько нигде ничего не сломать. А что мешает получить на Devzen.ru? Уже получен, уже получен и уже на самом деле фарвардит куда-то. Я имею в виду звёздочка Devzen.ru. Не-не, wildcard нельзя получать, да. Они вроде обещают сделать, но сейчас Let's Encrypt wildcard не может. Более того, даже когда будет можно, всё равно это большой геморрой, а там арно на все 4-5 серверов, раскатить везде это wildcard, сертификат, ничего не сломать, я вообще не представляю, как это будет работать. То есть намного проще даже без wildcard. Есть просто способ получения сертификата вообще без как бы сервера, да. То есть там можно в DNS прописать некую секретную фразу, которая тебя попросит сердбот. То есть сердбот скажет, типа ага, ну я, короче, типа обратился на Let's Encrypt за сертификатом. Вот, короче, чтобы удостовериться, что ты владеешь этим доменом, типа вот это, короче, вставь в DNS. И ты идешь в DNS свой, короче, записываешь туда там специальную запись, там тексты записи, по-моему, вот, с вот этим вот ключом, который, секретиком, который тебе дал сердбот. И после этого ты, условно говоря, ждешь там какое-то время, когда DNS обновится, нажимаешь там Enter, и он тебе такой ага, проверен, вот тебе типа ключики. После этого ты уже эти ключики раскатываешь везде. Вспомнил, в чем еще была проблема, что у нас сам сайт он хостится не там, где все остальное, и поэтому нужно будет его, ну он нашарит хостинги, где нет суду, поэтому чтобы там нормально сделать Let's Encrypt, нужно его переносить в DigitalOcean, поднимать там лэмпы и вот это вот все геморрой. Ну, то есть все решаемо, но где взять время, чтобы нормально все это настроить? В смысле вообще нельзя сертификат никак подложить?",
    "result": {
      "query": "Digicert reseller SSL key compromise"
    }
  }
]