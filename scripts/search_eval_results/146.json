[
  {
    "segment_id": "4d738cb7-328e-4022-8b8b-4bdf4e3ae267",
    "episode_id": "54ef6377-6a4a-4548-a44e-34056dba5494",
    "episode_number": 146,
    "segment_number": 2,
    "text": "Ну, собственно, теперь мы знаем, почему в ГО идет диск вис-синхронный, если я правильно помню, конечно. У Кости Осипова тоже был клёвый доклад, но про него Ваня расскажет. Да, я надеюсь, что у меня сейчас учинилось, у меня какие-то проблемы с интернетом. Костя Осипов — человек с очень большими знаниями про базы данных и всё связанное, и его очень интересно слушать. Он сделал обзорный доклад про NewSQL, и он это назвал NewSQL еще не мёртвым, я смотрел, что он уже выступал где-то с этим докладом, я, правда, забыл где, по крайней мере, слайды нашёл. И он делает анализ того, куда развивается NewSQL, почему новая SQL превращается в NewSQL, почему революционная классическая база данных тоже превращается в NewSQL. И какие он видит тренды, и какие он видит следующие шаги по развитию баз данных, что отомрёт, что не отомрёт. У него там много спорных моментов, но это его точка зрения, он её аргументирует и показывает, почему это именно так. Чрезвычайно интересно слушать, вопросов было масса, и Косте Осипова после того, как выступление закончилось, просто взяли под белые ручки, унесли в коридор и мучать дальше. Было интересно смотреть, как слушатели его уводят. Но Валерий этот доклад противопоказал, потому что RAI-к там закапывается. Да, там закапывается RAI, там закапывается MVCC и все модели консистентности, там закапывается много ещё и остаётся только SQL. Ну, как бы RAI-к, действительно, уже как бы... Новые проекты я бы не брал, хотя штука... Нет, там даже не столько RAI-к закапывается, там закапывается CRDT, как вообще никому не нужная штука в принципе. CRDT, MVCC и всё, всё уже с ними. Что могу сказать? Человек явно не очень много... Ну, в общем, не сталкивается, видимо, с задачами, где нужно офлайн. Или где нужно переживать, если уж не... То есть, что я хочу сказать, по-моему, даже мысль уже в подкасте один раз озвучивал. Нет необходимости, возможно, действительно, и это только усложняет программирование, если мы пытаемся CRDT впихнуть между сервером приложения и базой данных. Однако история совершенно другая, если у нас действительно или мобильное устройство где-то в офлайне, то есть не знаю, как те же том-том используют CRDT для этого, или если у нас ситуация, когда у нас часть системы, то есть это не обязательно модель клиент, сервер, в смысле мобильный телефон и сервер, а что-то в духе независимых каких-то станций, которые что-то делают. Такого продакшна сухого не было, но это приводится иногда в рецидивистском ресерче. И больше того, по поводу CRDT, да, это не самая тривиальная для переваривания модель, ну, точнее, CRDT сам по себе довольно простая штука, не тривиальная, а вот модель конститенции, которая в обычном системе используется. Но поверх этого как раз устроят абстракции вроде того же самого CRDT, поверх этого устроят абстракции вроде LASK, то есть ведется довольно активный ресерч. И да, это штука, которую нет смысла использовать налево и направо, но там, где она помогает, она может помочь так, ни что больше помочь не может. И я не знаю, как можно при помощи NoSQL или NewSQL решить... Да, NewSQL. При помощи NewSQL решить проблему совместного редактирования документа. Или... Сразу назад у нас был Виктор Грищенко неоднократно, вот он, например, очень много рассказывал про то, где CRDT помогает еще. Или там, как решить проблему клиента, который в оффлайне должен, мочь что-то редактировать. Тот же самый вундерлист, там, конечно, не CRDT в смысле академическом, но там оно явно каким-то похожим образом работает, потому что оно вот... Я пока что не видел того, чтобы оно разъезжалось прям так, чтобы фатально. Поэтому тебе этого нельзя. Ну вот, если приводить CRDT, как бы, в пример на мобильных клиентах, я не совсем с этим согласен. То есть, действительно, мы достоверно в этом подкасте знаем, что в Google Docs используется. И я думаю... Подожди, нет, нет, нет, Google Docs как раз операционное проявление. Ну, это примерно то же самое, нет? Нет, если ты помнишь обсуждение с Виктором, то это как раз принципиально противоположная штука. Нет, подожди, принципиально противоположная она с точки зрения... Как ты сравниваешь ее с CRDT? Но я имею в виду с точки зрения Кости Лосипова, это тоже умирающая вещь, которая должна не использоваться. Ну, не CRDT, я не знаю, а как он предлагает без CRDT операционное прообразование делать совместно редактирование документов? Он предлагает это не делать. Как на мобильных клиентах делают? Ну, то есть, я реально пытался мобильным разработчикам продать CRDT. На что они отвечают, ну, блин, это что-то дофига сложное, и зачем мы сейчас события с таймстэмпом будем посылать, ну, и вы там на сервере как-нибудь разрулите, ну, и оно, судя по всем инстант-мессенджерам, которые я видел, у всех так и работает. Ну, как бы, возможно, если... То есть, я, извини, просто мысль дополню, у мобильных разработчиков их куда сильнее беспокоит, например, что их приложение падает, или что у них там на 3 пикселя что-то разъехалось. А вот там CRDT, вот этим не грузите, пожалуйста. Ну, смотри, ты сейчас говоришь на примере все-таки какой-то одной компании, и конкретно мессенджеры, там тот случай, когда вот посылать с таймстэмпом, это, знаешь, на основе этого, в принципе, можно придумать CRDT такой, типа подсортировать. То есть это не... Это задача, где оно сравнительно... Даже если не брать какую-то хорошую академическую наработку, оно худо-бедно будет работать больше сремени. Если мы возьмем что-то там, типа вот... Хороший пример — это Apple-овские ноутс. Я не знаю, на что там сейчас внутри, но я помню, что еще года два назад, если ты директорировал что-то в двух местах, у тебя в лучшем случае появятся два конкурирующих ноутса, которые тебе придется разрулить руками. В худшем случае, если ты что-нибудь просрешь. Я потерял так некоторые занятия. Да-да-да, то есть это очень фрустрирует пользователей, если приложение таково, что там нету простого способа разрулить, то привет CRDT. Понимаешь, в чем дело? Костя не пытался ответить на все вопросы. То есть он показывал... Извини, а можно... Извини, пока просто далеко не ушли. Вот у меня два мобильных клиента, например, телефон и планшет. Вот у меня, например, телеграм с оффлайн-редактированием сообщений, допустим. Вот я в одном отредактировал, убрал что-то в середине, в другом заменил это слово. Потом у меня оба клиента входят в онлайн. И как мне CRDT помогает это разрулить? Ну, я тебе сейчас сходу не скажу, какое иное CRDT используется, но... А там вообще так нельзя. Нет, я имею в виду, вообще нет нормального способа это как-то разрешить. Нет, ну в принципе, крайнейшем дело, там нормальный, в данном случае это детерминированный, что у тебя в итоге оба клиента придут к одному и тому же состоянию. То есть ты слово отредактировал в одном месте, а удалил в другом. Главное, чтобы потом оба клиента получили в итоге одинаковое состояние. А не так, что один потом так и останется с одним вариантом, а другой с другим вариантом. Ну то есть Apple Notes, он в итоге нормально детерминирован, то есть они всё правильно делают. Типа, послушал совсем просрать? Ну да, ну то есть они одинаковые, оба у меня потеряли все данные. То есть, ну в смысле, те, которые я обладаю. Это не самый худший вариант, но конкретно Apple Notes сейчас починили, и сейчас он, похоже, лучше работает. И как он разрешает ситуацию с двумя модификациями офлайн? Честно, по-моему, создаёт просто как курирующие документы. Но это опять-таки лучше, чем... Во-первых, это одинаково себя ведёт, во-вторых, это... Блин. Ну лучше дублировать, чем удалять. Да, да. Во-вторых, это не так, что у тебя в одном месте что-то одно осталось, а в другом что-то другое осталось. Вот тоже детерминированно себя ведёт. А в случае каких-то правок, типа... Там сейчас есть... Какая-то там, чекбокс и прочие такие штуки, вот это просто, по-моему, даже разруливается само. Ну короче, я к чему веду? К тому, что CRDT – это очень нишевая штука, но совсем закапывать её не стоит. Да, её не стоит тащить туда, где можно проще, но не всегда можно. Валер, я считаю, что Костя, когда он делает свой доклад, он не только про вот эти вот совместные редактирования, он не упомянул ещё, может быть, десяток, если мы посидим, вспоминаем областей, где не будет работать классическая модель. Но он не пытался делать 100%-ный охват. То есть он делал 95%-ный охват, и в 95%-ном охвате, согласись, у тебя CRDT не будет. То есть из всех миллионов компаний, которые сейчас есть на рынке, CRDT есть ему трёх. Ну смотри, я не слушал доклад, не знаю, согласился бы с ним или нет в его формулировке, но мне совершенно точно кажется, что... Точно не согласился бы. Не согласился бы. Я точно могу сказать, что совсем закапывать нельзя, просто потому что некоторые вещи без этого не делаются. Но в чём он прав? В том, что когда тот же самый Amazon рассказал про их прекрасный Dynamo, не путать с DynamoDB, и про то, что у них конкурирующие корзины разлюбливаются мерджем, на твере был совсем другой год, и большие сети были менее надёжные. Сейчас мы наблюдали, как Google рассказывал про то, какая у них крутая между спанерами сеть даже между континентами. Это одна из причин, почему вещи типа CRDT и похожие ослабленные модели консистентности больше не так важны для общения между серверами. И именно поэтому какой-нибудь Rive и подобные модели можно уже не сильно на это обращать внимание.",
    "result": {
      "error": "API request failed: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4.1 in organization org-xSG9D345gtYlIKC330wCyrEG on tokens per min (TPM): Limit 30000, Used 27491, Requested 4411. Please try again in 3.804s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}",
      "stack_trace": "Traceback (most recent call last):\n  File \"/home/andrei/Projects/podcast-shownotes/scripts/build_search_eval_dataset.py\", line 157, in generate_search_query\n    response = await self.client.chat.completions.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py\", line 1927, in create\n    return await self._post(\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1767, in post\n    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1461, in request\n    return await self._request(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1547, in _request\n    return await self._retry_request(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1594, in _retry_request\n    return await self._request(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1547, in _request\n    return await self._retry_request(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1594, in _retry_request\n    return await self._request(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/andrei/Projects/podcast-shownotes/envs/lib/python3.12/site-packages/openai/_base_client.py\", line 1562, in _request\n    raise self._make_status_error_from_response(err.response) from None\nopenai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4.1 in organization org-xSG9D345gtYlIKC330wCyrEG on tokens per min (TPM): Limit 30000, Used 27491, Requested 4411. Please try again in 3.804s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}\n"
    }
  }
]