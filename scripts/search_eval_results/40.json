[
  {
    "segment_id": "d6fc6ca9-2792-46ce-b3ca-cb0b8664da8d",
    "episode_id": "b79751cb-4f38-4b0b-8396-79cdb16b17a6",
    "episode_number": 40,
    "segment_number": 2,
    "text": "Мы делаем B2C, B2B, а мы еще делаем B2G, это бизнес для правительства. Мы делаем продукты невосконагруженные, с которыми сидят всякие губернаторы, министры и тыкают в планшет, чтобы получать информацию. Вот такая штука. У меня основной опыт в разработке фронтенда, но при этом я еще иногда проектирую бэкэнд. Как-то так. Ну, давай начнем тогда с фронтенда. Что вы для фронтенда используете, как? Как используете вообще эту тему? Да, наши пользователи, они работают за планшетами, то есть их рабочее место это планшет iPad или Android планшет. И, соответственно, мы пишем клиентскую часть, это мобильное приложение. Конъюнктура рынка сейчас такая, что непонятно, что в государственном секторе, в российском, по крайней мере, в перспективе будет. То есть что там, останется ли iOS или его там запретят, или там будет засилие Android, или там, не знаю, правительство договорится с Tizen, и у всех будет Tizen стоять, или там, не знаю, Firefox OS. То есть непонятно, что сертифицирует и что станет как бы трендом. Поэтому мы решили делать на веб-технологиях. И, соответственно, в качестве языка для программирования, в качестве рантайма взяли PhoneGap, а в качестве языка для программирования взяли ScalaJS, решили побыть пионерами. Такая штука. Расскажи про ScalaJS, и как у тебя вообще впечатление от этого, и вообще как давно вы начали его использовать? Мы используем его где-то с декабря, с декабря 2014 года. Впечатление сугубо положительное. Я вообще большой фанат Scala, и сейчас я фанат ScalaJS, и хочу его продвигать как можно сильнее, потому что это замечательный язык после JavaScript. И других, как бы, то, что сейчас в мире фронт-енд называется траншпилерами, то есть не компилер, а траншпилер, то, что транслируется в JavaScript. Это, наверное, лучшее, что я видел после гугловского JVT, после, соответственно, кофе-скрипта, после самого ванилла JavaScript, ScalaJS — это просто прекрасно. Никакого WTF. Все понятно, все консистентно, нет никаких неожиданностей, то есть код, компилированный из ScalaJS, ведет себя совершенно так же, как он ведет себя в нормальной среде. А не как JavaScript с JavaScript API. Хорошо, а вот с какими проблемами вы столкнулись при использовании ScalaJS? Вот такие костыли, расскажи, на которые вы наступили, не костыли, а грабли, на которые вы наступили. Ну, как любые проходцы, мы наступаем на все грабли. То есть тут все что угодно. И отсутствие документации, такой, как сказать, туториалов, да, то есть документация есть, но нет туториалов, нет best practice, да, все приходится вырабатывать самим, это довольно, ну, как бы трудоемко. То есть я бы не сказал, что это тяжело, всегда можно подчеркнуть best practice из других технологий, но конкретно собрать их, что-то такое, чем можно пользоваться, и вот что хорошо использовать конкретно в проекте, сложно, да, то есть это набирание опыта с нуля. Потом проблемы с инструментами, да, там, например, отладчика нет полноценного, да, там какие-то из-за этого проблемы, то есть типичные проблемы первого прохода. Но мы их постепенно решаем. Вот, например, у нас была большая проблема, да, мы собрали фронт-энд так, что у нас там первые несколько месяцев жутко текла память. Просто потому что мы допустили одну ошибку маленькую, то есть мы с неправильной стороны зашли, и у нас там в каждом компоненте была маленькая утечка. А вот расскажи подробнее, как вы находили эту утечку памяти, и в чем конкретно была проблема, как вы ее решили? В какой-то момент мы просто увидели, что, ну, как приложение, на котором долго работает тестер, там, тыкает полтора часа, а оно валится. То есть просто какое-то время проходит, длительное, там, полчаса, сорок минут, приложение падает с переполнением по памяти. Ну, мы начали смотреть, профилировать, и, собственно говоря, увидели, что течет, в общем-то, везде. Ну и сейчас, собственно говоря, мы это закрыли. Мы это закрыли просто потому, что поняли, что это как бы везде. И это проблема, ну, не конкретной ошибки, а просто проблема то, что мы неправильную практику использовали. Не усмотрели это, как бы, глобально. А вот хорошо, ты говорил, что вы являетесь первопроходцами. Вот я недавно делала доклад и рассказывала, что про наш опыт использования Scala, как мы переходили и с какими трудностями мы столкнулись. И я хочу сказать, что это было очень, скажем, болезненно, потому что было много проблем, особенно поначалу, и была крайне низкая производительность программистов. И это очень такая неприятная ситуация, потому что хочется что-то там выпускать, хочется что-то делать, какой-то реальный продукт. А получается, что мы тратили время на разбирательство, почему же там это не работает, при этом довольно простые и понятные вещи для скалистов с опытом, а мы наталкивались на такие проблемы. И вот как тебе, как руководителю разработки, то, что приходилось тратить время на вот эти вещи? То есть, очень неэффективно работали, наверное, первое время. А учитывая, что документации нет, у нас хотя бы хоть какая-то была, хоть какие-то опыты других команд в интернете и все такое, а у вас ничего такого не было. И как вот этот момент, расскажи, пожалуйста. На Backend'е у нас тоже часть команды перешла с Java на Scala, то есть они тоже не все сколовики, и им тоже было тяжело. И несмотря на то, что акка прекрасно документирована, проблемы были похожие. То есть реально, например, парни писали какой-нибудь companion object и добавляли туда параллельный мэп, и пытались к этому параллельному мэпу обращаться с актеров, находящихся на разных машинах. То есть вот в таком вот духе. Или, например, эвейты внутри актеров. Но это происходило только первое время. То есть месяц, код ревью, вылавливает все такие вещи. Человек коммитит такую штуку, она сразу видна. Ему просто об этом мы пишем, типа, дружище, так работать не будет, потому-то, потому-то, потому-то. Хорошо, все понял, перечитал документацию, и больше таких ошибок человек не допускает. То есть на сервере так, на сервере бы загладился. На клиенте мы продолжаем бороться, в основном еще потому, что сами до конца не понимаем, как правильно. Но в этом есть некое такое мазофистское удовольствие. Такое ООО, по-новому. А вот теперь, короче, как бы так сделать, чтобы... Теперь это еще что-то придумали, а теперь это мы еще внедрим по всему приложению. О, изящный способ это внедрить по всему приложению, не выкидывая ничего, не переписывая. Интересно, это приятно. Вот, то есть приятно и как бы не по проторенной дорожке идти, да, изучать какие-то там штуки, которые просто лежат в интернете уже два года и только просто тебя ждали, что ты придешь. А самому это дело выдумать, то есть такой рай для велосипедиста. А вот учитывая, что вы делаете все с нуля фактически, вы как-то добавляете какие-то что-нибудь в блоги, или вот вы контрибьютите в документацию, либо вот вы научились и тихонько у себя затаили эту информацию? Ну, пока мы, собственно говоря, контрибьютим только в саму Scala.js, да, то есть у нас возникло несколько проблем с SBT-плагином, вот, там, касательно тестов, касательно линковки. Мы протестировали это дело, хорошенько подготовили патч, им заслали. Они, кстати, классная команда, они тоже очень хороший код-ревью делают, то есть после того, как с ними поработаешь, вот мы с ними поработали, у нас процессы улучшились. То есть мы посмотрели, как работают они, как они внимательно подходят к коду, который приходит извне, как они советы дают, какой у них процесс, и у нас в команде после этого процесс улучшился. То есть полезно запускать программист в open source. Потом у нас есть наша внутренняя библиотека, мы пишем сейчас к ней внутреннюю документацию, да, то есть паблик мы... она есть в GitHub, но как бы она не рекомендуется для использования, поэтому мы ее не оформляем таким образом, чтобы она была привлекательна для программистов. Вот, когда мы сочтем, что она достаточно хороша, вот, мы снабдим ее той внутренней документацией, которую мы пишем и там всем расскажем, что пользоваться нужно именно ей. Вот ты упомянул, что на CodeReview у вас люди говорили, что вот там вы неправильно используете актеры, либо вот с Await там был пример, то есть получается в команде таки были люди, которые с этим имели больше опыта и могли как-то подсказывать новичкам. Ну да, я, собственно говоря, имел опыт с Акой, вот, и еще один коллега, который пришел вместе со мной, то есть, ну, мы примерно, как бы, знаем, как работает Ака и, ну, видим вот эти вот вещи. Вот, ребята, они просто первый раз сели, познакомились там с системой актеров вообще в принципе, с тем подходом. Ну, они бегло прочитали, конечно, документацию паки, но сразу понятие осознать, конечно, сложно там за несколько там недель, дней, не знаю. Вот это правильно, потому что если в команде есть люди хотя бы, которые имеют опыт, то могут нам намного быстрее и комфортнее происходит адаптация новых технологий. Поэтому согласна абсолютно. Можно я вопрос задам? Ой, все живы? О боже мой. Свет, ты там жив? Это не я. Да, вопрос мой был такой. Вот знающие JavaScript программисты, когда им рассказываешь про то, что есть такая замечательная скала JS, или Kotlin, или другой язык, который транслируется в JavaScript, они обычно, у них лицо краснеет, глаза наливаются кровью, и они тебе объясняют, почему ты очень сильно неправ в своем желании пытаться что-то транслировать в JavaScript. Приводятся в частности примеры, что есть масса библиотек для JavaScript, и тебе нужно к ним делать биндинги, и биндинги эти могут, например, не очень эффективно работать, или устаревать, отставать от версии библиотеки. И по моим наблюдениям, это действительно соответствует действительности. Но правда, я не за JavaScript работаю, а с другими библиотеками, и биндинги это реально всегда проблема. Что ты можешь ответить людям, которые говорят, что они будут писать на обычном JavaScript и закапывали в лоток всю твою трансляцию? На самом деле у ребят есть причины к этому. Во-первых, первая причина, что практически все транспилеры тащат свой рантайм. Скала. js тащит скалы рантайм, то есть это иммутабельные коллекции, футуры те же самые, весь предъев, куча имплементаций джавовских классов, эксепшенов, дейт, всякие вот такие вещи. А ClosureScript за собой тащит свои иммутабельные коллекции, проще. И код реально пухнет. Hello World на скала. js весит 200 килобайт. Это большие глаза для JavaScript-разработчика, который пишет на ванилы.js. У меня как у пользователя тоже сейчас очень большие глаза. Но тут нужно отметить, что если ты пользователь, например, админки внутренней, то у тебя глаза будут чуть поменьше. Ну на самом деле сейчас 200 килобайт это не так уж много, по-хорошему. Потому что, собственно говоря, какой-нибудь Angular с каким-нибудь нормальным пухлым стеком библиотек, который тащит средний большой проект, он как раз по размеру рантайму приблизится к 500-600 килобайтам. Обычно зависимости много. Это ведь не Hello World. Естественно. Но Hello World имеется в виду то, что туда подключен рантайм. То есть реальное приложение распухнет еще на сколько-то килобайт. Это проблема номер раз, это вес. У нас она, например, не играет особого значения, потому что мы не тащим эти сотни килобайт по сети. Они лежат в контейнере вместе с приложением PhoneGap-овским и, соответственно, грузятся с локал хоста на WebView-устройство. Нам вес особо не важен. Нам важна скорость исполнения, скорость джит-компиляции этого большого количества JavaScript-кода. Но, к счастью, современные JavaScript-виртуальные машины не исполняют все сразу. Они часть держат в виде для интерпретации. Это так же, как и Java-машина. Не все даже партит, по-моему. Например, наше приложение взлетает довольно быстро. Несколько сотен миллисекунд. Последний раз, когда я трогал PhoneGap, это было очень неприятно в плане взаимодействия с этим, потому что я мог глазками ощущать задержку на реакцию. Ты, Валер, опять пропадаешь. Интернет твой очень нас печалит. Ну, что я сделаю? Почини интернет быстро. Да, окей. Задержка на реакцию. Собственно говоря, тут, в общем-то, как напишешь. Это не проблема PhoneGap, это проблема того, как его использовать. Сам по себе PhoneGap особо не тормозит. Реакция, она обновляется. Насколько я помню, одна из проблем была с тем, что на всяких iOS'ах у тебя же код типа PhoneGap исполняется в WebView, по сути. Может, сейчас они, кажется, что-то допилили, но раньше WebView был самый обычный с платформы взятый. И в платформе этот самый WebView имеет более старую версию движка, чем само Safari. И JavaScript-овое движок в этом WebView значительно более тормозной, чем в самом Safari. Да, есть такая. Или это уже не так? Это так, это до сих пор так. Мы пользуемся плагином, который позволяет встраивать новый WebView. Достаточно хакнутый. Там приходится использовать грязный хак. Это про вес, наверное. Я хотел бы продолжить про темы с проблемами компиляции. Вторая причина — это, наверное, некий снабизн сишников по отношению к JavaScript. Есть такая тема. Если мы зайдем на Linux.org.ru, почитаем тему про Java, первые пять комментариев будут «убей себя как Томми» и все в таком духе. Примерно такой же снабизн есть у скалистов по отношению к джавистам. Его смысл в том, что у нас есть такой низкоуровневый замечательный JavaScript, низкоуровневый ха-ха, в котором мы имеем столько свободы работать с низкоуровневым ха-ха API. И можем делать все, что хочем. Ваш язык непонятный нас ограничивает, отрезает нам доступ к какому-то популярному библиотекам, к какому-то популярному API, к каким-то популярным удобным приемам, которым мы пользуемся, вводят в OJPC строгую статическую типизацию. То есть вот такие вещи. Я недавно был на митапе Moscow.js, и много было, два, по-моему, из четырех докладов были о строгой статической типизации в JavaScript, TypeScript. И как бы спереди меня сидели несколько человек, и шепотом говорили, «Господи, да он же еретик, строгая статическая типизация, она не нужна». И позади меня сидели ребята, они то же самое говорили. То есть есть некие законы внутри сообщества, некие правила, и, собственно говоря, когда Scala. js лезет со своим уставом туда, то она, естественно, встречает сопротивление. Ну, равно как и другие языки. Но я думаю, это временно. Сообщество меняется, соответственно, если показать, что то, что делается с помощью технологий, это круто работает. Алексей, ты не мог бы чуть-чуть придерживать свою гарнитуру? Она у тебя, видимо, немножко касается бороды. Если ты ее будешь немножко придерживать, нам это сильно поможет. Такой вопрос. Я последний раз что-то верстал и писал на JavaScript, дай бог память, года 4 назад, наверное. Я уже как-то отстал от всего этого. Ты не мог бы сказать, что нужно для того, чтобы наверстать упущенное? Какие сейчас рулят фрейворки, технологии? Я вот слышал, Angular рулит непочеловечески, все говорят про какой-то React. Что еще есть? Angular уже легоси. Сейчас все очень динамично развивается в мире фронтенда. Знания устаревают за полгода буквально. JavaScript-мир долгое-долгое время был в состоянии заморозки. Не знаю, с 2005 до 2010 года не так много изменилось. С 2010 по 2015 изменилось примерно все. Технологии требуются взросления, соответственно, она впитывает в себя бестпрактисы со всех сторон, поэтому каждый день появляется что-то новое. Сейчас безумно рулит React. По крайней мере самый большой хайп сейчас по поводу React. React — это такой функциональный веб. Как назвать? Функция, которая вызывает функцию, по которой вызывает функцию, на выходе мы получаем страничку, и все индемпотентно, чисто и красиво. Это React. И при этом очень быстро, потому что он не использует прямое обращение к DOM-элементам страницы, а предварительно обрабатывает в своем виртуальном представлении, только потом накладывает уже прямое воздействие на DOM-браузере. Сейчас, если человек пишет на JavaScript, то он обязательно хочет писать на React. Меня на самом деле как бэкенд-разработчик немного пугает такая нестабильность. Вот хочешь в чем-то разобраться, там, фронтенды, например, офигительные писатели, под Android какие-нибудь приложения, и выясняется, что все меняется, все по-другому. Вот сейчас начнешь учить Android, а кто его знает, что через год Google решит выпустить какую-нибудь новую инновационную платформу молодежную, под которую все будут на Go писать. И сразу спрашиваю, вот React сколько? Год, наверное, полтора. То есть, получается, он появился полтора года назад, стал популярен год назад, и вот сейчас он завоевал все. Но это реально очень динамичная область. Я могу наврать, может быть, даже меньше, чем полтора года. То есть, буквально, может быть, прошлым летом, может, даже год. То есть, получается, я точно могу сказать, учить React уже поздно. А что получается? Нет, на самом деле нет, потому что вышел же сейчас еще React Native, то есть, в Facebook они пошли дальше, они решили, что то, что у них получилось, достаточно удобно для применения, и главное, чтобы не переучиваться. То есть, понятно, что с кодовую базу шарить может получиться, может быть, нет, непонятно, но, например, навыки шарить совершенно точно получится, и они решили, что точно таким же макаром можно писать и под Android с iOS, и они выпустили React Native. Да, React Native, да, замечательная штука, позволяет из джоу-скрипта писать нативными компонентами в React стиле. Ну, я так понимаю, что она еще не до конца выпущена, хотя мои знания уже тоже могут протухнуть. Так и что, все, Angular закопать? Angular первый закопать, потому что выходит скоро Angular 2, в котором все по-другому. То есть, он абсолютно совместим. Так, а может быть, он победит React второй версии, либо она тоже совсем никакая? Сложно сказать. Я пока, например, не ищу по второй Angular. То есть, тут как встретит это дело сообщество. А вот мне советовали посмотреть еще нечто под названием Backbone.js. Что ты об этом знаешь? Ну, Backbone — это мейнстрим, то есть, это вот... Все пользуются. Ничего об этом не знаю. Я знаю, что все пользуются. Не пробовал. А вот еще такой вопрос, правда, не про FrontEnd, а про ACK. Не мог бы ты поделиться своей мудростью, как вы собираете метрики по актерам, как вы находите медленные тормозные места, если они возникают.",
    "result": {
      "query": "ScalaJS frontend development issues"
    }
  }
]