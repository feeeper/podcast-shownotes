[
  {
    "segment_id": "584f36ac-2331-4e89-ac91-1c6b45cbc304",
    "episode_id": "fdaa0da5-5b62-4f7b-a100-680bb4841466",
    "episode_number": 408,
    "segment_number": 8,
    "text": "Это как ничего страшного, а для культур... для других культур прийти на пять минут раньше — это ожидание прийти вовремя. Поэтому не могу не рекомендовать достаточно. А мы в этом подкасте очень чутко ощущаем время, и поэтому вынуждены двигаться по темам. И следующую тему принес Алекс. Всё так. Я, наверное, зайду издалека и сначала спрошу Саше вот... Скажи, Саша, ты когда в Postgres Contribute'ишь, у вас же это работает так, что ты сидишь там, что-то склонировал себе гид, что-то комитишь, комитишь, комитишь, потом такой — ага, ну всё, это можно ревьюить. Делаешь git diff, сохраняешь файлик, отправляешь в mail list, так? Это в корне не так работает. Расскажи, как это работает. Да, ты в git'е пишешь свои ветки, но ты обязательно делаешь формат patch, ни в коем случае не diff. Что это за архаизм такой? У нас современная методология разработки. А, ну вот видишь, если бы я попробовал законтрабюрить в Postgres, нарушил бы социальные нормы. Да нет, многие живут diff'и на самом деле, но лучше вставлять в формат patch и с хорошим commit message, чтобы к комитеру уменьшить работу. Хорошо. Ну вот смотри, и я так рискну предположить, что ревью занимает больше, чем пару часов обычно. Это зависит от патча, ну да, статистически медиана находится выше пары часов. В районе года, наверное, да? Повторюсь, это сильно зависит от патча. Хорошо, тогда следующий вопрос. А бывает ли так, что ты вот отправил один патч на ревью и хочешь начать дальше что-то еще колбасить, что зависит от этого патча? В таких случаях ты обычно шлешь сразу patch set из нескольких патчей. Ну, в смысле, опять же, у тебя в ветке не столько commit'ов, и ты когда делаешь формат тебе делает там, если у тебя три commit'ов, он делает тебе три патча. Поэтому ты можешь продолжить свои ветки фигачивать, сделать rebaze'ы как угодно и сделать новый patch set. Ну да, такое бывает. Ага, ну то есть ты то есть у вас принято, что вот ты прям сделал весь кусок зависимой работы, и ты его ревьюешь одним большим патчом. Или patch set'ом. Ну вот смотри, сейчас, например, большая фича, которую я даже не один пишу, у нас там сильно больше одного человека, 64-битные эксиды. Это сколько там? 6-8 патчей я уже не помню. Из них принято решение, что три надо мержить. Ну, даже при том безоконнотительной судьбы остальных. Это рефакторинг контейнера, который называется Ascel Reuse, смысл которого не очень важен для нашего обсуждения. Но у тебя вот был patch set из 6-8 патчей, в результате обсуждения было решено, что вот это подмноженство мы точно хотим мержить. И что произошло, был создан надельный трет, и мы сказали, что вот эти три патча, которые точно мержат, они обсуждаются в том трете, а в этом, в главном трете мы обсуждаем высокоуру у него их и чём. То есть трет распался на 2. Ага. Понятно. Тогда, Валера, я так догадываюсь, что вы работаете на гитхабе, да? У вас код на гитхабе, да? Да. А ревьюетесь вы пул-реквестами? Да. А бывает ли у тебя так, что вот... Хотя нет, я спрошу так. У вас принято пул-реквесты делать побольше или поменьше? Зависит. Для контекста скажу, что вот у нас на работе в целом считается предпочтительным отправлять небольшие ревью, потому что их гораздо легче понять от ревью, чем там, если тебе прислали, смотри, 2000 строчек плотного плюса. У нас теоретически поменьше, и обычно получается поменьше, но не всегда получается поменьше. Иногда бывают большие пул-реквесты. Ну, да, это справедливо, так бывает. Но в целом, как ты сказал, обычно хочется, чтобы поменьше было. Ну, давай так, 1000 строк – это скорее редкость, чем норма. Чаще, не знаю, ну, 500, наверное, 8 сотен, наверное... Давай так, меньше 800 строк – я бы сказал, что это, наверное, именно чинч-шетта, который нужно реально смотреть, а не всяких генерированных файлов, это, наверное, 80-ый процентиль. Тут нужно язык упоминать. 80 строк на Python и на C это разные. На SQL. Ну, то есть у нас обычно SQL и Rast. 80 строк кода на SQL? Ну, да. Фига себе. Ну, опять же, это медиано. Это не то, что каждый пул-реквест, 800 строк, я скажу, что, скорее всего, 80 и 85 процентиль, меньше 800 строк кода на SQL. Это брутально. Ну, опять же, там нужно понимать, что SQL, он... Пл, пж, SQL, там, особенно, и там gtap-тесты на него, они достаточно... как это по-русски? Избыточные, именно в плане всяких определений. Типа, у тебя там будет очень маленькое тело, как правило. Зато вот здесь create procedure, у вас такими кучи параметров, вон там, короче, отдельно grand, access, вон эту всю штуку, отдельно, значит, создаем комментарий на этот объект в базе данных. То есть, как бы, типа, мы просто имя этого объекта десять раз упомянем, прежде чем мы закончим с ним работать. Понял, понял. Многословно. Ну, ладно, это на самом деле не суть. Мой настоящий вопрос в том, что... а вот у тебя бывает так, что ты отправил пул-реквест, и ты хочешь начать работать над следующим пул-реквестом, который ты хочешь отдельно ревьюить, но он зависит от предыдущего. Да, пул-реквест, поверх пул-реквеста так иногда приходится делать, это не очень часто бывает, но делаем. Ну вот, у меня на работе... А потом rebase на master после merge. Да. У меня на работе похожая система, у нас превью делается через систему, которая очень похожа на Gerrit, если кто-то с ним сталкивался. Система контроля версий, это так хитро кастомизированный Mercurial, скажем так. Света, ты что-то добавить хотела? Света такая кек Mercurial. Ну, в общем, там на самом деле все очень сложное и очень кастомизировано, но для нашей беседы пойдет достаточно сказать, что как бы Mercurial. Расскажи про Gerrit, что это такое, отразительный слух его. Gerrit, ну, это такая система для код-ревью, она работает с Git. Если вы когда-то увидели в Go, то вы видели Gerrit. По сути, это такая система, ты в нее загружаешь то, что называется Change List. Вижу Свету в чате. Да, Gerrit. Я понял, это такой уреженный GitLab, да? Это чисто вот та часть GitLab, которая отвечает за код-ревью. Он не хостит репозиторий в себе, он просто позволяет тебе удобно комментировать почтат. Ну, или в данном случае слово называется Change List. Света, расскажи почему ты такие грустные эмоции, что с ним не так? Вы его видели хоть раз? Бог не видел. Это же, это же, это же ужасно! У меня прям травма после этого. Ну, он за последние годы, когда все-таки стал получше. Они, по-моему, два или три года назад полностью переписали Frontend, и он стал более человеческий. Он больше не привет из 80-х. Не, он теперь привет из 2000. Нет, я просто, я, честно, не доумеваю. Я зашел на сайт, но тут какие-то скриншоты, но они вполне себе выглядят. Ну, как-то приемлемо. Не 80-е, нет. Ну, в общем, еще раз, если хотите вот посмотреть, как выглядит Gerrit, зайдите в репозиторий Golang, найдите pull request, и там будет в каждом pull request bot постит ссылку на Gerrit, где, собственно, происходит review. Вот. У нас используется эта система, и у нас используется Mercurial, и как это у нас организовано, что ты просто тупо берешь, коммитишь цепочку коммитов, прямо вот на мастер, никакие бранчи не делаешь, и потом у нас есть команда Mercurial upload, и он берет каждый коммит, загружает в отдельный чейндж-лист в",
    "result": {
      "query": "Gerrit vs GitHub code review"
    }
  }
]