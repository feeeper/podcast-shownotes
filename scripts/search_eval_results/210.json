[
  {
    "segment_id": "fe070517-6d29-4287-bc43-a33f88698cb0",
    "episode_id": "31583a6a-8bbb-4a05-990d-dbe2246b073c",
    "episode_number": 210,
    "segment_number": 9,
    "text": "Заметьте, что некоторые из вещей, которые мы с вами затронули, как Linux и JavaScript, они явно создавались не для того, чтобы вырасти такими большими. Они создавались как-то очень быстро и на коленке, с тем, чтобы хоть что-то заработало, и потом разрослись до тех масштабов, которых не планировали. Linux до сих пор меня тревожит тем, что это большое моноядро, которое экспоненциально растет с каждым новым драйвером, который в него попадает. Это преувеличение, что Linux — это моноядро. То есть это ядро действительно, архитектурно это монолит, но он же разрезан на драйверы. Я часто слышал эту критику, что Linux — монолит и все-все-все тащат в ядро, но это же неправда. Права доступа у драйверов сильно отличаются от права доступа в логике ядра. Права доступа — это что имеешь в виду? В каком кольце они исполняются? Насколько я сведомлен, в том же нулевом, что и ядро. Вот, значит, они могут точно так же все испортить, как и само ядро. Хорошо, а если мы перейдем на микроядерную архитектуру с изоляцией, где драйверы будут из юзерспейса звать ядро, ты считаешь, что оно станет быстрее? Дело не в том, что оно станет быстрее. Мне кажется, что мы навратили столько всякого, что мы не можем сделать. Такого нехорошего в наших слоях в юзерспейсе, что мы можем ради того, чтобы все очистить с нуля, пожертвовать немножко производительностью на этапе ядра. К тому же я не видел каких-то очень убедительных бенчмарков по поводу того, что микроядра, они медленнее, чем монолитные ядра для обычных задач. То есть мне кажется, мы можем себе это позволить. Если это позволит нашим системам быть более строгими и безопасными. Я все время много работал с QNX, и я не заметил, чтобы она была медленнее. У нас очень интересно пошло обсуждение, потому что Никита как раз пишет про то, что все становится медленным, и любая проблема решается там, давайте докупим еще немного железа, и он против этого, давайте сделаем софт быстрее. А ты предлагаешь сделать софт более модульным и архитектурно верным, что я одобряю, докупив для этого на 15% больше железа. Мне кажется, ты немножко missing the point, потому что ты, как это, то, что ты предлагаешь Диму, он как бы, знаешь, сколлапсировать лишние слои абстракции. То есть типа так, где у тебя сейчас в ядре в линкс наворочено 100-500 слоев абстракции, потому что типа вот тут слишком низкоуровнево, а вот тут уже, ой, а теперь снова нискоуровнево, и поэтому у нас там, не знаю, там есть, короче, такой девайс, поверх него такой девайс, поверх него еще какой-то девайс, потом еще девайс, а потом еще какая-нибудь виртуальная чего-нибудь система, а потом поверх нее еще слой кэширования, а потом короче user space начинается, в user space еще пару слоев абстракции. Вот если у нас, типа, просто условно быстро работающая микроядро, на быстро работающее микроядро, может там хватит пары слоев абстракции, если, не знаю, сесть, подумать, сделать правильно. Мне кажется, речь об этом. Что типа мы сэкономим просто на как бы уплощении пирога абстракции. Мне кажется, ты как-то, мягко сказать, не совсем правильные вещи говоришь. То есть, во-первых, ну давай начистоту, никто из нас не является настолько экспертом в ядре Linux, чтобы понимать, сколько там на самом деле слоев абстракции. А во-вторых, я не очень понимаю, как ты предлагаешь абстрагировать, не знаю, какое-нибудь кэширование файловой системы в микроядре или как-то иначе. Ну как ты его абстрагируешь в модуль изолированный? Ну фантастически это не звучит на самом деле. Ну типа по пайпам ходить с запросами? Ну нет, я могу себе это представить, я просто действительно не убежден. У меня, конечно, нет батчмарка, который как-то правдоподобен, но в моей картине мира ходить по пайпам, по системам кэширования по моему представлению это баттлнек и это сильно затормозит вообще все. Я хочу отметить, что я не прочитал Стасю и Никиту как проблемы у нас с производительностью. Мне кажется, проблема в целом, что софт экосистемы, которую мы вырастили, она гнилая. Производительность это симптом. И для того, чтобы избавиться от основной проблемы, о том, что стэк гнилой, его нужно как бы снизу вверх начинать оздоравливать. В этом плане, ну и я понял твой аргумент, Саша, о том, что Линукс может быть не такое плохое начало, как можно показаться, но в академических кругах, насколько я понимаю, совершенно очевидно, что микроядра, они выигрывают по тёжности у моноядр. Единственная причина, по которой мы не используем микроядро, потому что никто до сих пор нормального не сделал. То есть вот этим и надо заниматься. Нужно делать нормальный софт, на котором мы можем потом построить экосистему. На самом деле мы же выяснили в предыдущих DevZen, что в каждом процессоре от Intel сейчас работает маленький Minix, который как раз является системой с микроядрами, если я ничего не путаю. Другой вопрос, а вот хорошо, а как бы так поговорить с производителями железа, чтобы они не огородили слоев абстракции и не запускали свои операционные системы вот в каких-то специальных модулях, которые рядом с процессорами. Что нужно сделать, чтобы никому не хотелось такого? Насколько… я не специалист, конечно, но моё понимание такое, что здесь бизнес пытается минимизировать свои риски в том смысле, что ты железо не можешь обновить, железо, ну его дорого и сложно обновлять, тебе приходится из-за ошибки в FPU отзывать всю партию, компенсировать как бы вот все эти понесенные пользователями потери. А если ты сделал часть логики в ферму Варя, то ты, ну, это сделано в софте, а в софт обновлять легко и приятно. И ну это довольно естественно, что какая-то логика, она, ну чем больше логики в софте, тем бизнесу лучше. И что-то мне подсказывает, его вот так просто не удастся отговорить, пожалуйста, не ставьте никуда пользователю Миникс. Ну это как бы ортогонально, было бы здорово, чтобы эти параметры были намного проще и программировать их было легче. Но мы можем пока со своей частью хотя бы побороться, что идет после процесса. Еще интересное наблюдение, что на самом деле DirectX 12, Vulkan и так далее, они как раз же идут против того, что говорилось про модульность и слои абстракции, то есть Vulkan и DirectX 12, они сносят слои абстракции, чтобы мы работали с GPU так, как они на самом деле внутри устроены. Когда OpenGL как раз это уровень абстракции, который говорит я ничего не знаю про то, как работает GPU, но IP у меня вот такая. Как раз я бы сказал, что DirectX 12 и Vulkan и все эти ребята, это шаг в правильном направлении, потому что у тебя есть какая-то старая гнилая абстракция, которая была придумана для хер знает чего, в хер знает каких волосатых годах, сто лет больше ничего общего не имеет с тем, что на самом деле происходит, и все пытаются до сих пор в нее как-то вкорячить свой второго программиста движка, то есть они уже с современным игром пытаются как-то это из OpenGL выжить, а производители железа, бедняжки, пытаются современное железо подогнать под эту кривую абстракцию. И как бы с точки зрения вот этого подхода нафиг гнилой стэк, это самое правильное, что можно сделать, просто вырвать с корнем гнилую, давно не работающую, вонючую хрень. Ну вот тут я вижу противоречие в аргументах, которые сами себе противоречат, потому что микроядры это точно такая же абстракция, которая не имеет отношения к тому, как на самом деле работает современный железо. Микроядры это вообще порой другое. Ты как это… микроядры это про разделение привилегий. То есть, не знаю, у тебя сейчас достаточно эффективно умудряются запускать виртуальные машины внутри какой-то хост-системы, и они прекрасно разделяют привилегии, и там с последними там наработками, которые кажется Amazon контрибьютил в игру Linux, там сейчас практически нулевые косты этого. То есть, нужно разделять, там, не знаю, микроядер, как подход про разделение привилегий, и там, не знаю, эффективность имплементации и слои абстракции, это, на мой взгляд, достаточно разные такие вещи. То есть, как раз-таки эффективная реализация какого-то хорошего, там, не знаю, разделения привилегий, разделения, не знаю, как-то вещей, которые не имеют ничего общего друг с другом, и при этом не слишком отдаляясь от современных железных реалий, это был бы какой-то идеальный вариант. Мне трудно как-то провести пролив между OpenGL и микроядром. Я не совсем понял. Мы обсуждаем как раз две крайности, то есть, одна крайность — это все максимально абстрагировать, и вот прям слой абстракции на слоем абстракции, и прям очень сложно. Другая крайность — это давайте сметем все слои абстракции и будем вот как бы по минимуму их использовать, а решение на самом деле где-то вот между, что для GPU имеет смысл иметь чуть поменьше абстракции, для операционной системы и соображений безопасности и надежности может иметь смысл иметь чуть больше абстракции. Сказано, есть какой-то смысл. Ну да. С GL там же все просто-просто неудачный уровень абстракции. Дело не в том, что он есть, дело в том, что он плохой. То есть, если бы он был хороший, отлично было бы. Может, WebGPU будет хороший, может, все начнут использовать WebGPU вместо OpenGL, без того, чтобы они шли в браузер, совершенно, то есть, просто как родной API на платформах, и все будут так же счастливы, как когда-то с GL. Посмотрим. И засунут его в электрон, и у всех на десктопах будет только такой GL. Только если через WASM. Что еще только через WASM? Да, только если его засунут туда через WASM. Да, это извинения Торвальдса. Перейдем к Торвальдсу? Да, эта тема была добавлена тобой, я предлагаю тебе и отдуваться. Или, а, на самом деле она была добавлена мной, но почему-то я здесь не отмечен как участник. Но в любом случае, может, расскажешь, что произошло-то? Не, я, пожалуй, не буду рассказывать. Ну, хорошо. Линус Торвальдс к релизу 4.19 RC4, в числе прочего, написал, что так, мол, и так, я осознал всю глубину своих заблуждений, и я подумал, что, возможно, покрывать мотюками разработчиков ядра это не самая лучшая мысль. Поэтому я на время как бы немножко выпилюсь и подлечусь, а вы тут пока развлекайтесь. Я все правильно рассказал, Валер? Я, если честно, не очень следил. Да, мне кажется, правильно. А еще они внедрили в скоростном порядке новый кодов-контакт. А что там? Про него я знаю только то, что там огромный список вещей, которые нельзя делать больше, переписки, о ком нельзя плохо выражаться и как нельзя себя вести. И то, что его внедрили в очень ускоренном режиме, не дожидаясь того, как пройдет вот эта встреча в октябре, и народ как-то немножко в недоумении, почему все, что происходит, и кто клюнул Линуса в больное место. Ну, то есть, постой, я правильно понимаю, что по-новому кодов-контакт, что, получается, нельзя называть авторов патчей, долбанутых на голову недоносками, не знаю, с выбитыми зубами? То есть так нельзя, что ли? Ну, я думаю, что твой вопрос весьма самодостаточен. Вот скажи мне, Саша, тебе нравился образ твоего лица, или ты всегда считал, что он такой козел, и что его нужно усмирить? Да у Саши портрет вещи дома, ты его разве не знаешь? У меня не весят портрет, у меня стоит бюст по улице, такой в натуральном масштабе. Мне когда грустно, я к нему подхожу так поплакаться и обняться. На самом деле, ну, как бы есть за и против. С одной стороны, я представляю, что я написал ядро Linux, и выложил его в open source, и понабежали люди, и стали пихать в меня какими-то патчами. И, ну, простите, это мой проект, я с ним делаю, что хочу. Ну, то есть если вас что-то не устраивает, ну, вы можете остаться, вы можете уйти, вы можете обидеться, но все равно остаться. Ну, то есть как бы свобода выбора. Ну, то есть если Торбольдс, он по темпераменту и прочим характеристикам, ну, вот такой человек, ну, как бы никто не совершенен. А с другой стороны, уже, я думаю, существенная часть ядра написана не совсем им, и это не совсем его проект, и проект этот международный, над ним работает много людей, которые взрослые люди с чувством, собственно, достоинства, которое, наверное, не слишком благоразумно оскорблять безотносительно того, что ты на самом деле об этом человеке думаешь. Да и вообще по жизни как бы не очень хорошо иметь репутацию человека, который матюками авторов патчей покрывает. Ну, вот просто ты такой приходишь на конференцию или идешь по улице, и все на тебя так касятся, что типа, а, это же тот самый. Поэтому, ну, как бы, с моей стороны, я не испытываю никакого осуждения или одобрения, ну, он решил, что, наверное, так больше не стоит. Ну, хорошо, я более-менее равнодушен к этому. Нет, я крайне-крайне рада этому событию, и в первую очередь потому, что Линус является такой ролевой моделью для очень многих программистов. И зачастую, когда людям указывались на какие-то неадекватные элементы их поведения, они часто говорили, что вот, смотрите, Линус вот так себя ведет, ему-то можно, чем мы хуже. И сейчас, когда Линус признал, я думаю, что это сподвигнет, я очень надеюсь, что это сподвигнет многих людей пересмотреть свои принципы и сказать, ну вот, Линус-то сознался и понял, в чем была проблема, и давайте-ка мы тоже будем более адекватными и не будем никого обижать. Слушай, Света, если человек изначально был идиотом-недоноском с выбитыми зубами, то от мнения Торвальдса ничего не изменится, он как был недоноском, он так и останется с выбитыми зубами. Я думаю, ты говоришь про очень такую маленькую относительно группу прямо конкретно от саженных людей, но есть какая-то большая группа людей, которые вполне адекватные, они просто смотрели и брали пример с Линусом. Не потому, что у них какие-то свои принципы личные, что вот я буду себя вести так, потому что я ненавижу всех людей. Такие люди наверняка тоже есть, но их, как я говорю, не так много. Поэтому это большой шаг для сообщества, я очень рада по этому поводу. Интересно, что всё-таки заставило его поступить таким образом, признаться публично. Это, наверное, навсегда останется за кадром. Но когда ты говорил, Саша, что это проект его, и люди пришли начать своими почами бросаться, действительно, он начинал этот проект, но этот проект уже давно не его. Это проект как достояние общественности. А потом снимут документальный фильм, где на самом деле у Торвальдса похитили клетку с любимым попугайчиком и шантажом заставили его пойти лечиться шокотерапией. Даже если это так, я, скорее всего, согласен с Светой, потому что она в подростковом достаточно возрасте и читал выдержки из ЛКМЛ, и он ругается на людей, и смеялся, и в какой-то смысле считает, что это часть культуры. Потому что когда ты человек с таким влиянием в сообществе, ты неотъемлемо влияешь на формирование новых программистов. Если новые программисты, или хотя бы какая-то их часть формируется... Ну ладно, я это воспринимал скорее как смехуёчки. Есть люди, которые действительно берут это как role model. И это очень печально, когда так получается. И как раз хочется иметь, ну не знаю, другие role models и других героев. В том плане, что... Потому что Линус это клёвый герой с точки зрения того, что он внес невообразимый вклад в развитие практически всего серверного софта. С другой стороны, он внес довольно спорный вклад в развитие культуры общения. В open-source проектах. Наверное. Ещё хотел бы отметить, что проект его или не его. Понятное дело, что код уже не его. Но чем он владеет, это процессом развития этого кода. То есть он же был собственно человеком, который принимает или не принимает патчи. Код останется не его, но он всё-таки имеет право отклонять патчи. Имеет право ругаться на людей, которые предлагают какие-то плохие патчи, чтобы влились в ведро. В плане того, что раз код не его, значит он полагается, что может не иметь права там кому-то грубо что-то сказать. Нет, он стоит у ворот и имеет право отослать кого хочешь. Мне кажется так. Тут такой вопрос, что вот я, с одной стороны, вот я захожу в интернеты. И поскольку я не первый год в интернетах, то тут есть такой негласный контракт, что в интернете себя любой может покрыть матьюками. С другой стороны, я не уверен, какой раздел философии этим занимается, но вот как бы два человека стоят рядом. И имеет ли один из них моральное или какое-либо иное право опускать чужое достоинство? Кто-то скажет, что наплевать имеет, кто-то скажет, что нет, не имеет. Потому что чувство собственного достоинства – это нечто священное. И мы должны защищать права людей. Ну как-то вот к чему-то такому сводится вопрос. То есть можно покрывать людей матьюками или нельзя? Ну окей, ты сводишь просто к базовым элементам культуры. Я встану на защиту Линуса, потому что мне кажется, его недостаточно защищать в нашей дискуссии. И скажу, чем он мне нравился до ухода. Не тем, что он был кругом. То, что у него были яйца. У него были яйца и главное, что он был искренен. Вот что мне нравится. Искренность – это то, что современный мир все больше и больше теряет. Потому что искренность… Похоже, что искренность не работает в больших масштабах. Но вот я очень заметил это просто, когда переехал в Канаду, что я увидел, что здесь люди совсем не такие искренние. Они улыбаются всегда, а не тогда, когда им на самом деле хорошо. И в разговоре их сложно. И трудно добиться и пробиться через их слои защиты, для того, чтобы понять, что человек действительно думает. Только если ты можешь там в баре и можешь напоить человека очень хорошо. И Линус мне нравился именно тем, что он очень искренен. И мне будет этого не хватать. Мне кажется, что… Возможно, искренность не работала, но было бы здорово придумать какую-то модель общения, в которой мы все же остаемся искренними. Я еще хочу немножко вставить, что еще в защиту Линуса. Чаще всего такие перепалки происходили, когда ему присылают патч, он только говорит «нет, так делать мы не будем». Потому-то, потому-то. После чего ему там начинается спор. В какой-то момент он просто взрывается и говорит «да ты идиот, бла-бла-бла-бла-бла, кретин с убитыми зубами, недоносок, яда-яда». На самом деле это ведь интересный вопрос, как вот ты мейн-тренер большого проекта, тебе не хочется опускать планку кода ниже чего-то. То есть, например, мы не ломаем юзер-спейс никогда. Вот возьмем такой критерий. И не хочется тратить время на объяснение идиотам, что они идиоты. Ну, даже дело не в этом, просто тебе начинают дипломатически пытаться включить какой-то патч, потому что он нужен какому-то вендору, например, и он что-нибудь ломает. Вот. А ты этого не хочешь. И ты можешь просто создать такой, не знаю, барьер вхождения в это, что просто ты должен выносить этот барьер, чтобы мочь туда пушить, а не просто каждый с улицы. То есть, возможно, это даже какой-то был интеншонал барьер к тому, чтобы не пускать людей туда лишних, потому что там их и так хватает. Одно можно подождать наверняка. А, извини, Света, пожалуйста. Вы когда-то сказали прекрасные слова про то, что Линус был искренним и по поводу общаев искренности и разницы культур. Ну, есть две крайности. В одной тебя искренне опускают и посылают тебя матьюками, а в другой тебе улыбаются и тебе скажут, что, слушай, ты не прав, но при этом тебя не будут опускать матьюками. И тебе скажут, слушай, ну, ты классно что-то это сделал или сделала, но подумай еще, как можно улучшить какой-то процесс. Да, возможно, такая коммуникация дольше времени занимает, но с точки зрения человеческого достоинства и самоуважения, то есть вообще ощущение, мироощущение, оно сильно отличается. И я почувствовала это после переезда. И я, честно говоря, не хочу вернуться в культуру, где мне грубо посылают. Да, честно, грубо, искренне меня посылают и мне искренне ненавидят. И все-таки мне намного комфортнее жить в культуре, в которой людям просто по умолчанию уважительно относятся. Если человек делает какую-то ерунду, не говорит, что человек дебил и человеку нужно там выбить зубы или что-нибудь еще с ним сделать, а попытаться помочь этому человеку осознать, что было не так и чтобы все, как это, вот была такая нормальная атмосфера, а не атмосфера ненависти. Могу я ставить маленькое замечание? Точнее, у меня есть вопрос. Скажи мне, пожалуйста, Света, почему ты считаешь, что вот эта культура, которая тебе нравится, она намного лучше всех остальных культур, включая финскую, напомню, что торвальцо финк, если я ничего не путаю. Я вот к чему клоню, что культур их много. И утверждать, что из них одна, где люди друг другу врут в лицо, вежливо улыбаясь, что такая культура намного лучше других культур, но такое утверждение ни на чем не обосновано. С чего вы взяли, что они врут в лицо, улыбаясь? Вопрос не в этом. Вопрос в том, почему, ну как бы, на основании чего можно строить утверждение о том, что одна культура лучше другой. Ни на чем примерно. В любом случае, нам будет не хватать Ленуса, Ленусу будет не хватать его яиц, а нам, похоже, не хватает, что еще сказать по этой теме, поэтому я придаю слово Валере. Ой, да, точно. В общем, тут нас попросили попиарить с каломитап в Москве. В общем-то, наш хороший знакомый Алексей Фомкин много раз у нас бывал. Включе 4 октября состоится с каломитап. Все подробности по ссылке. Я же хочу рассказать про конференцию OffZone, которая пройдет в Москве в этом году в ноябре, точнее с 15 по 16 ноября. И проводит эту конференцию компания BI-Zone, это компания, которая занимается информационной безопасностью. И, по сути, если так на пальцах и прямым текстом, то это как Zero Nights, только Zero Nights в этом году почему-то проходит в Санкт-Петербурге, а вот в Москве будет OffZone. И на самом деле очень интересно, что произошло. То есть это просто Zero Nights решили в этом году в Питере провести, а BI-Zone такие типа, о, короче, хата свободна, тусим. Может быть они как-то заранее между собой договорились, что типа, ну давайте мы как-нибудь там каждую в своем городе будем проводить.",
    "result": {
      "query": "Linux microkernel vs monolithic"
    }
  }
]