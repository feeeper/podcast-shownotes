[
  {
    "segment_id": "ba70fd4b-d3cf-4bbd-b057-d10921828ca7",
    "episode_id": "6416a8ae-bab1-4deb-a74f-ce75dfbc0358",
    "episode_number": 473,
    "segment_number": 7,
    "text": "Так вот, тема такая, что пару, наверное, месяцев назад я совершил некоторую экскурсию в домашнюю автоматизацию, которая была мотивирована попыткой немного автоматизировать управление моими радиаторами для обогрева в доме. Радиаторы, не знаю, старые из 80-х годов, поэтому они управляются совершенно аналоговыми ручками и я подумал, что ну я же умный, у меня есть 3d принтер и у меня есть паяльник, я наверное что-то сделаю из этого. Вот и с этого понеслось home assistant, микроконтроллеры, вот это все. И то, о чем я хотел сегодня рассказать, это такой проект под названием ESPHome. Кто-нибудь из ведущих с ним сталкивался? Не угадаю. Какой-то open source проект на основе ESP32. Хорошая догадка. Кто-то еще сталкивался? Нет, но очень интересно. Ладно, тогда я расскажу для вас и для слушателей тоже. Возможно не ESP32, а ESP8266 по-моему. Он на самом деле поддерживает, по-моему, всё семейство ESP микроконтроллеров. Этот проект это такой, как это назвать-то наверно, фреймворк для прошивок микроконтроллеров, ориентированный как раз на домашнюю автоматизацию. Грубо говоря, он позволяет решать такие задачи как сделать какой-нибудь актуатор, чтобы там не знаю ты нажимаешь кнопочку у себя в Home Assistant, а он поворачивает ручку или нажимает кнопку или активирует какое-нибудь реле или еще что-то в таком роде. Он также поддерживает кучу разной там периферии, такие как сенсоры влаги, степперы, инфракрасные всякие детекторы, близости короче, вся стандартная периферия, которая может понадобиться для домашней автоматизации, она скорее всего поддерживается. Вот и что еще классно про этот фреймворк это то, что он очень хорошо интегрируется с Home Assistant, то есть ты прошиваешь свой микроконтроллер, нажимаешь пару кнопок и он у тебя сам находится через Wi-Fi, подключается и ты можешь сразу нажимать кнопочки в WebGuiшечки и внезапно происходят вещи в реальном мире. Вот. Хоум асистент это кто? Это что? Хоум асистент это популярное open source решение как раз вот для управления умным домом. Он поддерживает много обычной периферии которые ты можешь магазине купить которые произведены в индустрии так сказать да вот Саша ссылку в чате запостил, да, это оно и есть. Грубо говоря, это такой хаб для умного дома, который open source и который поддерживает кучу всякого internet of things вещей. Основная причина, по которой мне он интересен, это то, что он позволяет иметь умный дом, который не зависит от облака, которое находится где-то бог знает где, и если у вас не гнет интернет, то вы все еще сможете включить-выключить свет. Но это все не суть важно, важно то, что проект ESPHome позволяет как раз очень легко соединять вот этот вот интерфейс людей с какими-то вещами в реальном мире, когда ты пытаешься сделать что-то свое собственно, какие-то свои инструменты, какую-то свою автоматизацию руками DIY. Одна из вещей, которые меня, мягко говоря, привели в шок про этот проект, это то, что когда вы настраиваете прошивку, он полностью бежит в браузере. То есть весь ESP home он устанавливается как демон на Unix, у него есть веб интерфейс, там ты, грубо говоря, конфигурируешь прошивку, он тебе автоматически ее компилирует, а дальше могут произойти две вещи. Первая ты можешь просто скачать бинарник и прошить ее, как обычно прошивают микроконтроллеры. А вторая вещь, которая меня по-настоящему ужаснула, это то, что браузеры в наши дни поддерживают стандарт web usb и твоя страничка, если ты ей разрешишь, может просто прошить твой микроконтроллер по usb вот прямо из браузера. А, да так вот я мне сказал клавиатуры Kichron и вообще прочей QNC в подкаст, вот они примерно по такому же принципу, их приложения работают. Приложения. Да, когда ты об этом говорил, я думал, что просто в клавиатуре какая-то умная прошивка, которая умеет как-то с этим взаимодействовать. Но тут я просто, знаешь, ты покупаешь обычный микроконтроллер с Амазона, в нем нет никакой прошивки. Ты точно знаешь, что в нем нет мозгов, и он все равно прошивается из браузера, и это, мягко говоря, очень круто и очень ужасно. Справедливости ради, если он прошивается через браузер, то скорее всего в нем прошицер, а не какой-то bootloader. Ну да, bootloader, скорее всего, там есть какой-то стандартный ESP32шный или 86, что-то там, я не помню. Это про 866. 866. Хорошо, я совершенно не в состоянии запоминать числа, особенно больше трех знаков. Так вот, теперь про плохие вещи. Это очень крутой проект для тех, кто не очень любит, собственно, ковыряться с микроконтроллерами, которые просто хотят, чтобы вещи происходили. Но за его простоту в использовании надо платить в первую очередь тем, что вы будете программировать на ямле со вставками С++. Чего? Настройка прошивок выглядит так, что у вас есть, грубо говоря, вы пишите конфиг на ямле, который говорит, что пин 1 и пин 2 они будут управлять моторчиком такого-то типа, и этот моторчик будет соответствовать такому-то логическому порту, на который Home Assistant будет присылать команды. И по сути вы пишите такую большую портянку о том, какие пины к каким логическим элементам подключаются на ямле. После этого этот фреймворк прожёвывает яму, компилирует прошивку, включая все нужные модули, которые поддерживают все ваши моторчики, выключатели, сенсоры и так далее. И вот эта скомпилированная прошивка собственно прошивается на микроконтроллер. Довольно быстро вы упретесь в ту ситуацию, что вам захочется запрограммировать какое-то условие, то есть например если первый выключатель выключен, то попытка пошевелить моторчиком должна быть запрещена. Что-нибудь такое, я не знаю, выдумываю из головы, но вы понимаете идею. Такое тоже можно выразить, но поскольку программирование на Yaml имеет определенные ограничения, в ESP Home решили эту проблему таким образом, что вы просто вставляете небольшой сниппет на C++, который будет скомпилирован куда-то в нужное место этой прошивки, который опишет условия, когда и что должно происходить.",
    "result": {
      "query": "что такое ESPHome"
    }
  }
]