[
  {
    "segment_id": "bb86f0b8-8f49-46b6-9bce-45f062caf7cb",
    "episode_id": "51b38cfd-a5c2-4518-81f8-d5ba884b9c92",
    "episode_number": 413,
    "segment_number": 2,
    "text": "Ну и раз мы все так здорово все обсудили, пошли к следующей теме. Да, где симпт обсуждают, это в более новой версии курса, который смотрит Саша. Ну то есть я тоже подписан на семью, но если Саша смотрит, как он рассказывал, 20-го года курс, то я, в реальности, пограду, что-то новое выходит, и я не все смотрю, только то, что, если вижу, что тема такая, что я прям чувствую, что я в ней плаваю, я посмотрю, потому что все-таки они длинные и хочется посмотреть, перевалить, а не просто пролистать по-быстрому. Вот. Вот в этот раз моя избирательность подкинула мне видос, который называется тоже серия Advanced Databases, но весна 23-го. Четвертая часть называется Analytical Database Indices или All Up Indices. Начинается с довольно простой, понятной вещи, то, что называется зон мэпы. Это как-то в паркете или много где вообще мы разбиваем весь наш набор данных, не важно колоночный или не колоночный, на какие-то группы строк или зоны, и в каждой зоне мы можем хранить какую-то информацию о том, что в ней вообще может быть, что в ней не может быть. То есть если такая-то колонка, которая сжата словарем, то у нас там будут, ну мы, собственно, храним словарь. По словарю мы можем сказать, у нас что-то будет, то есть если какое-то значение в словаре нет, значит в колонке его, скорее всего, тоже быть не может. Если это численная колонка, мы можем хранить максимум минимум. Еще можно всякие другие статистики хранить, но статистики, правда, полезнее хранить чисто для того, чтобы быстро отвечать на какие-нибудь странные вопросы, чем для того, чтобы ничего не было как индексы. Вот. Еще иногда Bloom фильтры хранят для колонок, для некоторой системы. Вот. Дальше речь начнется про всякую экзотику, про которую, много из которых я впервые слышал вообще в своей жизни. Собственно, потому мне показалась интересная эта штука. То есть если еще Bitmap индексы в общем случае, они есть в возгрессе. Что такое Bitmap индекс? Мы берем и просто строим битовую карту длиной с общей количеством записей в таблице и заполняем ее битами относительно какого-то значения. Обычно мы сам Bitmap не обязательно храним на диске, но индекс позволяет нам построить быстро такой Bitmap. И даже бывает, что прямо Bitmap хранят для конкретных значений. То есть Bitmap везде, где у нас не очень высокая размерность того, как это... Только скажем, у нас словарь, ну и нам с пятью значениями. Мы можем просто построить Bitmap индекс с пятью, как бы пять Bitmap индексов. В каждом мы ставим битик там, где у нас есть нужное значение. И плюс этого индекса по сравнению с многими другими, что в многих лап системах вам всегда нужно пройти по всей таблице и вам ходят не столько... То есть типичные запросы предполагают все равно там достать все значения и что-нибудь с ними посчитать или что-нибудь такое сделать. И у вас очень часто задача стоит не найти какую-то одну строчку в миллионе, а найти все строчки такие что и вам все равно придется сделать полный скан и вы хотите вместо того, чтобы попасть в нужное место таблицы и прочитать что-то небольшое, вы хотите пока вы читаете всю таблицу, избегать чтения тех кусков, которые можно не читать. То есть если у нас в какой-то странице вообще нет ни одного картежа, который попадал бы под условия, мы можем вообще не поднимать страницу с диска. И дальше идут всякие вариации над Bitmap индексами. Одна называется... Боже... Иерархические кодирования, оно очень замороченное и довольно бесполезно. Я, если честно, не очень понимаю, зачем такое рассказывать, когда у нас есть какой-то метод, который практически гарантированно не работает на практике, но зачем-то про него все равно нужно рассказывать. В общем, как знает. Еще один способ хранить битовые карты, это вместо того, чтобы хранить по битику на каждое значение, мы можем хранить по битику на диапазон значений. И это, в принципе, довольно мощная идея, я о ней чуть дальше еще поговорю. Ну и наконец, всякие нечто под названием Bit Slicing и Bit Weaving. Там чуть более... Хит тоже замороченные схемы, которые очень сложно в подкасте объяснить. Но в общем, это чем-то похоже на схему с битовыми картами, которые я уже по тексту объяснял. Просто некоторые из техник, особенно Bit Weaving, они очень хорошо, собственно, ложатся на симд. И если значит битовую карту аккуратненько в памяти разложить, то мы получаем не просто что-то, что нам позволяет быстро по... как это... отбросить и не читать лишние данные, сама вся битовая карта еще позволяет нам очень быстро, за счет манипуляции с многими, как-то с кусочками битовой... Битовая карта в памяти расположена так, что мы с ней можем произвести манипуляции таким образом, симдом, что она нам позволит ответить на... Блин, правильно сказать это, что... Не правильно объяснять, это не какая-то абстрактная битовая карта. Идея такая, что не очень большой размерности значения, для него строится такого рода бинарное представление, что очень быстро при помощи... Ну, бинарное представление, оно в принципе целиком представляет сами значения. То есть, оно... Это не какое-то сокращение сохранимых значений, это не какие-то рейнджи, это прям вот каждое значение в этом типе индекса кодируется просто битиками, но оно лосло скодируется. Вот. После этого с ними производится симдом хитрой операции, которые позволяют очень быстро и просто на лету сходить и битовой карты и чесать по этим данным очень быстро в памяти. Ну или сквозь данные быстро в памяти. Что в принципе... Интересный подход для, я думаю, memory-bass. К сожалению, все эти подходы, которые в этой лекции упоминаются, очень сложно понять, как их применить к реальной системе без того, чтобы прочитать пейпер. Это, наверное, моя главная проблема в этой лекции, что я сейчас не пересказываю сам алгоритм, потому что довольно сложно просто голосом без иллюстрации это объяснить, особенно когда речь заходит про какие-то симд вещи и распределение битов в памяти, потому что наглядно там буквально в одну картинку объясняется. Вот. Ну и в принципе, кому интересно, я думаю, могут пересмотреть лекцию и посмотреть на слайды. Да. Но самому алгоритму не достаточно, чтобы понять, куда именно его приложить к базе данных, где этот индекс сохранить и все такое. И наконец, последний подход, который, мне кажется, наиболее практическим, который в лекции упоминается и который, мне кажется, даже в каких-то других статьях видел в том или ином виде, но я почему-то с этим не сталкивался в реальных системах. Я удивлен, что я эти названия, вот именно как названия, вижу впервые как сами по себе штуки. Во-первых, колоночные как-то импринты, в общем отпечатки колонок, наверное, так можно перевести columnimprints. Когда вместо того чтобы, то есть у обоих подходов первым называется columnimprints, вторым называется columnsketches. Идея не в том, чтобы точно вам сказать, где что-то есть, где чего-то нет, а вот как раз чтобы хранить на какую-то группу строк, хранить метаинформацию о том, может ли там, может ли там быть вообще хоть что-то. То есть, например, на columnimprints, если прям очень на пальцах объяснять, это по духу похоже на Bloomfilter. Мы берем данные, все возможные в колонке, выстраиваем для них там битовые карты, мержим битики и получаем, скажем, задной длиной бит, битовую маску и способ в нее ходить. И значит, если там битик поставлен, то скорее всего значение есть в колонке, если в колонке и в группе, для которой мы построили эту карту. А если нет, значит нет. Только у Bloomfilter гарантии получше и понятнее. Поэтому, наверное, в принципе, про колонным принты я не слышал, наверное, от ответов в том, что все сейчас на практике используют Bloomfilter. Вторая штука называется column sketches, и она гораздо интереснее. Если у нас есть какая-то колонка, в которой значение, именно диапазон значения может быть довольно большой, то есть это не то, что и нам, в котором может быть только, не знаю, пять значений. Это прям, скажем, целочисленная колонка, но в ней это именно, потому что целочисленная колонка, это и в ней есть как бы конкретные повторяющиеся значения. То есть когда-то может быть, например, это индекс в какую-то другую таблицу. Или это, не знаю, я не думаю, что могут быть какие-то показания чего-то, потому что показания, наверное, не будут себя так вести удобно для этой струтуры данных. Это, наверное, еще могут быть такие-нибудь почтовые коды, что-то такое. То есть общий диапазон значений довольно бесконечный, но мы не храним каждое значение во всем диапазоне. Примерно понятно, известно о чем. То есть, для примера, у нас в колонке есть данное значение типа 60, 32, 170, 256, но не все между ними. Вот. Тогда мы можем... И мы их тогда как кодируем? То есть мы просто их перечисляем? Да, мы их просто перечисляем, да. И вот для перечисления мы делаем битовую карту. Сейчас, нет, не битовую карту. Я не совсем правильно сейчас сказал. У нас их не просто коней... Да, тут нужно еще, короче, оговориться. То, что я сейчас сказал про битовую карту, это типа простой случай. Ну да, и зато мы потом каждому значению в качестве индекса приписываем вот его короткую версию, типа его номер. Это просто получился у нас обычный словарь. И в принципе ничем не лучше словарного кодирования. А теперь немножко поменяем эту идею. Мы возьмем и скажем, что мы хотим заданное количество бит в нашем словаре, чтобы у нас словарь был, скажем, не больше, чем два бита. Тогда у нас может быть всего четыре значения, которые мы можем выбрать в качестве такого словаря. И чтобы это было полезно, мы хотим значения из области определения колонки, мы хотим их так выбрать, чтобы они были хорошо распределены. Мы берем и строим гистограмму, так чтобы столбики в гистограмме были одинаковыми по высоте. То есть у нее получается ширина столбика, ширина значений которые в неё лазят, получается. То есть там в первой колонке может быть больше значения, второй колонке может быть меньше значений, но они более частые. Примерно понятно, да? Типа гистограмма с, типа, меняющейся шириной, но типа чтобы все были одинаковой частоты. Вот. И мы берем границы столбиков гистограммы, и вот их мы берем в качестве наших словарных ключей, и для их мы нумируем. А дальше мы вот в нашей индексной колонке простраиваем значения, так что если значения в колонке меньше, чем наша граница, наши ключи для границы гистограммы, но больше чем на, типа, предыдущей, мы проставляем вот это словарное значение. Таким образом, получается индекс, который не знает точно что именно, то есть какое именно, какое именно значение в колонке, но ты знаешь диапазон. Это очень прикольная идея, то есть как бы можно, если у нас есть, просто потому как мы строили эту гистограмму, у нас более-менее равновоспределенные значения, поэтому у нас всегда очень хороший шанс при помощи такого индекса, если там у нас запросы не так, что они все каждый раз одну и ту же колонку запрашивают, колонку гистограммы, в смысле, не один и тот же кусок, да даже все один и тот же. Распределены по диапазону, наверное, одинаково. Да, ну, в общем, да. На самом деле даже на пофиг, запрос распределеный, я так подумал, в любом случае, как бы, просто любой запрос с хорошей вероятностью отбросит, ну, в нашем примере одну четверту данных. И если я правильно тебя понял немножко Брин напоминает? Да, да, напоминает Брин, и там в лекции в самом начале Брин напоминается. Я, кстати, не уверен, что Энди представляет правильно, как Брин работает, и не уверен, что я не представляю правильно, как Брин работает. Ну, Брин, он хранит на каждую страницу максимальное и минимальное значение. А тут это не постранично хранится, тут хранится так, что ты просто про каждое значение хранишь в каком оно диапазоне. Вот диапазоны кодируешь очень малым количеством бит. Это немножко разное. Это похоже на Брин в чем-то, но Брин на самом деле в 15-м пасгрессе сделали лучше, но проблема с Брином всегда была такая, что если у тебя значение, которое ты в Брин вставляешь, они... Если у тебя в одной странице в пасгрессе могут оказаться очень из разных концов диапазона, где Брин диапазону значения, у тебя Брин будет не очень полезным. Ну, типа, если ты Брином пытаешься время проиндексировать, ты можешь вставлять в какую-то старую-старую-старую-старую страницу какое-то значение, у которого временная метка довольно свежая. И у тебя брин индекс будет неэффективен из-за этого, потому что у тебя всегда максимум будет, типа, недавний. А если ты можешь обеспечить, что у тебя время, когда страница писалась, коррелируется этой временной меткой, то наоборот, Брин будет очень хорошо работать. Здесь нет такой проблемы, потому что это не... Ну, это можно, в принципе, постранично делать, но в любом случае мы храним не диапазон всех значений на странице, мы для каждого значения указываем, в каком оно у него позоне маленький количественный бит. Примерно понятная идея. Вот, и вот поскольку у нас малое количество бит и данные часто повторяются в этом диапазонном индексе, в этом скетч-колонке, скетч-колонки хорошо жмется дополнительно. Вот, у меня прям немножко зачесалось для прогресса попробовать реализовать скетч-колонку, если меня, если ничего никто этого не сделал, но я пока сейчас не до этого, но мне кажется, очень такая хорошо низковисящая идея для кастомного эксесс-метода. Я все. Ну, отлично. Тогда, если у него нет вопросов, мы переходим... Мне кажется, Саша это скоро будет завидовать, потому что Валер начал смотреть его же курс. Ну, как будто, во-первых, как будто я им владею, во-вторых, Валер смотрит другой курс. Ладно, ладно. И мы перейдем к следующей теме. Мне кажется, у нас скоро будет подкаст про исключительно базу данных, и можно бы переименоваться в это, в пасгрейс зен. У нас давно уже пасгрейс зен, но в последнее время что-то как-то усиление произошло. И про игры. Потому что я молод тем не сам. Про базу данных и про игры. Да. Вот, а что еще, и с тем, не про базу данных и не про игры, чтобы разбавить. Когда была вся эта история с тем, что из твиттера все бежали на Мастодон, и я тоже побежал, я утверждал, что мне не хватает Мастодона, который можно было бы взять и так по-простому засыпхостить, потому что Мастодон, он весь такой, значит, развесистый, тяжелый, бла-бла-бла-бла. Если вы помните это мое нытье, то, в общем, узрите. Компания CloudFlare, она вот прям сделала практически то, что я отжива года хотел. Они сделали нечто под названием Wild Beast. Это Мастодон совместимое программное, не знаю, как-то фаз решения, function as a service, типа сервелец, вот это все решение, которое делает вам Мастодон на CloudFlare. И надо сказать, что он даже довольно недорого, потому что единственное, как я понимаю, за что придется платить, это сервис resize картинок, потому что он у них платный, и самый дешевый это 5 баксов в месяц. Все остальное, если у вас не очень жирный инстанс, то будет, как по-моему, влезать просто во free tier. И архитектурное это, в принципе, примерно то, о чем я говорил, что вот у нас есть просто какой-то набор скриптов, которые можно как фаз деплоить и набор статических ресурсов, которые просто одной кнопкой деплоит на какую-то платформу, и вот у вас есть свой собственный инстанс, не нужно его отменить, потому что оно максимально сервер, и просто потом, когда новая версия выходит, раскатывать обновление. Что мне конкретно в этой реализации не нравится, почему я не подбегу это использовать, потому что оно настолько гвоздями привито к CloudFlare, что смешно. Ну, то есть, это понятно почему так, потому что им хотелось сделать шоу-кейс своей платформы, что они давно уже не просто... Как это, не просто Content Delivery Network, они имеют свой... Как бы они очень давно идут в сторону так называемого edge-компьюта, когда вы свои фасы и вообще весь свой софт крутите максимально близко к вашему. .. К потребителям вашего сайта. И они просто вот каждую технологию, которая у них есть, они взяли и вот эту штуку включили. Но это же и минус, потому что ни на чем, кроме CloudFlare, это раскатить невозможно. Что немножко как это... Ну, не полностью, но частично уменьшает ценность этого программного обеспечения, потому что Mastodon, его сложно салф-хостить, но при необходимости вы можете поймать эту автономию. Здесь же вы в принципе, если компания CloudFlare в какой-нибудь момент загнется, вы в принципе нигде больше не сможете захостить. И мне это кажется тоже своего рода минусом. Я надеюсь, что в будущем появится нечто, что будет такое же по духу и архитектуре, но можно будет детеплуить на любом FAS-провайдере. Вот это будет светлое будущее нашего, как это, сервера леса, чудесного мира, когда каждый энтузиаст сможет взять набор скриптов, нажать кнопочками, но будет работать за 5 баксов в месяц на платформе по выборам, или еще лучше за 1 доллар в месяц, потому что демократизация, запуска салф-хостинга, вот это все. Ура, товарищ! Я, кстати, если не ошибаюсь, слушатели принесли в тему, я не сам про это узнал, но я не знаю, есть ли это в тему слушателей. То есть это точно было в нашем DevZin Live, но я не помню, помечено ли это как тему выпуска. Вот и узнаем скоро. Я вот размышлял над тем, чтобы запустить на своем Synology какой-нибудь Mastodon, но потом подумал, что что-то как-то, наверное, не стоит. Ну вот настоящий Mastodon точно не надо, потому что у тебя Synology ляжет от этого. Можно какой-нибудь из облегченных версий, я думаю? Да-да-да, облегченная какая-нибудь. Ну просто я больше про то, что, наверное, вообще это не очень хорошая идея делать сервис дома, который у тебя другие сервисы будут опрашивать и будут коннективить, обеспечивать и так далее. Ну, мне кажется, как раз случай с Mastodon должен быть. Я не знаю, как ActivityPub работает, будет ли ActivityPub притрайдить, мне кажется, должен. Что меня смущает в этой ситуации, это то, что я бы не очень хотел, чтобы мой NAS торчал голой жопой в интернет. Именно поэтому я выше по тексту говорю, что хочу tailscale ставить. То есть у самих Synology, я уже упоминал, есть технология Connect, у них же есть свой собственный день DNS. Не день DNS, который сервис день DNS, в смысле аналогичный по духу Ушковина, который предоставляет сами Synology. Я не хочу ни тем, ни другим пользоваться, я хочу использовать tailscale и ходить так, как будто бы я в VPN, потому что, черт возьми, это чертов NAS, который я хочу еще иметь оффсайд бэкап, чтобы, не дай бог, что-то не вышло. И вот эту же штуку выставлять просто в интернет мне страшно. Именно так. Именно так я поэтому тоже не хотел. И тогда поехали к следующей теме. Если мы не будем выставлять, да что ж такое-то, я не могу перенести, мне не предлучается на пальцами переносить. Приходим к темам слушателей. У нас сегодня кем-нибудь очень много. Открываем, перелистываем, ищем. Так, первое. Не знаю в какую сторону здесь первое листать. В какую сторону здесь первое листать. НТ-Dev выпустила тайни 11 облегченную версию Windows 11 Pro, и вот это дайдчатва, которая требуется всего 2 ГБ Azzu и 8 ГБ места на диске Nt-Dev. Да, это тем принесли еще аж 7 февраля. Слушатель NC. Нет, слушатель NC принес что-то другое. Я запутался, наверное, все-таки слушатель NC. В любом случае, это в принципе не то чтобы какая-то новинка, как я понимаю, у Windows есть способы делать обрезанный инсталлятор. Я не умею пользоваться, но им пользуются всякие корпоративные админы. Я рад, что кто-то это сделал, надеюсь где-нибудь есть инструкция. Мне не очень понятно на каких правах, почему они это распространяют. Я так полагаю, что с точки зрения распространения это, например, пиратство. Я тоже понимаю. Да, я бы предпочел, чтобы они вместо того, чтобы распространять образ, писали подробные инструкции, как себе такое собрать. Может быть, они где-то есть, но я сходу не вижу. Потому что я бы, наверное, не отказался себе собрать обрезанный 11 Windows. Я, кажется, не говорил про это в подкасте. На моем игровом компьютере долгое время стояла десятка. Тут в связи с новостями о том, что они ее будут постепенно как это... Они какое-то время еще будут выкатывать апдейты, но они сказали, что новые версии, новые инсталляции десятки перестанут ставиться. То есть, я не уверен, что они имеют по этому виду. То ли они ключи перестанут продавать, то ли ваши ключи теперь нужно будет как 11 активировать, то ли что. В общем, я подумал, что не хочу выяснять в будущем. И просто от греха подальше обновлюсь на 11, чтобы, если что-то, не знаю, пришлось восстановить компьютер, то сразу на 11. Ну и там заодно понадеялся, что он не такой проклятый, как был на старте. Вот. Но он все еще, конечно, местами проклятый. То есть, самое, я не знаю, насколько вы в курсе того, как сейчас выглядит Windows, самое проклятое, что в нем нашел, это, конечно же, когда вы нажимаете кнопкой мыши по столу. Вы вначале видите современное контекстное меню. Там дальше есть пункт, который называется Show more или как-то так. Или Advanced Options, не помню. Когда вы на него нажимаете, вы видите контекстное меню из 10 Windows. Там, если пошурдить, можно провалиться в вещи, которые, там, не знаю, с ранних версий Windows доступны. В общем, такая, такой inception Windows. Вот. Так вот, да, обновился. Я, это мне уже не сюрприз, что когда вы ставите новую версию Windows, не новую версию, когда вы инсталлируете Windows заново на компьютер, у вас там некоторое количество программ, которые не производства Microsoft, и вы их не просили. То есть, например, какой-нибудь кроник Crash Saga в десятке ставился вместе с Windows 10. Вот, вот, брало ставился. Что меня удивило, что когда вы обновляетесь на Windows 11, весь этот соц снова появляет. Поэтому я бы не отказался, да, иметь дистрибутик, который бы Windows 11 ставил вот без вот всех этих навазных по нему Bloodware как аж. Но остальное, в принципе, Windows как Windows работает. Не знаю, мне Windows не нужен. Давно уже забыл, когда я последний раз... Я в игре играю и также игры на нем разрабатываю. Да, иногда это бывает необходимо. Поэтому печально. Простите. Следующая тема это Иван Аванов, уважаемое комьюнити. Нам очень жаль сообщать вам, что поддержка PromScale больше ему не будет производиться. Я правильно перевожу? Ну да, в общем, короче, я там уже прокомментировал, что я не могу комментировать. Ну, в смысле, кроме того, что написано. Я, в частности, был в команде PromScale. Это был софт, который предназначался, чтобы... Это было расширение и специальная программа на ГО, которые обеспечивали совместимость с Prometheus и OpenTelemetry Traces, а также Yager для инжеста этого в TimeScaleDB. Ну, в общем, мы решили немножко покусировать наше усилие, ждите анонсов. Ну, то есть не то чтобы это было какой-то плохой идеей, но конкретно PromScale в том текущем виде всё, увы. Это всегда грустно. Какая бы причина за этим не стояла, это всегда грустно. В то же время, я не сильно разбираюсь в PromScale, скажу прямо, но из того, что я вижу на GitHub, это Open Source, а патча 2.0, поэтому оно... Не весь. PromScale Extension это токсально. А он ему прямо необходим? Да. Окей. Там так с лицензиями по... Мы пытались, честно пытались долгое время быть под патчей 2.0 целиком, потому что мы, в частности, занимаем некоторые... Некоторые куски из того же самого прометея, но по мере того, как мы интегрирулись с TimeScale, глубже и глубже это всё становилось тяжелее, тяжелее, тяжелее поддерживать два куска, и во всяком случае Extension стала проще сделать целиком TSL. В итоге у нас была странная ситуация, когда есть кусок на Apache 2.0, который не работает без TSL-куска. Ну, вот так вот. С другой стороны, TSL он тоже, в принципе же, вы для себя его можете допиливать и использовать. Так что вы не можете, вы не можете продавать, как это, Hosted, ProbeScale. Делать облака. Да. Притом там нужно внимательно почитать, потому что, ну, какая-то формулировка. Нельзя делать облако, в принципе, или нельзя делать что-то, что конкурирует с TimeScale. Я не помню, если честно. Мне кажется... Там такая хитрая формулировка, что... Мне кажется, что нельзя конкурировать с TimeScale, по-моему, да. Там хитрая формулировка, что... Ну, короче, вот... Ладно, я просто не буду врать. Но... В любом случае, я не думаю, что кто-то будет серьезно этим заниматься. Намного проще на... Промить и успеветь. Ну, что мне самому нравилось? Одна из вещей, которые мне самому очень нравятся в этом продукте, одна из причин, почему я вписался в свое время именно вот в эту штуку. Мне очень кажется, мощный и недооцененной идея анализа метрики трейсов в одном продукте. К сожалению... Об этом очень много говорят, но очень мало делают. Я, опять же, как бы... Не могу комментировать со стороны компании, я могу комментировать как вот разработчик Валера. Как разработчик Валера, я вижу, что... Там, не знаю, в компаниях, где я работал, Ягер очень мало используют. И если смотреть презентации Google, как там они у себя трейсик используют, это... Ну, и как тут Ваня тоже, мне кажется, давно рассказывал, только они использовали трассировку в эхо, кажется, у вас была своя трассировка, да? Да, да, да. Вот. Если смотреть, как... Или там, как Twitter рассказывали про свой Зипкин. То есть, Ягер есть, но им очень мало пользуется. Если посмотреть, это же просто adoption Ягера, он гораздо ниже, чем у Promisius. И, ну, не знаю, такое ощущение, что просто то, что вы хотели делать... Вот, опять же, это не комментарий от компании, про Timescale, это комментарий просто от разработчика Валеры. Это не обязательно после каждой фразы повторять, потому что у нас на сайте есть дисклеймер. На всякий случай. Вот. Разработчик Валеры чувствует, что, возможно, мы опередили время. Не знаю, посмотрим, может, мы к этому вернемся. Я согласен. Если я прав. Я согласен с разработчиком Валеры, я даже дополню, на мой взгляд, недореализованные на текущий день идеи это хранить, во-первых, метрики. Вот по которым вы графики строите. Во-вторых, трейсы как в Ягере. И, в-третьих, логи в одной системе, где можно искать по всему и смотреть сразу все, и при этом использовать для запросов в SQL, что важно. То есть, ну, моя основная претензия к Промидиусу — это язык запросов, хотя там нужен... У него очень своеобразный сторож, но для метрик, возможно, это не очень критично. Но язык запросов там очень сильный на любителя. То есть, какие-то простые вещи, вроде как пофиг, но как только ты хочешь сделать что-то не совсем тривиальное, это прям большая боль. У Промкиэля есть свои плюсы. Промкиэль, например, он имеет такую штуку... Кажется, слайсы называются, или как это так... Я не помню, как это правильно называется в языке, но когда ты знаешь, что типа в колораторном скобочке пишешь 5 минут. Он умеет регулировать временную резервию. То есть, типа, ты, как правило, хочешь смотреть на 5 минут, как-то, не знаю, иметь точку с данными раз, не знаю, в минуту, раз в секунду, раз в 5 минут. В принципе, они поступают, на самом деле, с другой скоростью. И у тебя есть, при анализе там серии, у тебя есть одна из проблем, это регуляризация там серии. И Промкиэль тебе позволяет делать буквально в несколько символов. А в сиквеле нужно, во-первых, об этом подумать, а во-вторых, написать дополнительные, как правило, ну, то есть, внутренние, какие-то подзапросы, которые регулируют, а потом внешний запрос, который, собственно, анализирует. Я правильно понимаю принцип, что он берет временную ось, и он считывает на ней каждые 5 минут, и на каждые 5 минут берет последнее известное значение. Я не уверен, что он последнее известное берет, я так понимаю, что это может зависеть от эгрегата, который ты считаешь. Ну, или среднее, но он вот-вот что-то берет. Но смысл в том, что у тебя на каждые, на 0 минут, на 5 минут, на 10 минут, у тебя будет одно значение ровно, в этом идее. Да. И уж потом, поэтому строятся все остальные функции, это уже вызывает, весь остальный анализ производится. Ну да, на SQL это делается через законные функции, но это, я согласен, это не так удобно, как в одну строчку. Моя личная интерпретация, честно говоря, опять же, я бесконечно далек от проекта PromScale и всей этой движухи, потому что мой рабочий день вообще выглядит так, что открыл хакерс и сидишь, фигачаешь ядро пасгреса. Моя догадка, что, наверное, здесь не очень много денег в этой нише в целом. Я себе, если представить, с нуля компания, даже там безотносительно экономической ситуации текущей, вот у тебя стартап, его идея в том, чтобы сделать продукт, который агрегирует метрики, трейсы, логи и по всему этому классно ищут с языком запросов. Даже если не прямая SQL, а пусть даже модифицированная SQL, как Валера описал со своими удобняшками, в принципе, имеют право на жизнь. И даже, допустим, ты можешь за разумные сроки сделать этот продукт и продавать его по хорошей цене, мне кажется, никто за это не даст денег, потому что текущие решения не идеальны, но они типа окей. Ну, спорно, потому что у тебя есть и, не знаю, такие мастодоны вроде New Relic и как он, Data Dog, которые давно и успешно на рынке и кучу денег имеют. Я об этом и говорил. Есть и новые выходы на сцену вроде, то же самое, Grafana Labs, которые, как ни странно, довольно... То есть, продукт Grafana старый, Grafana Labs как компания, и как попытка это все монетизировать, это довольно вся же история. Они тоже в случае... Ну, я не знаю, как они зарабатывают, я финансовый отчет и не видел, но во всяком случае финансирование у них было навалом, и вроде у них, по-моему, даже не было увольнений. Еще есть OK Meter, который к нам приходил, и кто-то там еще. Я об этом и говорю, что рынок уже поделен. Есть Phonicom. Я не согласен, что он поделен. Опять же, это мнение разработчика Valera, а не компании TimeScale, но разработчик Valera считает, что там есть, куда втруяться дальше, и там те же самые Victoria Metrics к нам приходили еще. Victoria Metrics, да. Там есть, куда инновировать, но я не могу как бы давать комментарий от компании TimeScale. Ну вот, вот мое личное ощущение, что вот мы сейчас даже не сильно приходя в сознание назвали 10 конкурентов, которые тебя ждут на этом рынке, и тебе нужно придумать что-то настолько потрясающее, чтобы вот... Ну, я не говорю, чтобы зарубить их всех, но чтобы вот просто втиснуться где-то между ними. Мне кажется, это несостоятельная бизнес-идея. Но тот, кто не согласен и готов своими диско... А еще лучше чужими деньгами рискнуть и проверить противоположную гипотезу, добро пожаловать. Конечно, начинайте компанию. Все, которые начинают компанию, начинают с как-то идеи новой, почему они отличаются, иначе эта компания вообще никак не взлетит. Поэтому появление новых компаний, это хорошо. Скажем, вот я Honeycomb видел, и Honeycomb он реально другой. Он не такой, как предыдущий, и он дает свою новую фишку. Поэтому, как бы, я только за, пусть появляются. И я вижу, что они появляются. И каждый раз, я помню, когда первый раз я увидел Datadog, я был в восторге. Я говорю, Боже мой, как можно было сделать? Вот, сейчас Datadog я не использую уже, я не знаю, сколько, но как бы я отлично помню свои впечатления. Он появился на рынке, он сделал свое дело, он показал всем, как легкая интеграция, легкая видимость. В полкнубке ты видишь все. Это отлично, это правда классно. Пусть появляются новые. Не ругай их. Я могу подсказать бизнес-идею, точнее, не так, а проблему, которую, если вы знаете, как решить, то будет очень клево. Точнее, одну проблему мы уже назвали, что язык запросов хорошо бы иметь похожий на SQL, потому что его все знают, умеют и понимают. Очень спорно. Возможно, это моя рекомендация, ты можешь не соглашаться, имеешь право. То есть, я не против каких-то вот улучшений синхоксиса, как ты предложил, но вот мне лично, как пользователю, хотелось бы иметь что-то похожее на SQL хотя бы. Второе, это если вы пробовали Ягерь использовать в своем бэкэнде или что вы пишете, и делали это больше пару месяцев, то эта интеграция, инструментацию своего кода, ее долго, опять же, простите, у меня ночи, я уже туплю. Эту инструментацию для Ягеря ее сложно поддерживать в рабочем состоянии долгое время. И вот в проекте на ГО то, что происходило, то, что я наблюдал, вот эти трейсы, они просто ломались, потому что их надо тестировать по-хорошему. То, что ты код поменяла, а трейсы они что-то похожее на правду отправляют в метрики, но естественно, никто их не тестирует, потому что это ж самые трейсы, кому какое дело. И на практике они ломаются, и когда тебе они оказываются нужны, ты слишком поздно это понимаешь, то, что трейсы были сломаны, и у тебя какие-то трейсы все это время писались, но пользы от них не очень много, и ты возвращаешься к отладке по логам. Поэтому, если кому-то придет блестящая идея, как инструментировать свой код трейсами для Ягеря, чтобы оно было легко поддерживаемым, не замалось и в идеале не требовало от разработчика ручного или автоматического тестирования этого дела, было бы офигенно. Но я такого решения пока не знаю. Я хочу еще сказать, что, наверное, часть проблемы с тем, что, как я сказал выше, люди недостаточно готовы к тому, чтобы активно использовать трейсы, идет к тому, что все современные опонсорс-продукты, которые недавние про трассировку, они начали появляться тогда, когда микросервисы уже были в зените, сейчас мода на микросервисах немножко подутихла, слава богу, и людям немножко меньше, возможно, трейсинга нужно в целом. То есть, конечно, останется какое-то количество компаний, которые будут крутить огромные кубернетисы, но я думаю, что все больше нового софта теперь снова будет делаться более монолитно, и, возможно, это другая причина, почему какое-то время мы не будем видеть спроса на трейсинг. Я не очень понял. То есть, трейсинг нужно было всегда, и он нужен будет всегда, в зависимости от размера предложения. Ну, трейсинг он меньше немножко нужен, когда у тебя монолит. Нет. Ну, вот так, в монолите ты логом более-менее можешь разобраться, что происходило. У тебя, как правило, запрос не выходил за пределы одной машины. Мне кажется, нужно подчеркнуть, что под трейсингом Валера понимает именно трассировку для егеря, а не просто логирование, что у меня в такой-то момент, кто-то выполнял. Ну, как это, это ULTP, как он там называется. ULTP, что? Ну, это Open Telemetry Protocol. Ну, егер не обязательно ULTP трейсинг. Я имею в виду ULTP, это уже стандарт. Я к чему? Егер – это один из имплементаций стандарта. Пожалуйста, давайте не будем сокращать Open Telemetry, хорошо? Потому что называть Open Telemetry ULTP… Она не к тому же не ULTP, а ULTP. Да-да-да, это я под вечер уже торможу ULTP. Я хочу сказать, что monolith – это не значит, что у тебя все всегда работает на одной машине. Я и не работал с несколькими monolith'ами, когда у тебя monolith – это значит исходники в одном месте лежат. А как бы у нас monolith крутился там на 20… почему? Потому что когда исходники лежат в одном репозитории, это называется монорепозиторий. Это правда, что monolith'ное приложение может быть… Это правда, что monolith'ное приложение может быть запущено больше, чем в одном экземпляре, но оно может при этом также храниться в 20 репозиториях, но быть запущено… Но собираться в один билд, в один бинарный… Я понял, да. То есть это несвязанные вещи. Монорепозиторий, да, я больше имел в виду монорепозиторий. А ты имеешь в виду monolith, который работает на одной машине и выполняет… Ну да-да-да. …выполнил его от начала… Таких не бывает в приложении. Да, бывают на самом деле. Там трейсинг тоже полезен, особенно если у вас есть какая-нибудь база данных, например, у вас это есть, но продать трейсинг людям, которые… Даже так объяснить, почему трейсинг это полезно людям, которые в принципе по логам могут справиться, когда у них нет задач таких… То есть нужда, прям нужда в трейсинге у команды обычно возникает тогда, когда они прям не могут по логам разобраться, что происходило, им сложно становится. Вот тогда команда начинает интегрировать трейсинг. С трейсингом есть еще одна беда, которую я вспомнил. Впрочем, меня память может подводить, и вы ее на всякий случай делите на 2 на 3, то, что я говорю. Я с модом подозреваю, что в Ягере по дефолту используется UDP. Часть трейсов может быть просто потеряна. Там не в UDP делал, у тебя by design все трейсы собираются. Это слишком дорого все трейсы собирать. А, они там сэмплируются еще. Ты прав. Ты прав. И может получиться так, что если ты что-то такое отложил… То есть давайте так. Трейсы, они плохие для воспроизведения какого-то конкретного кейса. Я послал такой запрос, он у меня по системе разлетелся, где-то что-то с чем-то не состыковалось, я получил ошибку, надо разобраться, почему она произошла. Для этих задач Ягерь подходит плохо. Он хорошо подходит для некого рода агрегации, типа ты хочешь построить Flame Graph по распределенной системе. Примерно задачи, в которых он хорошо подходит. Кажется, мы ответили очень глубоко на этот вопрос, пошли дальше. Следующий вопрос, большой, длинный вопрос. Есть ронтай, метрика приложения, вроде количество запросов, их длительности, срывания, короче коллектор и так далее. Их легко собирать и направлять в примитивус. Однако есть бизнес-метрики, например число пояса, реактивных там и не очень, количество каких-то объектов в базе данных, картинок per user, например, и так далее. И в отличие от первой типовой метрики стоит full. Зависит от приложения, перезагрузки приложения, и поэтому в лоб примитивуса использовать нельзя. И как работать с бизнес-метриками непонятно. Можно их делать в материализацию, и потом сервис, который будет вытаскивать их в примитивус, но и там куча возникает вопросов. Как не гибкое решение миграции гонять нужно, использовать какие-то дополнительные сервисы, использовать incremental materialized view, которые до сих пор еще не вмержены в бете. И тогда прямой способ гонять их и хранить бизнес-метрики с историей их изменений, понижением разрешения с течением времени. Вот вопрос, который... Задача вопроса сразу показывает нам, что есть еще ниши для новых бизнесов на поле собирания метрик. Я на самом деле там ответил уже текстом. Я не скажу про downsampling старых данных, но вообще в целом подход пытаться засунуть бизнес-метрики в примитивус мне кажется странным и переусложенным. Особенно если их нужно начать посчитать на основе какого-то запроса в базу данных, мне кажется проще это делать сразу запросом в базу данных. То есть как я это делал... Я это лично не делал, как я это видел, что это делали соседние команды, я потом участвовал со стороны просто приложения. Или у вас есть реплика, на которой вы гоняете эти аналитические запросы. И если у вас маленькие веомданах, то скорее всего вообще все, что вам нужно. Если вам нужна... Ну, это может не давать вам прям полную историю изменений. Следующий шаг, мы эти запросы, которые мы тогда прогнали на RedReplica, мы их периодически делаем и гоняем... И результат кладем в какую-нибудь Data Warehouse. Или как вариант мы через логическую репликацию, в какой-нибудь другой ченж Data Capture продукт, кладем исходные данные в Data Warehouse. Потом еще и можем по ним посчитать какую-то материализацию и в Data Warehouse оставить. Если у вас прям совсем много данных и сложные приложения, микросервисы, вот это все, тогда уже, наверное, лучше просто всякие бизнес-эвенты в специальную кавку про бизнес-эвенты выгружать, потом из этой кавки опять-таки вываливать в Data Warehouse какую-нибудь и там читать метрики. В любом случае, мне кажется Data Warehouse для этого подходит более лучше, чем попытка использовать системы для метрик, именно таких вот Performance Metric, для бизнес-метрик. Потому что с бизнес-метриками, во-первых, часто приходится какие-нибудь неожиданные агрегации потом возникают. Во-вторых, если у вас источник этих метрик SQL-база, или какие-то события, которые у вас с приложений происходят, в промитивус с этим будет... То есть, чтобы промитивус с этим работал, вам вначале нужно написать какой-то endpoint, который будет в промитивус отдавать, а потом придумать как это из промитивуса долгосрочно хранить. Ну, фиг знает. От та же самая графана, я не обязательно промитивус, на той стороне графан прекрасно SQL-ом работает. Так что вы не обязаны платить денег за Snowflake, вы можете ClickHouse взять. На маленьких объемах у вас ClickHouse прекрасно справится. Ну или да, я уже повторюсь, что если у вас совсем маленькое приложение, возможно вам просто рид-реплики хватит для вашей ситуации. Ну, рид-реплика, да, она не даст вам историю метрик, но может для начала быть неплохо. Поехали к следующему вопросу. Ильиса, что хочешь тут отреагировать к предыдущему? Я отходил ненадолго, поэтому пропустил и лучше не буду. Все понял. Я сам не знаю, что сказать по этому вопросу. У меня мало было работы с бизнес-аналитикой и с хранением, с обработкой. Я больше на стороне сервисов и хранение необходимой информации для сервисов. Поэтому скорее не сталкивался. Следующий вопрос. Случилась большая утечка данных у интернет-провайдера Convex. Который раскрывает подробности слежки за пользователем. В том числе, неизвестная ранее программа «Зеленый Атом». Я про это вообще ничего не читал. Я тоже не знаю, кто все эти люди. Мы не читаем подобные штуки. Надо техническую документацию читать. Здесь нет технической документации. Впрочем, со времен Сноудона ничего нового. Ваше правительство следит за вами. И не только ваше. Все за вами следят. Никому не верить, кроме подкаста «Дезен». Поехали дальше. Обязательно сделайте шторку на камеру. Я бы посоветовал шапочку из фольги. Не помешает. Хуже точно не будет. Вы зря смеетесь. Не, я не смею. Телеграм сделал нечто похожее на Twitter. Ограничил IPI. В 18 февраля для использования IPI нужно иметь установленный официальный клиент. Так как кодататификации будут проходить именно туда, а не через SMS. Как один из вариантов сейчас. Разделать аккаунт можно лишь в официальном мобильном клиенте. Печально. Иван Иванов это задает вопрос. Возмущается, что экономия расходов на рассылку SMS. Ограничение сторонних клиентов. И ссылка на ограничение IPI, которое разосло на пользователем. Не знаю. Посмотрим. Мы гадать сейчас не можем. Вон Twitter начинает закручивать гайки. Может быть придется делать телегрон. Не знаю как назвать. Jager. MatrixNet тогда уже. Следующая тема. Про Oculus. Читали что-нибудь про Oculus? В России заработала система автоматического поиска запрещенного контекста. Я думаю комментарии такой же. За вами следят. Это одна из причин, почему я в свое время уехал из России. Я понимал, что... Германия тоже сейчас есть. Недавно в Твиттере проскакивала кия подписанную оператскую партию. И еще ретвитил Шелев. Есть дурацкая инициатива про так называемую аббревиатуру. По-моему, про это уже говорил в подкасте. Даже еще не законопроекта. Есть рабочая группа по этому делу. Помните мы обсуждали Apple CSM. Предлагалось гонять персептиф хэши. Если персептиф хэш стреляет на детскую пронографию. Это будет отправлено на модерацию. Вдруг у вас детская пронография. Мы уже обсуждали, что какие-то пользователи получили по шапке фотографии собственного ребенка. Или Google. Это дерьмо. Чет-контрол похож на CSM. Проблема с сканированием. Вместе с тем, что в Евросоюзе есть гдпр. И прочая паранойя. В другой стороне, есть работа с гдпр. И в этой стране есть гдпр. И в этой стране есть работа с гдпр. И в этой стране есть работа с гдпр. В какой-то другой 영화 работе с гдпр. В какой-то другой фильме. Оно же у вас на устройстве. Это же неданные хранятся в облаке у проклятых капиталистов. В Америке это свои родные проклятые капиталисты. Это же не нарушает вашу приватность. Это же у вас на устройстве работает. Это будет хорошо. Отвратительно. Не знаю, когда-нибудь мы может быть доживём до состояния, но в основном нет. Я думал, что скорее не доживём, чем доживём до состояния, когда... Правительства перестанут пытаться залезть... в каждое биологическое отверстие встать по зонду. Вообще, киберпанк нам подсказывает обратное. Но у меня нету каких-то действийных решений против этого. Потому что, как Саша сказал, за вами следят и будут следить, скорее всего, в ближайшее время. Быстрый вопрос. Если 16-летний тинейджер отправляет одноклассницы линии Дик Пик, это считается распространением ЧАУФ порно? Не знаю, Саша. Это одна из многих претензий к подобного рода законопроектам, о суде и кто. Кто будет разбираться? То есть проблема с любой автоматизированной системой, даже если она предположительно не должна нарушать приватность в 99% случаев, в том одном проценте случаев, когда нарушает приватность, значит к вам выезжает наряд. Непонятно, почему он к вам выезжает. Потому что вы подросток Вася, который там, не знаю, Виталий, который показывает фото своих генталей, или если вы сфотографировали своего ребенка, чтобы отправить в врачу, или вы шуткуете и решили поговорить, как будто бы педофил своей совершенно 40-летней женой. Не важно, могут быть в жизни странные ситуации, люди вообще странные существа и делают дичьи в хорошем и плохом смысле слова. И вот любая автоматизированная система, она, даже если будет какой-то искусственный интеллект, который будет мощь различать в какой-то ситуации, хорошо это или плохо, ни у кого, кроме людей, которые находятся в переписке, нет полного контекста. Ну то есть, если это какой-то, не знаю, чат между людьми, которые бы совершеннолетние, но этого нигде нету в контексте, то, блин, ну как, просто даже у самого совершенного искусственного интеллекта нету информации. Так что да. Я предлагаю дать искусственному интеллекту эту информацию в вход в интернет по паспортам. Да-да-да, вот начинается. Короче, я надеюсь, что в Евросоюзе это дерьмо зарубит, посмотрим, удастся ли отвоевать или нет. Это понятно. И печально, что в РФ это происходит... В смысле, продолжают усиливаться... ну, как бы это давно там происходит, продолжают усиливаться. Я вот когда переехал, надеялся, что я хотя бы здесь с этим дерьмом не столкнусь. Ну вот как бы, есть шанс Евросоюза с ним столкнуться. Ваня вот, хорошо Ваня в ЮК, у них там свои собственные зонды теперь уже. Ну, как бы это же общий тренд. Везде появляется способ следить за интернетом. Это раньше он был свободной при вольной, пока там была маленькая часть населения и свободная анархия была. А сейчас это там... Все перетекли туда, там сейчас будет точно такая же организация. Ладно, пошли дальше. Следующий вопрос. Давайте про алгоритмы сжатия поговорим. Предлагает нам Александр... не знаю, как правильным цель произвести... Шепетка? Шепетка? Зетстандарт от Фейсбука. Я немножко выполнил это темы. Я раньше его прям на работе использовал в продакшене. Сейчас я ничего не использую на работе в продакшене такого. Там скеловая собственная компрессия. Но из того, что я вижу по... как это... по чей-то логам, его очень сильно ускорили. То есть, типа там для некоторых конфигураций двухзначные... как это... двухзначные процентные прирост в производительности, типа 10-15 процентов для некоторых ситуаций, ну не для всех. То есть, типа если у вас было декомпрессия, скажем, была... ну декомпрессия, по-моему, до 8 процентов на маленьких машинах. Да, то есть, типа на M1 Pro у вас, если, скажем, раньше было... 1370 мегабайт в секунду декомпрессии, то теперь, значит, почти полтора гигабита декомпрессии, скорость декомпрессии.",
    "result": {
      "query": "advanced database indices types"
    }
  }
]