[
  {
    "segment_id": "afe15329-125c-4fe1-a8cc-1b2515aa53fb",
    "episode_id": "fac075ce-7c46-4eb0-ae67-f1fb36badc4c",
    "episode_number": 63,
    "segment_number": 2,
    "text": "Это заняло у меня где-то неделю, а потом я в этой базе расположил симптомы к болезням, можно было просто ввести симптомы и получить какой-то список болезней для этого пациента. С этой программой я пошёл на какую-то конференцию, не помню, чего-то там, и так получилось, что я занял второе место из-за того, что на первом месте были ребята, которые сделали какой-то веб-сайт для школы своей. И именно тогда я понял, что, скорее всего, за веб-сайтами будущее, а за какими-то такими программами уже прошлое. Дальше я пошёл в институт местный, но институт особо много знаний не давал, поэтому со второго курса уже начал работать в какой-то местной веб-студии, какие-то делать сайты на PHP. В тот же момент так получилось, что я на фрилансе нашёл заказ на социальную сеть для кулинаров. Эта сеть называется поварёнок.ру, она до сих пор работает. Это был мой первый опыт на разработке на PHP такого большого сервиса. К сожалению, опыт был действительно реально первым, поэтому этот сайт сейчас до сих пор в таком неизменном виде находится, видимо, очень сложно что-то там поменять изнутри. Это был первый опыт работы с моим кэшем, первый опыт каких-то распределённых запросов и вычислений. Всё было достаточно интересно. Единственный момент, почему я ушёл из этого проекта, потому что, к сожалению, не было какой-то техподдержки отдельной, мне приходилось общаться с пользователями. А пользователи на этом сайте – это в основном женщины в возрасте, начиная от 30-40 лет. Я не знаю почему, но возможно у них очень много было времени, и там на сайте начинались какие-то войны. У нас там были какие-то звёздочки, и из-за этих звёздочек люди чуть ли не приходили в личную друг к другу, начинали драться. Это мне немножко напрягло, и я ушёл из этого проекта из-за этого. Больше я с социальными сетями для женщин не связываюсь после этого. А за что звёздочки давали? Звёздочки давали за рецепты. Человек выкладывает рецепт, его оценивают, и у человека появляется не звёздочка, а там был поварёнок. Количество плюсов, и там появляются поварёнки, зайчики. Если одна мадам возьмёт чужой рецепт, и ей куча звёздочек, то другая мадам может выяснить, где она живёт, прийти и настучать ей по голове. Это было реально очень грубо и жёстко. Что дальше? На этом проекте я понял, что PHP меня не устраивает, просто потому что я на нём не могу реализовать некоторые вещи, которые хочу. Я вот как сейчас помню, мне нужно было позднее статическое связывание для того, чтобы что-то сделать в VRM. К сожалению, не помню, что. И в PHP в той версии не было его. Оно появилось через год или два, точно не помню. Поэтому я начал смотреть на другие языки, на Ruby и на Python. Не помню, почему мне Ruby не понравилась, возможно, из-за Begin&End. Но в итоге я сделал свой выбор на Python. И, собственно, устроилась местная контора. И мы делали... У нас был сайт, назывался mp3real. Это был сайт о пиратской музыке, достаточно популярный. Там порядка 200 тысяч уникальных пользователей в день было. У нас было огромное количество пиратской музыки. У нас была достаточно интересная система. У нас был свой плеер, можно было создавать плейлисты. Тогда ещё не было вконтакте, музыкальной части вконтакте. Также у нас, ещё до того, как Apple сделал у себя в iTunes, у нас было приложение, которое просматривало твой компьютер или какие-то папки конкретные, искало музыку, загружало для них обложки информации из каких-нибудь баз, я, если честно, не помню, как называлась база, но что-то вроде mdb, но для музыки. И потом загружало эту музыку к нам на сервер, и все остальные могли уже всё скачать. В том числе могли скачать по торрентам. В общем, достаточно разухабистая архитектура у нас была. Также у нас был второй проект. Там было несколько проектов, но два больших. Один музыкальный, который приносил достаточно много денег с рекламы. Второй проект был пиратские сервера к линейке на Java. Мы писали пиратские сервера, у нас были свои сервера, где люди играли, и в том числе мы продавали свои движки другим серверам. Это было достаточно интересное время. Но как всё закончилось? Всё закончилось плохо. Потому что в какой-то момент к нам пришли люди из отдела К или ФСБ, я точно не помню, и просто забрали все сервера. У нас они хостились, насколько я помню, на мастер-хосте в России, в Москве. Конечно же, у нас были бэкапы, мы могли всё это развернуть в другом месте, но в тот момент я понял, что нужно уходить уже из этой серой или даже чёрной области в что-то более светлое и белое. После этого я понял, что делать что-то в маленьком городе – это неправильно, и поехал в Москву. Поехал в Москву с желанием работать в Яндексе. Я приехал в Москву, я собеседовался в команду к Ежили, это инфраструктура Яндекса. Но, к сожалению, в тот момент меня перехватила другая компания, это компания Nova, и у них был проект, называется Aya.ru. В то время это был медиасервис с музыкой и видео, а сейчас это только видеосервис. Почему они меня перехватили? Потому что просто предложили больше денег, а я приехал только в Москву, и мне деньги реально были очень нужны, чтобы как-то прожить вообще в этой Москве. Собственно, в Nova и Aya особо технически ничего интересного не было, за исключением того, что я стал участником событий, я не знаю, вы видели, нет, на хабре писал Максим Шапошников, как инженеры боролись с руководством Nova. Я не буду давать... Я краем уха слышал, но вообще не представляю, как руководство могло в такую херню скатиться. Ну, там сама компания очень прикольная, люди там работают очень интересные, с ними интересно работать, интересные проекты. Но мир онлайн-игр достаточно жесткий. Какие примеры я могу представить? Когда я пригласил своего друга на собеседование, администратора, он помимо интервью проходил досмотр на детекторе лжи. Соответственно, можете понимать, какие люди там работали. А какие вы игры делали? Азартные, что ли? Нет, не азартные. Мы не делали игры, мы... Точнее, я вообще к Nova мало относился, потому что я работал в проекте Aya. Nova локализировала корейские игры. Это, например, Lineage и множество других игр. Я, если честно, не помню название, потому что не играл. И там достаточно много денег, и достаточно всё серьёзно. В общем, этот конфликт описан на Хабре, если кому-то интересно, может почитать. Это был мой первый опыт того, что IT-область, это не просто какие-то пони и единороги, но и достаточно жестокая такая область. Для меня это единственное и неповторимое свидетельство такого обращения с персоналом. Вообще не только в IT, а вообще like ever. Ну, а смотри, последнее, например, событие с Твиттером, оно достаточно тоже жесткое. Люди работали над своими проектами, и вот сегодня он приезжает, а у него уже нет доступа к офису, он не может забрать свои вещи. Это же тоже достаточно жестко. Понятное дело, что им там не ломали руки, но неприятно. Нет, извините, совершенно разные вещи. Увольнение – это одно, а когда доходит до детекторов лжи, ломание рук – это совсем другое. А там же наверняка не… У тебя же был выбор – пойти на собеседование, согласиться с детектором, либо вообще отказаться от такой работы. Никто же никого не заставлял наверняка. Да, я думаю, выбор был, и с детектором работали только те люди, которые имели прямой доступ к серверам. У нас, у программистов, такого опыта не было. Я слышал уже из старых рук. Что дальше? Я оттуда ушел и пришел в такой небольшой стартап, возможно, вы его знаете, называется Metabar. Метабар – это такой стартап, который делал в браузерах тулбары, либо виджеты в хроме. То есть, это достаточно такой злой… Ну, не злой продукт, но достаточно такой продукт, который сильно раздражает пользователей. Но пошел я туда не потому, что я люблю эти тулбары, а потому что там была достаточно интересная задача. Какая там была задача? Собственно, например, есть какой-то новостной сайт. У него есть пользователи, которые установили виджет либо тулбар этого сайта. И этот новостной сайт хочет узнавать, вот пользователь ушел с его сайта, а что он дальше делает. И мы предоставляли такую возможность. То есть, там был такой интерфейс, где можно было посмотреть ваши пользователи, чем они интересуются, например. То есть, в разрезе по ВКонтакте, по каким-то, например, их интересам, либо по тому, куда они ходят, на какие ресурсы после этого. Само собой, это все было достаточно анонимно. Почему это было интересно для меня? Потому что, во-первых, там были достаточно нормальные, такие ощутимые нагрузки. Я точно цифры не помню, но порядка 200… Больше 200 тысяч пользователей в день. И они постоянно отправляли статистику. То есть, это, например, переходы какие-то по сайтам, что-то еще, куда-то клики, например. То есть, это достаточно большой объем статистики. И сама задача достаточно интересная. Как мы это реализовали тогда? Мы подумали, что ходуп нам не нужен, потому что данных у нас не так уж много. Мы взяли MongoDB. Это была MongoDB версии 2 с чем-то, то есть, не новая третья версия. Конечно, мы огребли много проблем с этой версией, когда мы начали делать MapReduce. Также мы огребли много проблем, когда у нас база лочилась на уровне самой базы. То есть, не на уровне коллекции даже, а просто по базам. И нам приходилось костылить, например, когда мы писали сначала, например, полчаса в одну базу, потом писали полчаса в другую, а первую базу через MapReduce обрабатывать. Тогда же я в первый раз сделал нечто подобное Lambda-архитектуре, когда у нас часть данных, точнее, все данные шли туда, где они обрабатывались, например, каждый час. А часть данных шла туда, где они показывались в реалтайм режиме. То есть, все это было тоже реализовано на MongoDB. Достаточно интересно. Потом меня захлестнула истерия стартаперства. И мы с коллегой из этого проекта, этот коллега сейчас строит поселок программистов под Кировом. У него уже штук 8 или 5 или 6 семей, которые купили дома, семьи программистов. У них вот такой анклав программистский получается. Так вот, мы с этим коллегой начали заниматься стартапами. Стартап у нас был, назывался LinguaMania. Это было такое приложение для ВКонтакте, где вы, изучая английский, проходите какие-то игровые задания вроде... В общем, обычные задания, за них вы получаете буквы, а потом вы из этих букв можете собрать какую-то одежку. Потом эту одежку вы можете на своего персонажа наклеить, и, соответственно, персонажи такие уже задеты получаются. Достаточно популярная была игра, там даже Павел Дуров играл. Мы видели по одежнику, что Павел Дуров заходил туда и провел какое-то время. Потом произошла наша встреча с русскими инвесторами. И это реально было ужасное время, вот эти полгода, когда мы общались с русскими инвесторами. То есть, например, в один день ты приходишь, он говорит, как все здорово, давай завтра встретимся еще с кем-то и поговорим. На следующий день ты туда приезжаешь, а звонит человек, а он просто трубку не берет. Вот такие русские инвесторы у нас, к сожалению. В общем, в итоге нам надоело это все. Мой коллега занялся этим поселком программиста, а я пошел отдохнуть от всех этих стартаперских вещей в Яндекс. Теперь про Яндекс. В Яндексе я пришел в группу Кокаина. Это такой клаудпаз-платформа, наверное, в которую можно запихивать приложения, и они как-то между собой общаются. Собственно, нас было тогда двое, и у нас были такие приложения. То есть, у нас было два типа приложений. Один тип приложений обрабатывал достаточно большую и серьезную нагрузку, порядка 50 тысяч RPS в секунду. Это, например, когда у нас от браузера приходил запрос на подсказку поисковую, там, саджест, так называемый. И вот там достаточно серьезная нагрузка была. И эти ручки мы писали на плюсах, потому что нам нужно было все обработать очень быстро. И также у нас были приложения-ручки, которые, например, выполняли какую-то продуктовую задачу. Что такое продуктовая задача? Например, какая-то галочка из браузера, которую пользователь чекает, и мы отправляем запрос. Там порядка 200-300 RPS, не больше тысяч обычно. Вот эти приложения мы писали на питоне, потому что их очень много, их нужно писать быстро, и большая нагрузка не нужна. Но в какой-то момент так получилось, что у нас некоторые приложения на питоне подвергались более высокой нагрузке, чем планировалось изначально. Соответственно, чем это было плохо? Тем, что питон под большой нагрузкой начинает сжать очень много ресурсов. А нам нужно было, чтобы в облаке ресурсов количество ограничено, и нам нельзя было, чтобы много ресурсов поедалось только одним приложением. Поэтому мы начали думать над какой-то альтернативой, потому что на плюсах все писать подряд нам не хотелось, потому что достаточно долго. И мы начали смотреть в сторону других языков. Мы смотрели на Rust, естественно, мы тогда Rust не взяли, потому что это было больше двух лет назад, и Rust был тогда не готов. Он и сейчас не готов. Мы посмотрели на... Подожди, а почему он сейчас не готов? Простите, я чувствую запах горелых жоп. Я ждала этого комментария от Валеры. Сейчас он не готов, потому что сейчас еще нет каких-то best practice, которые есть, например, с тем же Go или питоном. Люди уже знают, как справляться с какими-то конкретными проблемами. С Rust еще такого опыта не накопилось, к сожалению. Это раз. Второе – это количество людей, которые знают Rust, оно стремится к нулю, скорее всего. Это тоже очень важно. И третье – почему он сейчас не готов, потому что... Это связано со вторым моментом, потому что он достаточно сложный, намного сложнее, чем тот же Go, например, или питон. И поэтому очень проблематично найти людей с таким складом ума, которые бы поняли Rust и начали бы на нем писать в течение пары-трех недель. Вот такой поинт у нас был. Ну и единственное, что я соглашусь со всем, кроме последнего поинта, потому что мне кажется, что C++ сложнее. Да, C++ сложнее, но людей, которые знают C++, гораздо больше. То есть они учатся в институтах, их там учат C++, и они уже его знают, он уже в голове у них есть, они пять лет его учили. В общем, мы еще смотрели на Java, на какие-то другие языки, типа Clojure, например. Но почему-то наш выбор остановился на Go. У нас товарищ из кокаина Антон, он взял, собственно, Go, написал фреймворк для кокаина буквально за выходные. Мы взяли этот фреймворк и взяли существующее у нас приложение. То есть у нас было приложение, которое было написано на C++, вот этот саджест. Мы его переписали на Go и просто сравнили, каким образом относится нагрузка, например. Есть статья на Хабре, где мы все это дело описываем с графиками. Я, конечно же, оставлю ссылку на нее. Обязательно. В общем, вышло у нас так, что на наших задачах у нас гошная версия была в два раза всего лишь медленнее C++. По ресурсам она ела... Например, у нас была ручка, которая ела 300 мегабайт памяти. Гошная версия ела 320 мегабайт памяти. Питоновская версия ела 8 раз больше памяти. То есть огромное количество памяти питон ест, потребляет просто. Поэтому мы провели эксперимент. Взяли плюсовую ручку, взяли гошную ручку и еще мы написали еще одно приложение, не сильно сложное, на питоне и попытались запустить его под Пайпаем. И в итоге у нас получилось, что под Пайпаем медленнее где-то в 4 раза ручка работает, чем гошная версия. Но потребляет огромное количество ресурсов, просто очень много. Ест как не в себя. Гошная версия в 2 раза медленнее. И, соответственно, разработка на ГО была по скорости близка к питону. Конечно, медленнее в самом начале, но потом при поддержке скорости выравнивались. Потому что ГО статически компилируемый, статически типизированный язык. И какие-то тесты, которые вы пишете в питоне, вам все-таки не нужно писать в ГО. Из-за этих моментов скорость разработки примерно сравнивается с питоном. Это то, почему мы выбрали ГО. После этого мы начали писать все приложения на ГО, которые у нас были, потому что это было просто удобно для нас. И наша группа разрослась с 2 человек до 8. У нас были достаточно разные люди. Например, был Бацек. Я не знаю, знаете вы или нет, такой достаточно популярный человек в Яндексе. Также, когда мы начали все это делать на ГО, я начал ездить везде и рассказывать про ГО на различных яндексовских конференциях. Например, в Москве была конференция, я рассказывал про ГО на ЯКе в Новосибирске, на конференции для C++ разработчиков я рассказывал про ГО. С этой конференции, кстати, мы взяли одного человека, который ему понравилось, и он к нам пришел, и мы его взяли из Новосибирска. Также я ездил в Беларусь, и там на конференции Яндекс.Субботник, по-моему, я тоже рассказывал про наш опыт, про отличия ГО и какие-то такие вещи. Я не знаю, интересно вам нет, как у нас вообще происходила работа в Яндексе, процесс разработки. Мне на самом деле, лично мне интересно, как вы, детали того, как вы протащили ГО, то есть, вы просто взяли и сделали, или вы пришли к начальству, там объяснили, где вы будете программистов искать и так далее? Да, это больше всего интересует, как вы объяснили начальству, что этот язык стоит того, чтобы его выбрали, и кто потом это будет все поддерживать после вас, и где найти ГОшников? Да, это сложный вопрос. Наверное, у нас начальство было понимающим. Вот у нас команда была тогда из двух человек, и мы между собой согласились, что мы будем использовать ГО. Мы, собственно, написали приложение, и мы экономически обосновали, что вот такое-то приложение, оно будет есть столько-то ресурсов, то есть, экономически на ГО писать выгоднее, чем на Питоне, например. Также мы показали скорость разработки с ГО, сравнили с Питоном и с плюсами, и по всем параметрам получалось, что у нас реально экономические показатели улучшались. С этим мы пришли, собственно, к начальству. Это был один человек, собственно говоря, и он сказал, ну пишите и пишите. Вот, собственно, так все и началось. А каким образом мы искали людей на ГО? Обычно это происходило так. Мы брали человека, который писал на Питоне, он приходил, и мы говорили, вот, пиши на ГО. За неделю он переучивался с Питона на ГО, или за две недели, да, через месяц он уже полностью понимал, как писать на ГО, какие-то сценарии, как вообще этим языком пользоваться, инструментами. То есть, это какой-то проблемой не создавало. Единственное, что люди, которые приходили к нам с плюсов, они поначалу плевались, то есть, им какие-то вещи не нравились, а то у них дженериков не хватает, то еще чего-то. Но в конце концов, например, те же люди, когда писали какие-то прототипы, они брали вместо плюсов ГО и писали уже прототипы на ГО. То есть, в каком-то месте им все-таки ГО более удобен, чем плюсы. Вот, ну, собственно, как-то так. И я тогда не буду рассказывать о том, как мы работали с Кокаином и, собственно, выкладывали все это дело в продакшн. Я перейду уже, наверное, к следующему этапу моей жизни. Ты знаешь, я бы с интересом послушала про то, какой Кокаин в продакшн выкладывали. Я думаю, это вполне такая стоящая история. Да, но вот у нас было облако кокаиновое, в котором хостились различные проекты. В том числе и проекты, которым мы занимались в нашей группе, это Backend Яндекс Браузера. Вот каким образом все происходило? У нас были различные стенды. То есть, у нас был продакшн стенд, например, сотни машин, я точно цифры не скажу. Был девелоперский стенд при продакшн, который был полностью копией продакшна. Единственное, что на него какой-то маленький процент трафика лился. Еще у нас был лодинг, я не помню, если честно, как он назывался. Это было там пять машин, по которым мы стреляли из Яндекс.Танка и проверяли регрессии по производительности. Каким образом происходила разработка? Собственно, пишешь приложение, потом, как обычно, код-ревью, тесты и выкладываешь на стенд разработчиков. Потом вам нужно этот девелоперский стенд синхронизировать с браузером. Есть альфа-версии браузера, которым нужна какая-то конкретная ручка, и вот вы синхронизируете и смотрите, что все работает нормально. Когда вы понимаете, что все хорошо у вас работает, вы уже выливаете в при-продакшн и смотрите, как это себя ведет под нагрузкой. Соответственно, если все хорошо, то после этого вы говорите админу, я хочу перелить с при-продакшна на продакшн. В Яндексе мы не могли сами вручную вылить в продакшн что-то, потому что все-таки ответственность, если возникнут какие-то проблемы, ответственность висит на администраторах. Поэтому они обязаны знать, что куда выливалось, а потом откатить или просто обратиться к кому-то. Дальше они брали это приложение, оно у нас крутилось в докере, соответственно, там была просто команда, где они это приложение начинали копировать на продакшн сервера. Например, на 5% копируют, смотрят, не появилась ли какая-то всплеска с шебек на 10%, и вот так постепенно она разливается на весь кластер.",
    "result": {
      "query": "опыт внедрения Go в Яндексе"
    }
  }
]