[
  {
    "segment_id": "935f9e17-d8e0-40d2-be71-e943348fe9d6",
    "episode_id": "0a942df1-8a4a-4a1e-a2da-8a353c4ae737",
    "episode_number": 202,
    "segment_number": 6,
    "text": "Очень советую отдельно устанавливать ETCD кластер на отдельные машины и настраивать правильный firewall к ним, потому что ETCD содержит полную информацию про состояние кубернетиса. Соответственно, если вы имеете права на запись в ETCD, вы фактически имеете права на изменения и любую манипуляцию с кубернетисом. Это очень плохо и очень часто бывает так, что люди просто установили и забыли. Хотя на самом деле получается, что да, имеют права по умолчанию там все. Следующее – это ротировать ключи как можно чаще. Следующее – везде включать все Linux Security Features, всякие там C-Linux, AppArmor и прочее. Дальше – анализировать, статически анализировать YAML. Вот про это я совсем не знал. Оказывается, есть довольно большое количество уже написанных утилит, которые для кубернетиса проверяют правильность работы YAML по вашей конфигурации, то есть что разрешается, что не разрешается, и вы можете очень серьезно ограничить пользователей, чтобы они ерунду какую-нибудь не написали. Следующий совет, который я видел много где, но сам не использую – это использовать в качестве контейнера, в контейнере нерутого пользователя. Давайте я поясню, почему это происходит и почему это не надо делать. Происходит из-за того, что по умолчанию в докере вы работаете всегда рутон, то есть чтобы добавить там пользователя, вы должны выполнить какие-то действия, понятное дело никто это не делает. То есть в частности я, например, когда работаю внутри своих контейнеров, я весь девелопмент делаю в контейнерах, даже на локальной машине у меня там Erlang, нет, у меня Erlang установлен какой-то, но я все время в докере работаю, и я никогда не устанавливал пользователя, потому что я большего смысла в этом не вижу, но на продакшене они говорят «Локально делайте что хотите, можете не делать дополнительных пользователей». Когда вы работаете на продакшене, лучше добавлять нового пользователя. Почему это нужно делать? Потому что когда вы работаете в контейнере, у вас рутовый пользователь, пользователь номер один, чаще всего в внешней системе рутовый пользователь тоже пользователи номер один. номер один, и юзер-айди фактически, когда вы что-то делаете в контейнере, вы все файлы пишете с этим рутовым пользователем и все правозаписи в рутовом пользователе. Само по себе это вообще не страшно, потому что вы фактически при хорошо настроенном контейнере не работаете с внешними файловыми системами и не делаете ничего такого, что может сломать вашу хостовую операционную систему. Но это чревато дополнительными рисками, потому что прямо сейчас как бы мы не знаем, как взломать эти все группы в ядре для того, чтобы выломиться из дойки контейнера. Но если такой способ внезапно будет найден, у вас уже будет рутовый пользователь фактически на хосте, потому что вы имеете одну и ту же таблицу UID. Следующее – это использовать Network Policy для того, чтобы ограничивать все под-то под сообщения, трафики. Это по умолчанию нужно включать для того, чтобы никому ничего не разрешать и только избранным контейнерам разрешать доступ к избранным контейнерам. И следующая тема вот очень интересная, я про нее не знал, и мне кажется, это прям один из таких важных моментов, почему вообще стоит использовать Kubernetes. Всем хейтерам Kubernetes посвящается. Есть большое количество систем уже написанных, которые проверяют ваши контейнеры перед запуском, вы можете это в качестве хокков настроить, можете в ваш CI строить. Какие-то уже существующие известные уязвимости как в самом ядре, так и в пакетах установленных. В шоу-ноутах будут ссылки на пакеты, которые известны. Они проверяют на библиотечные уязвимости, на какие-то пакетные уязвимости, я не знаю, баш, PHP и прочее. То есть фактически вы, правильно настроив один раз Kubernetes, вы можете удостовериться, что никто из ваших текущих пользователей этого Kubernetes не будет использовать пакеты и контейнеры с уязвимостями. Это легко и удобно настраивается и легко и удобно эксплуатируется. Это огромный плюс. Ну и в качестве последнего в секции future у них написано использовать сервис mesh, который позволяет вам все это удобно настраивать, конфигурировать и управлять сетями. Мы про это уже много общались. Вот в принципе все. Так что вот, Саша, еще один способ, еще одна причина использовать Kubernetes. Ты слышал? Понимаешь, я когда слышу Kubernetes, у меня сразу мозг автоматически на 5 секунд выключается. Учитывая сколько раз ты произнес Kubernetes, ну ты понял. А когда ты произносишь Kubernetes, у тебя тоже мозг включается после этого? Нет, это не так работает. Понял. Так, а следующая тема у нас светит. Про Valve, компанию Valve, я так понимаю. Расскажи, пожалуйста, про менеджера света. Да, тут такая статья вышла по мотивам одного твиттера, трейдика из твиттера. Собственно, бывший сотрудник Valve рассказал про историю, что такое, что на самом деле представляет компания. И мне хочется здесь добавить, вспомнить вот ту книжку, которую Valve выпустила про такой хэндбук для новых сотрудников. Мы как-то даже, мне кажется, эту книжечку маленько упоминали как прекрасный пример, как работает идеальная компания. Так вот, собственно, в своем трейдике в твиттере этот человек рассказывает, что на самом деле эта книжка была не просто, как-то не случайно выпущена в открытый интернет, как это заявилось, а на самом деле это была конкретно спланированная пиар-акция компании с конкретными авторами. И сотрудники, когда увидели эту книжку, выпущенную в открытый интернет, слегка посмеивались, что на самом деле это не очень правда и не очень верно. Но идея Valve и менеджмент внутри компании, что компания совершенно плоская, у нас нет никаких менеджеров, у нас люди автоматически сформируют команды, потому что мы нанимаем адекватных классных людей и они в состоянии сами. Можно сразу вопрос? Да. А сколько людей у них там? Вот я даже не знаю, сколько там точно людей.",
    "result": {
      "query": "Kubernetes security best practices"
    }
  }
]