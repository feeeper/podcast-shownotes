[
  {
    "segment_id": "e207d641-2d9f-4984-8b85-80e9fbb89a03",
    "episode_id": "b79751cb-4f38-4b0b-8396-79cdb16b17a6",
    "episode_number": 40,
    "segment_number": 5,
    "text": "Точнее, нетсплиты и прочая фигня устраняются быстрее. Но все эти баги, что там были, они там так и остались. Грубо говоря, система начала все это быстрее детектить, но поведение в целом осталось таким же. С Aerospike интереснее. Сразу поясню, что Aerospike, он вообще изначально был, насколько я помню, их изначальный маркетинговый посыл. Он был АП-базой. Идея была в том, что она просто дико быстрая. Просто даже однонодовая инсталляция пипец как быстрая. И в этой миллионной транзакции она умеет прожевывать на одной машине. И для некоторых индустрий, как раз всякой рекламы и так далее, в контексте этого, кажется, фламинала, в принципе, хорошо работает и, наверное, и сейчас будет продолжать хорошо работать. Потому что не нужна точность вплоть до единиц чего-то. Важно общее значение какого-нибудь счетчика. И главное, успеть ответить вовремя. И с этим Aerospike как справлялась, так и продолжает справляться. Но с недавних пор они включили маркетинговый пуш по халящему Монговскому. И среди этого маркетингового пуша стало столько разной информации и столько всего, что просто читаешь их документацию, читаешь их сайт, и оно само себе противоречит. То есть оно то AP-системой себя называет, то CP-системой себя называет. Одновременно, одна и та же документация порой. То же самое касается гарантий того, что они в одном месте говорят, что это ACID, в другом месте говорят, что на самом деле конфликты могут быть, мы их будем разрешать ручками. Потом они говорят, что есть возможность разрешать конфликты ручками. Потом ты пытаешься пойти посмотреть, а как все-таки ручками разрешать. Ну, наверное, как в React или CouchDB распишут ручками, значит, давайте на уровне приложения разрешать конфликты. Потом выясняется, что на самом деле такая фича раньше была, теперь ее выпилили, теперь данные можно только терять. Ну, то есть, в смысле, опять-таки, повторюсь, что в некоторых ситуациях, если у нас очень high volume data, high velocity, high volume, но каждый отдельный кусочек данных нам не очень важен, нам важнее общая статистика, то терять данные иногда это нормально. Собственно, я в комментариях к прошлому или позапрошлому выпуску кому-то отвечал про Монгу, я говорил, что есть системы, которые гораздо лучше справляются, когда можно терять данные. Вот это, например, AeroSpyc, потому что AeroSpyc гораздо быстрее Монги. Но, собственно, о чем статья Афира, о том, что он берет просто каждое маркетинговое или даже из документации утверждение про эту базу и сравнивает его с тем, что мы имеем на самом деле. И никакой CP консистентности там вообще не пахнет, несмотря на то, что они пытаются говорить, что у нас где-то immediate consistency, или что у нас есть какие-то локи, или что еще, это все просто не работает. В смысле, оно работает, пока с сетью все хорошо. Если сеть мигнула хоть на долю секунды, все, привет, у вас все эти консистенции, локи, гарантия уникальности ключей разваливается просто моментально. Уточну, здесь они говорят, что у нас все будет работать, если у вас меньше миллисекунды связь между latency и серверами. А потом тут же в документации гайд как накатить на Amazon, то есть взаимоисключающий параграф и detect. Да-да-да. То есть никогда у вас не бывает идеальной сети даже в вашем собственном дата-центре. А уж в Amazon надеяться на это вообще глупо. Я от себя могу сказать, что сейчас я активно изучаю CouchBase, прям по работе. И насколько я не специалист по аэроспайку, но по-моему это похоже во многом. Не во всем, но во многом системой. Да, они похожи. Да, у CouchBase документация очень хорошая, и сам он по себе очень простой, поэтому посмотрите лучше на него. Ну, кстати, я могу добавить, мы когда-то в свое время... Я не сказал, что они одинаковые. Я специально сделал ряд оговорок. Проводили некоторые там свои бенчмарки для своих узкоспециализированных задач, и CouchBase показал себя лучше. По-моему, не намного, но лучше, чем аэроспайк по скорости. Ну, просто мне казалось, что вы аэроспайк используете. Ну, там есть свои нюансы. Вот так скажем. Это тонкости интерпрайза. Тут очень важно, кто с кем пиво пьет. В гольф. В гольф играет. Все ясно. Ну, тут мне кажется, что есть такой момент, что все-таки CouchBase вырос из документаориентированного хранилища и кэша. То есть был CouchDB, отличное документаориентированное хранилище, и был отличнейший распределенный кэш, membase. И они решили объединить усилия, и в итоге получилось быстрое документаориентированное хранилище. А аэроспайк мне всегда казалось рос как раз из-за того, что есть какие-то, сожаленно, небольшие значения по ключам, которые очень быстро меняются, которые можно немножко терять. До недавнего времени они даже не пытались быть ЦП-системой. То есть у них какая-то свежая фишечка появилась. Когда она у них появилась, у меня в начале челюсти выпало, я им не поверил. А теперь я понял, что я правильно им не поверил. Понимаешь, они когда писали про ЦП, у них было сразу такое введение, что когда говорим про хейпи, терему, у нас всегда ниндзя говорит, что каждое значение из трех параметров, оно бинарное, оно с какой-то степенью, градацией. У них так это все было расписано, и в итоге они сказали, ну у нас есть в некотором роде консистентность, но со своими оговорками. И да, такие вещи иногда случаются, при надсплитах можно напороться, но опять же для некоторых сфер можно разруливать, и это ничего страшного не дает. Так вот и дело, что проблема аэроспайка в том, что нельзя разруливать. В последних версиях они сломали возможность разруливать руками. Ну факт в том, что я помню, мы напарывались на интересный момент, когда вы по одному ключу много раз обновляете, и часто, и быстро, и он потом выскакивает вам с ошибками, то что вы слишком часто обновляете данные по этому ключу. Ну что это? Странные вещи. Ну не шумоглый. Идем дальше? Да, в общем он как ЦП-база вообще не работает, как АП-база он работает, если вы можете жить без мерджа на уровне приложений и готовы смириться с тем, что вы будете немножко терять. И все это, я так понимаю, рекомендуют задержать в своей стойке, в железной, с очень быстрой связью. Да, да, вообще. То есть не странно то, что у них сразу идет реклама, что вот ставьте на Амазон это все, это чисто стоечное железное решение, вообще на Амазон это ставить нельзя. Ну то есть, мне кажется... Основная же идея распайка, что он оптимизирован под SSD, и тебе нужно ставить на своем железе, да, и чтобы там было SSD, тогда ты будешь получать максимум от этого решения. Погодите, а на Амазоне нельзя разве сделать так, что я покупаю максимальные сервера, они будут стоять в отдельном... ну скажем, никто больше не будет их пользовать? Так они же SSD не дают, насколько я знаю, на Амазон. Дают, дают. Дают, дают, уже дают. Они уже дают, но там... Наверное, уже около года. Там другая проблема, там сеть, она не всегда стабильна, так скажем. Вот она не всегда стабильна, особенно если у тебя соседи есть. А если у тебя соседей нет, то там просто она будет иногда нестабильна. Самое интересное, мы по-моему обсуждали пару выпусков назад, что соседи у тебя есть всегда. Они у тебя все реже, чем больше ты платишь, но они у тебя все равно могут появиться, и когда ты с этой проблемой сталкиваешься, Амазон говорит тебе, ну, занесите побольше, у вас там вероятность найти соседей будет меньше. Но все равно в кишках это всегда виртуализация. Период полураспада соседа. Кстати, насчет AeroSpy, не обязательно, вот конкретно свою стойку можно арендовать у кого-нибудь. Ну то есть тоже будет работать. И тут могла быть ваша реклама. Если бы, ну вот, вы не успели. Но в следующий выпуск можно успеть. devzone.ru, там все контакты. Идем дальше? Да. А следующая тема у нас скала. Выход скалы 2.12. А можно вопрос? 2.12, M1. M1 это что значит? M1 означает milestone 1. Это означает, что они его начали разрабатывать и выпускают кусочками. То есть у тебя потом последует milestone 2, milestone 3, milestone 5. Это в процессе разработки она. Это все agile. Это как закрытый спринт в скраме. Ок. Хорошие новости, это будет поддержка 8 джавы. Дальше... Надо сделать оговорку. Они полностью переходят на GRE-8. Младшие поддерживаться не будут. Но самое удивительное, текущий milestone, который вышел, он поддерживает java 1.6. Потому что они взяли скалу 2.11 и продолжают ее допиливать. Они в пределе полностью перейдут на GRE-8. Да, при этом не будет обратной совместимости. Также они собираются сломать, что Света сказала, бинарную совместимость. Потому что лямбда будут не на объектах джавных, а на лямбдах GRE-8. Что, возможно, хорошо скажется на перформансе. И будет проще использовать из-за джавы код на скале. Вот это все. Также они выпилили актеры. Напоминаю, что в скале с версии 2.8, если не ошибаюсь, были в стандартной библиотеке некоторые актеры. Не те, которые Ака. Другие. И они давно считаются деприкейтед. Вот они их в 2.12 наконец-то выкидывают. По большому счету пока это все, что известно про 2.12. Насколько я понимаю, использование GRE-8 дает значительные плюсы, я так понимаю, по производительности в том числе. Ну, ты понимаешь, с каждой версией виртуальной машины закрываются баги, что-то оптимизируется, улучшается сборка мусора и так далее. Подобные флаги новые появляются. Ну и семерку уже перестали поддерживать. Кстати, мы давно перешли на GRE-8, вообще без проблем. А как вы со скалой на GRE-8 работаете? Ну в смысле? Ну вот у нас проект на скале, да? Ну. Я сижу под убунтой. Я под убунт ставлю 8-ую джаву, собираю проект, прогоняю тесты, тепло, все работает. Никаких проблем вообще. Интересно. Ну, по крайней мере, у нас проект не собрался на 8-ую джаву. Может быть это из-за спрея. Я думаю, у вас какие-то зависимости джавные, которые там... Ну, по-моему, ничего такого не было. Может быть, клин забыли. Интересно, джава ведь не ломает обратную совместимость по задумке по своей. Джава не ломает, а вот скала, да. Нет-нет-нет, в джаве там такая... Она воспроизводит джавовый байдкод. Там хитрость в том, что джава, в ней есть библиотеки типа ASM, которые работают с байдкодом напрямую, и он может не поддерживать некоторые байдкоды 8-ой джавы и от этого ломаться. Ну, условно говоря. То есть там такого рода проблемы возникают. Так они, конечно, не ломают обратную совместимость. Ну, просто тоже давно уже на 8-ой джаве. Ну, просто все то, что работает с кодогенерацией, оно может ломаться. А что у нас дальше? А что у нас дальше? А дальше у нас твоя тема, Саша. Про... Google Cloud Bigtable. Google отжога, да. Ваня, ты читал эту тему? Я читала эту тему. А Ваня не читал? Нет. Как ты мог не читать?",
    "result": {
      "query": "Aerospike CP consistency documentation confusion"
    }
  }
]