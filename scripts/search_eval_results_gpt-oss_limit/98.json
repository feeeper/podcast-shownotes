[
  {
    "segment_id": "4f889b59-77a7-440f-9306-61dd1781d676",
    "episode_id": "ccff6c01-cbd2-44bb-ae6d-761dba955bd4",
    "episode_number": 98,
    "segment_number": 13,
    "text": "Прицепляются ли они к хипу-процессу или будут там отдельно в специальном месте, в специальном лимбо жить или что еще с ними делать? Подожди, подожди, я вот в прошлое пропустил, может, меня не было, я не помню. А точно был? Слушай, я вообще сам уже не вспомнил. По-моему, в таком случае оно как раз сделано для того, чтобы это вообще не обходилось. Если тебя в каком-то процессе очень прям активно что-то записывают, то разумно, чтобы нода совсем не умирала очень быстро от любого процесса за большую очередь. Разумно просто на его очередь не смотреть, потому что все равно эти сообщения, они точно еще нужны, их нужно отработать, и смысл по ним ходить непонятен. По ним ходить надо попозже. Ну, а потом они будут прицеплены к куче. То есть, как бы, речь про сообщения, которые в очереди, которые процесс еще не прочитал. А, то есть, они будут прицеплены к его очереди, к его куче, чуть попозже, когда он их прочитает, так что ли? Да-да-да, по-моему, да. Я уже, слушай, уже не помню, это почти, мы это чуть-ли не несколько месяцев назад обсуждали. Ты точно был в выпуске с Вами, потому что мы с тобой вместе это обсуждали. Вообще не помню. Я сейчас специально, чтобы не потерялась ссылка, я сейчас специально кину ее, чтобы прицепить ее к шоу-нотам, но мы совершенно точно это обсуждали. У меня такой вопрос. После трет-пулов, да, там вторая большая главная боль в Орландо, это локальные кучи, да, и копирование данных между ними. Как правильно думать про эту проблему? Типа нефиг класть большие сообщения в очереди или что? Ну смотри, как бы сейчас сделали немножко лучше второй момент, второе большое нововведение, это шеринг подтермов во время передачи сообщений. То есть, грубо говоря, раньше, если у тебя была, как это, раньше, если у тебя был большой терм, в котором много похожих сабтермов, которые реально, ну, у тебя при построении, на самом деле были одним и тем же сабтермом. При копировании они как бы все разделялись бы на разные сабтермы и просто как бы пересылалось больше сообщений, чем нужно. Сейчас при копировании можно включить, что сохранялся шеринг, это немножко увеличивает время копирования, но уменьшает потребление памяти. Второй момент, обычно, ну, как бы если хочешь присылать большие данные, ну, пересылай себе байнери. Это не очень поможет, потому что я... Подожди, подожди, дай закончу. С этим тоже была, извини, такая неприятная проблема, что если у нас был маленький кусочек байнери, который ссылается на больший байнери, и на больший байнери давно никому не нужен, а этот маленький когда-то какой-то процесс тронул, и этот процесс до сих пор не был затронут Garbage Collection, чтобы узнать, что этот маленький кусочек байнери больше никому не нужен, и этот большой байнери тоже никому не нужен, и, ну, как бы некоторые на это летали. Вот, сейчас-то тоже, чтобы напомнить, мы это уже обсуждали, что эта проблема сейчас тоже будет немножко решена, ну, в смысле, она будет решена лучше, потому что ввели такое понятие как virtual binary heap, которое есть у каждого процесса, и который, насколько я понимаю, считается такой, типа, отдельной кучей, которые нужно отдельно пройти, что если она, как бы тоже в ней много чего-то раскопилось, чтобы, ну, тоже, то есть даже если у нас обычные термы в процессе не накапливаются часто, но если у нас, как бы, отношение бинарных данных в целом куча большое, мы возьмем просто бинарные данные, как бы, выкинем. И там еще куча-куча-куча обновлений, я не буду по всем по ним идти, в смысле по обновлениям работы с памятью, потому что мы это отдельно уже обсуждали, и ссылка в шоу-ноутах. Вот, по поводу того, что ты спросил, не всегда хороший вариант, когда это не хороший вариант. Чего? Ну, ты спросил, что, типа, байнари не всегда хороший вариант. А, ну, вот смотри, допустим, я хочу положить там какую-то хитрую большую сообщенку, да, в очередь, ты говоришь, вледи вместо этого байнари, ну, то есть мне нужно ее, типа, сериализовать, положить байнари, потом в другом процессе я все равно ее десериализую, все равно посоздам копию, то есть ерунда какая-то. Ну, смотри, на самом деле, если посмотреть на реально такие быстрые системы на Erlang, которые работают быстро, они просто так… Если в какой-то момент понял, что тебе здесь нужно быстро пересылать много больших сообщений, ты просто строишь такую структуру данных, с которой ты можешь работать прямо из байнари. То есть ты не десериализуешь, ты просто… То есть в Erlang работа за байнари, во-первых, удобная, а во-вторых, быстрая. Ты просто на этот байнари можешь просто в него смотреть. Ну, это означает, что мне нужно не просто сложить эти данные в байнаре, мне нужно просто изначально иметь этот байнар, понимаешь? Да, да. И всегда с ним работать. Да, так не так сложно. Да, но я бы не сказал, что это удобно, в общем, дело. Ну, слушай, я такой код писал, я не сказал бы, что это прямо катастрофически неудобно. Ну, я к тому, что на скале такой проблемы не возникает, там возникают другие, но поскольку хип общий, то вот копирование дешевое. Ну, то есть вообще бесплатное. Ну, смотри, самый лучший подход, то, что мы обсуждали, что в Go предложили, то, что есть в Husky, это самый удобный подход с гибельными хипами, но Erlang и фашизм. Фашизм, в принципе, ну как бы, мне в принципе в этом фашизме тоже, кажется, жаловаться давно не хватает ситуации, чтобы сказать, что вот у этих трёх процессов куча общая, совсем общая. А это как раз то, что даёт тебе скалы, как ни странно. Ты можешь просто разные процессы запустить, и у каждого своя куча. Ну, как бы, при этом нужно руками процессы маневрировать, а вот хочется вот такие легковесные акторы, которые, если они логически образуют pipeline, ну, там нет смысла между ними реально копировать данные, потому что, ну, их на самом деле, то есть, ещё одна оптимизация, которую я, кстати, видел, если данные между процессами нужно пересылать, их можно просто не пересылать. Просто немножко по-другому подумать о задаче и сделать, на самом деле, не знаю, какой-то behavior, который позволяет несколько flow-контролов как-то сравнительно удобно объединить в один. Тебе, кстати, не обязательно менеджировать руками процессы, ты можешь там сам себя запустить с разными параметрами, ну, то есть это не так сложно. Ну, может быть, и да, но я подсунулись за что. На самом деле, ещё в Erlang часто вот оптимизация, которая прямо работает, это, если у нас есть длинный pipeline по обработке чего-то, это, конечно, удобно в целом для написания, но вообще, если у вас много времени проводится в копировании сообщений, это, в принципе, может быть, даже видно в профилировщике, то как бы можно просто количество процессов, между которыми пересылается сообщение, уменьшить. И эта оптимизация довольно известная, тот же самый Cowboy, он в частности известен тем, что он постепенно от версии к версии уменьшал количество промежутков, как бы создававшихся процессов, в плоде того, что сейчас один Connect, один процесс, в котором Connect целиком живёт, никаких там дополнительных процессов там не создаётся по возможности. То есть, прям как бы мы заакцепцили, я сейчас не хочу врать, но, в общем, по-моему, чуть ли даже не в том же процессе, в котором заакцепили сообщение, сразу продолжаем фигачить по тому, что надо делать с Connect. Ну, это разумно. И, в общем, там просто сам Cowboy создает минимальные накладные расходы на количество процессов, и, да, самовыше можно просто их не плодить, чтобы не переслать данные. То есть, плохо в Erlang реально иметь один жирный процесс, в который уходят все. Если у вас куча мелких процессов, и вы делаете их ещё больше, то, ну, возможно, их можно как-то между собой пожать, чтобы их было меньше. И, да, этот код будет, возможно, чуть менее интуитивный, чем если просто на каждый поток кода свой процесс, но зачастую мой опыт говорит о том, что можно сделать какой-то такой behavior. GenfSM? Нет, даже не обязательно. Просто скажу так. У нас есть behavior, который позволяет, ну, сделать что-то типа наследования. То есть у нас есть базовый обработчик, потом... Это то, что можно сравнить, наверное, с middleware в обработках HTTP. Вот кто сталкивался с MSRAC или там в Python есть VSGI, вот предельно похоже на это получается. То есть мы как бы вставляем такие шаги обработки, говорим, вот, запусти процесс рабочий с вот такими шагами обработки. И вот оно и получается, в общем-то. Да, не так офигенно удобно и красиво, как прям по отдельному процессу, зато работает намного быстрее, и, в принципе, код получается в итоге таким же. Запускается немного иначе, и нужна какая-то отдельная обмотка, которая вот этот вот степь будет внутри себя крутить, степь преобразований, вместо того, чтобы просто каждый процесс дальше пересылать. Но вот даже отдельные модули внутри получаются такими же поведениями, как если бы они были написаны просто как отдельные процессы. А фичам 19.0 еще при чем-то надобны? Да, конечно, потому что мы только-только про управление память поговорили. Там много разного, ну, то есть, очень сильно улучшили трассировку, очень сильно улучшили всякие runtime tools, там есть нечто по названию microstate accounting. Я не знаю, как это по-быстрому сформулировать, но, в общем, ввели немаленький набор дополнительных метрик, которые увеличивают то, насколько можно глубоко посмотреть виртуальную машину. Так, суммаризовать, чтобы не лезть в дебри. В нижу добавили возможность смены бэкэндов, наконец-то, к 19.0 релизу, ура, ура. Еще из важного добавили новое поведение, вот ты упомянул genfsm, на самом деле, ну, все знают, что genfsm, ну, как бы, далеко не самая удобная на свете штука. И, как бы, она к тому же, что как-то, ну, с ней не всегда понятно, как правильно ее запользовать. И я видел довольно разные подходы к тому, как ее пользоваться, в частности, можно переходить из стейта в стейт просто, ну, если мы знаем, что нужно просто сразу из этого стейта перейти в другой, можно просто взять и позвать callback просто внутри себя, не отдавая управление обратно бэкэйверу. А некоторые делают это с нулевым таймаутом, что, на самом деле, ну, совершенно неправильный подход, потому что, а если нам вдруг придется сообщение, то все, ну, сломает. И так далее, в общем сделали вроде как более удобный интерфейс под названием генстейт, ну, генстейт машин, призван в первую очередь стать более простым в программировании, API, пожалуй, так. Вот. Куча улучшений опять по SSL, там, опять какие-то депрекейшены в этом во всем. Да, уже упомянуты управления тем, что делать со сообщениями в очереди, как с ними обходиться. Добавили еще, а вот, да, важный еще момент, который многие давно хотели, в частности, я не понимал, я с тех пор, как взял в руки Erlang, не понимал, почему в нем этого нет. В Erlang не было Unix сокетов, можете себе представить, вот не было их. Да, потому что они не нужны, не портируемы. Да все это используют, реально, то есть они не то чтобы, блин, в итоге сделали, что, GENUDP, оп, и передаешь специальную штуку, которая на самом деле, вместо TCP адреса, local, ну, типа local и путь к сокету. То есть реально работают через GENUDP просто, ничего нового не добавили. Просто вот добавили, если внутри драйвера добавили некоторую расточку, в плане API ничего не поменялось почти. Просто вот новые параметры добавился. И они нужны на самом деле, то есть если у нас приложение, вот типичный пример, мы не хотим писать свой RADIS, потому что, ну, как бы, с одной стороны, у нас, конечно, есть ETS, если ETS немножко не подходит по use case, а расстанчивать свое не хочется, когда есть нормальный рабочий RADIS, можно на одной машине поднять RADIS и Erlang. Разница между Unix сокетом и Loopbackом, с RADIS, она, в принципе, заметна на бенчмарках, может быть, в некоторых случаях. Она, как бы, нужно так это, прилично присесть с нагрузкой на RADIS, но, в принципе, ее можно увидеть, то есть люди мерили, она там есть. Учитывая, для чего Erlang используется, всякие там доставка, реалтайм сообщения и всякого такого, как бы, довольно странно не иметь этой возможности. Больше того, если у нас есть какой-нибудь докер, с которым предпочтитель интерфейса это общение через Unix сокет, ну, по крайней мере, я не знаю, да, помню, там же до сих пор с докер-дьямоном общаемся через Unix сокет, если не вешать его на T-Sport. Понятное дело, что в библиотеках это было давно, но это такая вещь, которую хочется иметь в библиотеках, как раз внутри языка, потому что это довольно естественно кажется. Еще вот жду, когда, наконец, сюда втащат, ну, Serial Port, потому что, ну, тоже, какого черта, какого черта мне для работы с Serial Port до сих пор нужно тянуть странные левые библиотеки. Извини, а вообще на ноутбуке есть Serial Port? Нет, ну ты же знаешь, что у тебя есть... То, что делали мы, я, кажется, уже говорил, что у нас был такой небольшой роботик, который проект довольно давно загнулся, роботик, который состоял из Raspberry, Arduino и сенсоров, и мобильной платформы. Вот, Arduino занималась, собственно, рулением моторами и сенсорами, на ней крутилась прошивка, которая через USB общалась с Erlang, запущенным на Raspberry. А на Raspberry, там уже на Erlang была такая, типа, Substantial Architecture-like штука, которая вот этим всем уже рулила, умела там сядь, ходить, и куда еще надо ходить. Вот, и Arduino и прочие такие штуки, когда их подключают по USB, они определяются, как будто по шине USB подключили что-то, что является Serial Port. Так работает еще много что, включая SMS-модемы, привет, телекомы, включая, ну, реально дофига всего, и почему до сих пор нет возможности работать с Serial Port, мне тоже не ясно. А у тебя твоя операционная система не позволяет никак с файликом работать? Слушай, обычно позволяет, но там же есть всякие интересные моменты, типа, бодов и прочей фигни, ну, там же, в общем, все электро. У тебя есть NIF, а в чем проблема? Ну, нет, в смысле, я говорю, что в библиотеках все было давно и до сих пор есть, просто это те вещи, которые в языке для телекома хочется иметь встроенные в стандартную библиотеку, потому что они нужны, ну, часто. Ну, не можешь ты встроить в стандартную библиотеку то, что там плохо портируется на Windows, те же Unix-сокеты? Ну, опять-таки, встроили просто дополнительные опции, ну, что мешает просто при компиляции просто выключить поддержку этого? Это ведь не требует какого-то нового API, это просто реально передача дополнительных параметров в уже существующие библиотеки, потому что что Unix-сокеты, что Serial Port, они, ну, реально, ты открываешь эту штуку с какими-то параметрами, а дальше оно, в принципе, ну, поток байт двухсторонний. В принципе, сокет, пайп, порт, почти что угодно, это вот все из одной области. Ну, если это все... Ну, по фичам все точно совершенно, то есть, как бы, там есть еще куча мелких изменений, то есть там, как в любом мажорном рейсе Ирланды... Подожди, а ты про время, то, что он не складывается в BIM уже рассказал? Время? А, я что-то упустил, да. То есть компилятор больше не складывает время компиляции внутрь BIM, и поэтому, если вы из одного и того же исходника компиляете, BIM теперь будет один и тот же. Да, это, кстати, офигенно важно, потому что я вот... То есть у нас похожая ситуация была с флэшом, у нас есть флэш-ассеты, которые мы, ну, после того, как перекомпилировали, мы их кладем на CDN, соответственно, нужно манифест поправить. После каждой компиляции, даже если нет никаких изменений в байнере флэша, у нас там новая чек-сумма, новый манифест, и снова перезаливать, хотя можно было бы вообще не делать работы. То есть скомпилировали, поняли, что бинар такой же, и ничего не делать. Вот я хотел бы все-таки это иметь флагом, потому что было очень удобно, когда... Ну, мы часто катили маленькие хотфиксы BIM-никами, и было очень удобно зайти в REPL и посмотреть, а какой версии, когда был скомпилен этот BIM-ник. У тебя MD5-чек сам есть. И что? Ну, зачем в него еще время совать? Потому что удобно, мне понятно, это было там полгода назад или вчера. А по MD5-чек сумма мне на это не отвечает. А зачем тебе это? Ну, знаешь, как бы, да, тебе, как бы, ты можешь эти артефакты где-то хранить в том же Jenkins, или там, как бы, мы у нас тут приходили в гости, артефакты рекламировали. Ну, как раз высказ для этого, тебе не должно быть в артефакте этих метаданных. У тебя как раз артефакт в идеале должен быть контент-адреса был. У тебя сам файл? Насколько я понимаю, артефакт никому ничего не должен. Вот, и сделать это флажком было бы не так уж сложно. Не, погоди, погоди, стой. То есть у тебя BIM-получаемый, или бинарник, или объектный файл, он должен зависеть только от того, из чего он делается? Еще раз, никому он ничего не должен. Не надо вот придумывать что-то и потом говорить, что так должно быть. И сделать это флагом было бы не сложно. Хорошо, тогда он не должен никому, чтобы там внутри было время. Оно там раньше было. Но это неправильно. Ну, это ты так считаешь, а я так не считаю. Ну, то есть как бы мы равны. На самом деле еще такой момент, я тут про стейтм сказал, и про улучшение SSL сказал, а не упомянул такой момент, что стейтм, собственно, в частности был использован при улучшении SSL, и там теперь меньше тут странных кейсов, которые непонятно было как хендлить, просто потому что при написании ручками на стейтм странные кейсы не возникают. Вот. Ну, то есть я упрощаю сейчас ситуацию, но по сути к этому сводится, что просто стейтм там более адекватный и меньше фигней получается. Ну, конечно, тут еще может быть эффект того, что когда переписываешь что-то в третий раз, оно просто лучше получается, может, еще в этом дело. Но, тем не менее, стейтм реально уже используется внутри Erlang. Ну, все мы знаем, что подождем до 19.2? Нет, нет, нет. Завтра это более консервативно, да. 19.04 минимум. Как бы и заставили, 0.4 даже зачастую не бывает же в Erlang. Напомню, они это самое зависание подчинение в процессе заблока называют. Ты о чем сейчас? Ну, была проблема, что постоянно процесс, который раутит сообщения с других нод, на других машинах зависает, залипает. Я все еще не очень понимаю, о чем ты. Я забыл, как он называется. Вот у тебя две машины физических на обоих Erlang. Я хочу сообщение с нода на нода, но поскольку у меня приложение может на машине крутиться много, там такой процесс роутер крутится. Я забыл, как он называется в Erlang. EMPD или что? Да, да, да. Вот у него была проблема, что он иногда повисал без причины. Они это подчинили или нет? Там он не повисал, там не совсем так. Повисание я не видел ни разу, вообще совсем ни разу. Я видел одну проблему, которая до сих пор иногда, по-моему, выскакивает, что мы убиваем ноду, а он... Имена залипали. Сейчас они не то что залипают, они все равно иногда могут немножко дольше быть внутри EMPD зарегистрированы, чем нода существует. Что в принципе, ну, как бы так может быть. Я точно помню, что был реквест с EMPD написан на самом же Erlang, в котором было бы меньше фигней. Я уже не помню, что с этим по реквестам стало. Помню, что это неизвестно от Петра Гребенкова, это был по реквестам, но я вот не помню, что с ним стало. Соответственно, с реквестом, не с Петром. Так, эта тема, она закончилась? Ну, вам виднее, у меня документ повис, я ничего не вижу. Да, пошли дальше. Я хотел рассказать про пару достижений, маленьких, но все-таки. Во-первых, FreeBSD, всеми любимая тема, все слушатели сейчас возрадовались. Я когда экспериментировал, ставил его на свой второй ноут, столкнулся с проблемой, что вот есть USB адаптер, и конкретной модели ты, когда набираешь определенный последовательность команд, выдергиваешь этот USB адаптер, втыкаешь обратно в USB, у тебя текущее ядро, которое разрабатывается, 11-е, оно крашится. Но я эту проблему зарепортил, залил им корку, трейс, вот это все. Прошло какое-то время, чувак написал патч и говорит, ну, по тесте, да? Я не принялся, по тесту сказал, что да, спасибо, вы исправили, все круто работает, и патч этот замерзли. Я понимаю, что это, конечно, не так круто, как сделать commit в ядро подброса, но мы выясняли, что это тоже вроде как contribution. Вот, afterpatch, я не уверен, ну, то есть Андрей, Эндрей, Воскобойнюк, наверное, так произносится, извиняюсь, если что-то не так. Ну вот, и прям в commit, там мое имя написали, так приятно. И еще недавно я обновился до Sync013, нашел там интересный баг, связанный вот с чем, что у тебя есть файловая система, у файловой системы обычно есть лимит на максимальную длину файлов, имен файлов. И там происходит такая штука, что ты, допустим, создал какие-то все файлики локально с длинными именами, ну, такие, почти у предела, они у тебя куда-то синклились, потом ты, например, почистил свой каталог локально, начал синкиться с другого сервера, и вот в этот момент, когда ты синклишься с другой машиной, у тебя создаются временные файлы с именем, как вот, всех файлов, и плюс к ним что-то написано. И вот это плюс чего-то написано, оно уже может не вмещаться в лимиты файловой системы, и в результате у тебя ничего не сыпется, там полный лук ошибок, особенно удобно, если ты использовал какую-то GUI-обертку к Sync013, и тогда ты вообще не понимаешь, почему ничего не синклится, все перезапускается. Вот, собственно, зарепортил этот баг. Первые комментарии от project member, как бы, от самого Sync013, что, ну, это проблема не в самом Sync013, короче, у тебя файловая система какая-то кривая, а мы не хотим ничего знать. Вот. Но я еще не теряю надежду переубедить этих людей. Вот такие дела. Зарепортил таки баг в open-source. Это вообще круто, это у нас самый большой контрибьютор в open-source. Не правда. Я думаю, вы очень много комитетов в библиотеке просто сняете и не раскладываете. По чему же мы лидим? Мне кажется, по уделенному количеству контрибьюторов прям open-source, особенно большой open-source-центр, чемпионы, знаешь, если тебе делать какую-то визу, типа того, что там, в свете нужна, как называется, британская… Exclusive talents. Да, типа того, exceptional talent. Мне кажется, тебе ее дадут просто как контрибьютор в open-source, тебе ее могут просто взять и дать. Я этого не знал, но спасибо. Ну, там один из пунктов, там нужно, там по-моему, два обязательных пункта и что-то… да нет, один обязательный пункт и пара не очень обязательных. И вот мне кажется, с таким количеством контрибьюторов в open-source, ты по ним просто пройдешь по всем. Кстати, вот если вам очень хочется контрибить в open-source, то когда ты апдейтишь пакеты во FreeBSD, там иногда к пакетам присоединяются некоторые сообщения, которые тебе выводятся. И я прочитал там интересное, что есть такой пакет jpickview, это утилита, ну, очень простая утилита на GTK для просмотра фоточек. Написано, что у нее нет мейнтейнера, у порта, в смысле. И если вам очень хочется, можно мейнтейнить порт. Там, на самом деле, довольно такой внушительный список обязанностей, то есть нужно следить за новыми версиями, обновлять порт, принимать баг-репорты от пользователей, имеется в виду FreeBSD пользователи. Но, в принципе, мне кажется, это не так, что дофига сложно, и сделайте хорошее дело. Ну и я предлагаю переходить уже к темам пользователей. А я, кстати, хотел спросить про Erlang еще. Я надеялся про FreeBSD. Нет, про FreeBSD нет. Я хотел спросить, есть такая проблема в Go, иногда она встречается с таймерами, потому что таймеры в Go это просто, по сути, в отдельном процессе, в отдельной гаррутине. Крутится гаррутина, которая держит в структуре типа хипа все таймеры, и, соответственно, там подель типа какой-то просыпается, берет очередной хип, очередной элемент из хипа, и, соответственно, если у нас дельта, точнее, этот таймер должен стрельнуть в нашу дельту, он вызывается, этот таймер. И мне кажется, в Erlang сделано примерно то же самое, проблема в том, что когда много таймеров возникает, которые создаются и удаляются, у хипа вставка, по-моему, логарифма, и поэтому возникают сложности с этим. Как в Erlang с этим работает? Что-то есть там? По-моему, вставка у хипа на самом деле, по-моему, все-таки амортизированные единицы, ну, как бы, понятное дело, что амортизированные, а амортизированные непонятно, что там на самом деле может быть в итоге. У Erlang там подход, который называется таймер view, тоже похоже, что ты описал. Я сейчас реально очень боюсь соврать, потому что там, ну, как это, оно от версии к версии менялось. Я точно знаю, что они это очень улучшали, и в последних версиях оно сильно лучше масштабируется, чем было в более старых версиях. Совершенно точно могу сказать, что они не бесплатные, они дешевле, чем в Google, потому что на кучу-кучу процессов, ну, вот вполне можно наплодить по процессу на клиента, которых сотни, там, по крайней мере, десятки тысяч точно. В каждом имеет какой-нибудь таймер, и это не сдуется, это, в принципе, будет нормально работать все еще. Я точно помню, что было видео, в котором проходились по тому, как оно сделано в последних версиях, как оно было. Я, честно, очень боюсь соврать, потому что, ну да, оно менялось недавно. Ну, в общем, я попытаюсь найти что-то такое, что раскрывает тему. Совсем кратко на этот вопрос отвечаю, то оно побыстрее работает, чем в Google, и я ни от кого в Erlang не слышал такого, что, типа, ой-ой-ой, давайте не будем, давайте стараться не использовать таймеры, особенно селекторные таймеры, потому что это ой-ой-ой дорого. Вот, там с этим проще. Ну, оно как бы точно совершенно неплохо размазывается по отдельным шедулерам, ну, то есть по отдельным традам физическим. И сейчас, по-моему, даже, то есть я точно знаю, что в АКИ в итоге сделали, или в КАФКИ это было, сделали в итоге и Hierarchical Timer Wheels, а, по-моему, в Erlang сделали что-то похожее. То есть когда у нас вместо одной большого хешмапа используется много маленьких, которые, ну, hierarchically выстроены, поэтому у нас вот эта ставка мавортизируется сильнее. Ну, по-моему, что-то такое там, но боюсь соврать. Ну и переходим к темам слушателей. Извините, я снова назвал вас пользователями. Конечно же вы слушатели. Так, а что, не будем про Property Based говорить? Я предлагаю, это хороший разговор, там просто много интересного, и Света поучаствует. Ну, вот, вот, вот, ну, ладно. Там просто реально такие две тянки, типа, просто две статьи на упоминание, я не хочу раздувать. Какой беспредел со стороны ведущего. В следующий раз и Света порадуется. Окей. Первая тема от какого-то Славы Бахмутов, я не знаю, с какой-то стороны человек, про видео про распределенщину на историю же с DataScale. Ну, мы уже немножко зацепили, да, Слав? Да. Второй, это анонс книги о Machine Learning от Andrew Ng. Он ин. Что? Ин. Andrew, ин. Так, так, так и говорится, да? Да. Блин, я не знал. А че он везде написан ng? Ну, потому что, ну, оно вот ин, так пишется. Ну, как бы, в нем нет уже в английском языке и. Бедный язык. Слушай, че, серьезно? Хорошо. Следующая тема от Andrew Ng. Книжка. Вы смотрели? Пока нет. Вообще, мне, я же проходил этот ML, ML курс, как он назывался, вот. Сам Andrew мне очень понравилось, как он структурировал материалы, что давал, что не давал. Так что я думаю, что посмотреть обязательно стоит. Надеюсь, надеюсь, он ее напишет по-нормальному, да, Саш? Саша у нас любит книжки. Следующая тема от пользователя Fi5T. Про то, что Amazon блокировали в России. Ну, не Amazon, а S3. Да, ну, вот как сидящий в России, заметили? Нет. Конечно, заметили. Вы не заметили? Нет. Я-то не в России. А, ну, ты-то не в России, ладно. А, ну, то есть, а Саша не заметил. А я просто не заметил. Ну, то есть, у меня все открывается и придается. Нет, сейчас-то уже вернули. Там на один день и на полтора, что ли, дня выключали S3. Некоторые провайдеры, ретиво быстрее всего это добавили, в частности, Домбру, на котором у нас на работе интернет сделан. И у нас отвалилась куча всего. То есть, вплоть до, я не знаю, иконки, какой-нибудь граватар работал через него, какие-то файлики там лежали, дропбокс, там несколько приложений, которые на Амазоне работают. Все отвалилось, ничего не работало. Дропбокс же свалил с Амазона целиком. Ой, не дропбокс. Нет, целиком. Он для Европы с Амазона еще работает. Ну, в общем, что-то у кого-то не работало. И через какое-то время мы нашли новость, как раз поняли, из-за чего все это происходит. А потом оказалось, что какой-то неправильный сайт что-то положил на С3, его отключили. Потом его включили обратно, у нас все заработало снова. Ну, я даже не знаю, что сказать на такое. Я недавно слушал Go Lang Show, и там ребята рассказывали из Медузы проекта, что они решили на Google перейти вместо С3. Для того, чтобы, ну, типа Амазон… Чтобы их не блокировали. Да-да-да-да-да-да. Google сложнее заблокировать. Видите, важное стратегическое решение. Не знаю. Тут же, на самом деле, есть еще более страшная вещь, которую почему-то в тему не добавили. Так называемый акт… Какого же он там? Я-я-я-я-я… Яровой? Яровой, да. Который, ну, если шифрования не будет, все ключи сдайте товарищу майору. А также, ну, там еще были интересные моменты, связанные с автоматическим решением гражданства, которые, правда, в итоге выбили. Но это было бы очень весело. Обычно, даже если ты хочешь от гражданства отказаться, это очень трудно делается. Вот, ты знаешь, пошел, поработал, не знаю, в полицию куда-нибудь или в армию, послужил в другой стране, и все. Нет у тебя больше гражданства российского. На самом деле, вот этот законопроект или закон уже, его уже приняли сегодня и вчера. Ну, я так понимаю, там еще через президента должно пройти, но сомнений, что он пройдет, через него не остается. Я предлагаю политзен подкаст прекратить. Нет-нет, я не про политзен. Там просто важные же моменты для шифрования, все-таки это не совсем политота, это как бы момент такой глобальный, что, ну, а что делать-то с шифрованным сервисом? Я не очень понял, вот я, если пользуюсь, не знаю, каким-нибудь внешним сервисом, я ведь могу продолжать им пользоваться, это все без проблем. То, что они там не смогли договориться с правительством, это не мои проблемы. Понимаешь, самое страшное, что ничего не понятно, там такие размутые формулировки, что то ли тебе его заблокируют, то ли это вообще не относится к любому шифрованию, а относится только к определенным типам этого самого трафика. Опять-таки непонятно, пойдут эти зарубежные компании на сделку с нашим правительством или нет. Вот, то есть, это настолько пространная и неопределенная норма, которую в самой произвольной трактовке можно сказать, что дайте нам ключи от всего вашего интернета и мы все тут вам полностью расшифруем. А в узкой трактовке, что там, не знаю, сервисы на территории России должны что-то такое предоставлять. Ну, в общем, это все очень туманно, неясно и ничего хорошего не сулит пока что. И главное, как обычно, тяжело исполнимо. Я думаю, в любом случае все крупные компании, которые получают здесь деньги, они начнут сотрудничать, все маленькие компании, которые мы сами делаем, ну, в смысле, сами обычные мелкие предприниматели делают, они по-любому будут сотрудничать. Ты представляешь, что такое сотрудничающий Gmail? Как это вообще себе представить? Их же потом просто, как это, мировое сообщество же потом просто какашками закидает с ног до головы, если они дадут ключи даже от части трафика. Ну, ты знаешь, это все очень интересно, конечно, а ты видишь другой альтернативный вариант? Вот мы сегодня на работе это обсуждали. У меня есть альтернативный вариант, и я даже не предложил отменить этот самый политзен. Я на самом деле не понимаю, зачем это нужно, там, чьи-то ключи от шифрования, потому что, если ваш почтовый ящик, например, кому-то стал очень интересен, то письма с него, не входящие, исходящие, очень прозрачно сливаются на нужный ящик товарища майора без вашего ведома, так, если кто не знает. Это почти у всех почтовых сервисов. Я просто не могу за все говорить, ну, во многих. А зачем тогда тебе шифрование еще? Смотри, смотри, смотри, сейчас, да, это все так, просто смотри, сейчас, чтобы это пойметь, нужно принять решение суда, с решением суда пойти в компанию, в компанию еще. Валер, позвольте я, как человек, который работал как минимум в двух компаниях, представляющих почтовый сервис, заверить, что это не так. Кстати, недавно, вот буквально неделю, была интересная новость про Yahoo, который, ну, у нас этого в темах не было, но в тему, про Yahoo, который не только слил там, ну, типа, настроил скрытую переадресацию, входящую, исходящую почту, они слили историю удаленных черновиков. То есть, представляешь, ты написал черновик, потом удалил его, они это из какого-то бэкапа, типа, за последние полгода достали и в суде это использовали как доказательство, и успешно там чуваку, который пытался торговать наркотиками, там, продлили тюремный срок, он не смог выйти. Так что, ну, и вот в связи с сказанным, я действительно не понимаю, кому, зачем эти ключи шифрования дурацких. Да потому что не только у Gmail есть почта, потому что ты можешь сам себе почту настроить на каком-нибудь сайте, потому что ты можешь создать VPN-коннект и по нему, я не знаю, что-то пересылать. Опять же, сейчас слишком уж много развелось мессенджеров с end-to-end шифрования. Да, то есть все эти вещи тяжело контролировать, и контролировать хочется. И я, если честно, не вижу, по-серьезному, будущего, в котором государство не может что-то контролировать, оно в любом случае будет контролировать, не только в России, это все будет. Как раз нормально ситуация, ну там, не знаю, в Германии есть норма по поводу того, что трафик нужно на провайдере копить, но там никто не пытается расшифровывать, больше того, правительство промоутит сильное шифрование. Всякие Нидерланды, Швеция, Снорвегия, там тоже шифрование в плане все приветствуется. Я знаю ровно 2-3 другие страны, которые пытаются залезть в шифрование, это тоже такие, знаешь, типа мегадержавы, это США, Британия, Китай и вот Россия, вот эти страны пытаются залезть в шифрование. Больше того, они это делают таким образом, что явно видно, что политики, которые это предлагают, не понимают, как работает шифрование. Выбора нет, Валер. Ну выбора нет, блин, как бы есть матан, матан тебе говорит, что ну вот просто так взять и расшифровать нельзя, они скомпрометируют вообще всех. Это все понятно. Нельзя дать ключи доброму дяде и гарантируя, что эти ключи только у доброго дяди останутся, так не бывает. Но не бывает и государство, которое не может контролировать свою территорию. Ну как-то не бывает, бывает. Не бывает. То есть сейчас есть сервис с энтузиазмом, то есть, насколько я понимаю, тот же самый WhatsApp, если то, что они публикуют, то есть понятно, что WhatsApp, он не опенсорсин, но если то, что они публикуют в блоге и говорят на технических конференциях, это действительно так, то они просто не имеют ключей от сообщений, которые пересылают. То есть государству просто некому пойти. Как некому, к конечному пользователю. Если ты создаешь, организуешь передачу, то ты должен отдать. Все. То есть ты создал передачу от Васи к Пете, и Вася, и Петя, и все, кто участвовали, должны прийти к государству и отдать свои ключи. Все нормально. Ну понимаешь, в этой ситуации хотя бы только если Вася, Петя под клопаком, только тогда они должны будут отдать ключи, а не так, что отдать ключи. Нет, подожди, тут, конечно, недоработка закона. Если Вася, Петя сами не отдадут ключи, то надо их, конечно же, лишать гражданства. Есть мнение, что стегонография в ближайшем будущем обретёт большую популярность. Количество котиков в интернете вырастет в разы. Да, поддерживают. Вообще там ещё в законе помимо шифрования много других проблем. Например, там есть требование хранить пользовательские данные в течение полугода, по-моему, это огромный объём данных, как их хранить непонятно. То есть это явно увеличивает расходы компаний по сравнению с законом. И когда мы это обсуждали, мы подумали, что это пролоббировали всякие китайские компании, которые делают винчестеры. Ну реально, надо срочно увеличивать парк винчестеров везде, в разы. Плюс ещё, по-моему, там в этом законе есть что-то про то, что Google и прочие зарубежные компании, типа Netflix, должны платить какие-то определённые деньги за то, что они продают сюда. Это, по-моему, был другой закон. Другой, ну много их законов, что интересно. Короче, в последнее время приняли, подводя черту, в последнее время приняли очень много висок законов, и непонятно, как это всё будет исполнять. К тому же был, сколько лет назад, закон про то, что все персонали данные должны находиться на территории России, а насколько я знаю, ни Google, ни Facebook до сих пор этого не исполняют. Это, насколько я знаю, так и не работает. Ну то есть, да, издали закон, молодцы, расходимся. Ну то есть ничего не изменилось, по вашему счёту. Вот я сейчас, у меня документ в Google Docs, у меня там чатик в Slack, и там ещё 100-500 сервисов, где у меня есть учётная запись, ну то есть, не знаю, Array, чтобы назвать одну, да. И сомневаюсь я, что у них сервера в России. Да, в общем там дальше тема была про Феникс, мы это уже обсудили. Там единственный вопрос, который мы не затрагивали, это можно ли на Ирландии разрабатывать под Windows. Я честно не пробовал, Linux для этого ставить не нужно, разрабатывать в принципе можно, там есть какие-то моменты, типа тех самых Unix-сокетов, которые не очень хорошо работают, то есть отсутствуют на Windows, но в целом разрабатывать надо. По поводу дистрибутива, ну стандартный дистрибутив это да, грёбаный runtime со всеми библиотеками, это так, в принципе никто не мешает собрать обрезанный runtime. Насколько я знаю, разрабатывается, и я вроде даже пробовал какую-то GUI-ню запускать в своё время, и ещё есть разные такие GUI-поделки на Ирландии, там знаменитый Winx 3D, он типа есть под Windows, так что если очень сильно хочется, то можно. Нет, просто у меня на одной из работ коллега разрабатывал на Ирландии под Windows, при этом сидя под Windows, понятно, что сервера были на Linux, но он их разрабатывал сидя под Windows, там ничего сверх-Linux-ового не использовалось, поэтому всё это нормально существовало, у него был какой-то рабочий процесс совсем не похожий на мой, но он у него был. Это самое, так в экзамплярах все GUI писали тесты на Ирландии под Windows. Ну я не хотел так подробно, но да, я примерно про это и говорил. А, ну окей. Всё выдал. Но это было давно, сейчас уже могло всё поменяться. Так, ну давайте, хоть у нас Слава и гость наполовину, но всё равно, Слав, давай скажи что-нибудь напоследок.",
    "result": {
      "query": "как работает таймеры в Erlang"
    }
  }
]