[
  {
    "segment_id": "30c1e84b-89ee-46c7-8881-ef0882be89cf",
    "episode_id": "6b260245-4ce8-49a0-92ea-0afb3eb311f1",
    "episode_number": 254,
    "segment_number": 4,
    "text": "Евгений, давайте не будем о грустном, я боюсь этого момента, давайте дальше пойдём, я страшно. А, ты теперь тоже, да, на 18-м? Да, да. Просто не лупи слишком сильно пытей. Чёрт, нет, не говори мне ничего. Да, клавиатура ненадёжна, аккумуляторы ненадёжны. Что ещё ненадёжно? Это очень страшная ненадёжность. Мы обнаружили ненадёжность в Bluetooth, точнее, не то, что ненадёжность, Bluetooth надёжен, просто его можно надёжно взломать. Причём подвержены все известные, ну, по крайней мере, большинство, 99% известных чипсетов, которые реализуют протокол Bluetooth, и взлом происходит по очень хитрой схеме. То есть, когда Алиса и Боб собираются начать взаимодействие по Bluetooth, они сперва договариваются между собой о ключе, о ключе, которым будет шифрование производиться, а точнее, они договариваются между собой, часть… Сейчас я начну говорить, подождите, у меня язык заплетается. Часть протокола установления коннекта – это договаривание сторон между собой о размере ключа, которым будет производиться шифрование. И вот эта энтропия ключа, как она называется, она от 1 до 16 байт, и при этом этот протокол подразумевает, что как это там требуется, чтобы протокол поддерживал от 1 до 16, то есть это требование протокола всех версий. И есть очень интересное свойство протокола, что когда, например, одна сторона говорит, я хочу установить 16 байт, но все по умолчанию начинается с сильного шифрования обычно, и вторая сторона говорит, слушай, я 16 байт не поддерживаю, давай меньше, и вторая сторона предлагает уменьшенный размер ключа. И, соответственно, первая сторона, она может либо согласиться, либо аборт сделать. Но, конечно же, все соглашаются чаще всего, потому что иногда приходится работать с очень простыми устройствами, которым очень сложно делать сложное шифрование, и они могут просто не уметь сделать больше, чем 1 байт. Но это было такое предположение, когда создавался этот протокол. В настоящее время, конечно же, все поддерживают большие ключи, но протоколу они следуют. И, соответственно, строится обычная атака man-to-middle, потому что когда происходит разговор о длине ключа, это все не зашифровано, нет никакой атонтификации, и какой-нибудь Чарльз, находящийся посередине, он может послать обоим сообщение, что вот, мол, Боб, слушай, Алиса тут предложила начать с единицы, или понизить до единицы. И аналогичное сообщение Алисе, слушай, Боб, Боб тут попросил понизить до единицы, потому что он не умеет. И эти стороны говорят, ну, раз тут просили единицы, давайте будем по единице. И получается, что очень ненадежное шифрование, а дальше тупым перебором на самом простом лэптопе можно на лету прямо вскрыть этот ключ, и начать расшифровывать передаваемое сообщение, или даже посылать свои собственные правильно зашифрованные сообщения, которые будут всеми полагаться, что они валидны и корректны. И проблема в том, что в настоящий момент нету простого способа это все починить, потому что это часть протокола, то есть правильное решение – это починить протокол таким образом, что, ну, разные есть методики, разные идеи – сделать минимальные, повысить этот минимальный. Сейчас я уточню еще. Вот этот договор о размере ключа, он происходит независимо от того, какое ПО вы используете, потому что это зашито в протокол и в чипсетах. Чипсет просто вам выдает наверх и говорит, слушайте, мы тут договорились о ключе, мы уже начали все шифровать, давай начинай работать, строить свой уровень приложения, соединение на уровне приложения. В этот момент передается информация о том, о каком размере ключа договорились, и поэтому теоретически одно из простых решений – это не разрешать соединение, если размер ключа единица, потому что это взломать совсем просто. Вот это самый простой workaround, который фактически может заключиться в том, что все будут досить, то есть ты взламываешь, и автоматически соединение отбраковывается. Единственное исключение, которое не обнаружили, это наушники у Apple, которые ниже 7, по-моему, не опускаются. Там под звездочкой написано, что они не смогли добиться опускания размера ключа ниже 7 байт, но это опять же ни о чем не говорит, возможно, можно добиться и ниже. Под ударом все Bluetooth-клавиатуры, под ударом взаимодействие между лэптопами, которое происходит по Bluetooth, под ударом, не говоря уже про все наушники, конечно же, вообще все, и это прям вообще страшно. Наушники, надо сказать, это не супер такая... За исключением того, что ты можешь передавать Siri какие-то сообщения? Да, но все равно, знаешь, это такая вещь, которую проще подслушать банальным вторым микрофоном. Нет-нет, ты не понял, ты можешь генерировать Siri... Ну, клавиатура это самое страшное, ты можешь генерировать команды Siri. И это тоже опасно как бы. И это прям страшно. А вам не кажется, что это один из тех случаев, когда атака, она больше теоретическая, чем практическая, потому что сам Bluetooth, он не слишком дальнодейственный, ну, что вот прям находиться рядом... Ну, просто смотри, кейлоггинг в офисе, где много народу сидит, и где там, не знаю, все модные хипстеры с беспроводными клавиатурами... Где я работал довольно долго, ну да. То есть это даже не какой-то офис одной компании, не то что я пробрался в какую-то компанию, просто я пришел в каворгинг, сел... В кофейню, занимаясь Starbucks. Нет-нет-нет, секундочку, я думаю, вы упускаете один важный момент, это же не пассивная атака, тебе нужно сгенерировать пакеты от как бы фейкового отправителя, при этом добиться того, чтобы тот оригинальный пакет не был получен дважды. Я вот эту информацию специально искал в пейпере, и я не нашел... Ну, по крайней мере, может, я плохо искал, но я на самом деле пытался понять, каким образом они двойное получение каким-то блокируют образом. Но они говорят, что они добились воспроизведения на там Nexus'ах и Nokia, и еще на чем-то, плюс на чипсетах, которые в ноутбуках используются, ну, то есть, как бы они подтверждали на многих разных устройствах, и у них прям есть таблицы, на чем они смогли подтвердить, и в этой таблице там больше 19 разных чипсетов, которые используются во всех этих устройствах. Я не очень тоже это понял, возможно, кто первый послал, того и тапки, и они очень сильно напирают на то, что даже слабенький лэптоп, на котором не слишком сильная производительность, он может отслеживать Bluetooth-соединение, там, я не знал, но оказывается, есть не one-on-one Bluetooth-соединение, а один ко многим, вот, и ты должен отслеживать пакеты в каждом, ну, в смысле, один ко многим, он соединяется с каждым по отдельности, хотя вещает на всех, вот, и он говорит, что даже один ко многим слабенький лэптоп сможет спокойно перехватить и все обработать. Ну, то есть, как бы, совсем все сильно. Если ты будешь использовать более специализированное оборудование, то будет все еще хуже. И что самое плохое, на уровне операционной системы, на уровне логики приложения, это нельзя заметить за исключением того, что ты увидишь, как это, того, что энтропия только один байт, а все остальное будет работать как будто бы все ок, то есть ты, это невозможно обнаружить чисто теоретически. Интересно, кстати, ну, то есть я правильно понимаю, то, о чем ты говоришь, что вся эта логика, она реализована в железе, а не в софте. Кстати, Валера, ты же, когда делаешь пых-пых в микрофон, то есть, ну, когда ты говоришь, что это не видно в софте, то есть, верно, правильно, я все понял, что это все в железе реализуется. Чаще всего это в чипсете, и вам просто приходит, что вот мы канал установили, начинаете работать на уровне канала. Ну, с прошивки чипсета имеется в виду, наверное, да? Что-что? Прошивки чипсета, то есть, скорее всего, можно обновить в теории, если кто-то изморочится. Ну, то есть, скажем, вот там какой-нибудь Nexus 5, который они специально проверяли для того, чтобы посмотреть, да, то есть он уже давно не поддерживается, а кто-то на нем еще использует, думаешь, там чипсет будет обновляться? Фиг знает. Моя жительная философия – не используйте Bluetooth, примерно ни для чего. Просто становится все тяжелее, то есть я очень долго от этого отбивался, а в итоге у меня Bluetooth, ну, две пары Bluetooth наушников, обе из которых я рассказывал, у меня есть Bluetooth клавиатура, под справедливость ради Bluetooth клавиатуру используют только дома. Ну, вот как-то так. Возможно, что-то еще есть, просто я сейчас схода не могу вспомнить. Ну, а эти как его, файлики послать, AirDrop, там ведь тоже Bluetooth используется? Ну, справедливости ради, этот Bluetooth у меня почти всю дорогу, у меня по дефолту AirDrop выключен, ну, и AirDrop, знаешь, как бы его тяжело зловредно использовать, то есть там самое страшное, что можно делать, если у тебя включен AirDrop у всех подряд, то можно просто спамить всякими, не знаю, дикпиками, но ты не можешь попросить устройство что-то тебе послать, оно только на прием работает. Да, да, согласен, я понимаю. Я просто к тому, что теоретически сидя в офисе и слушая AirDrop, то есть раньше я считал, что AirDrop, блин, прикольно, дай-ка я тебе паролик перекину AirDrop, а сейчас я понимаю, капец, может и не стоит. В общем, все очень грустно. И эта ошибка существовала в Bluetooth последние 20 лет. И они говорят, очень странно, что мы смогли обнаружить лежащую на поверхности идею, которую 20 лет никто не заметил. И глядя на все остальные технологии, которые 20 лет существуют вокруг нас, я подозреваю, что там тоже есть какие-то подобные интересные дыбки. Саша, пора бампать свою границу надежности. Да, надо поднимать границу надежности, Саша. 20 лет, мне кажется, у вас неплохая планочка. Да, да, неплохая. Это, кстати, в очередной раз доказывает, что просто никто, в том числе программисты, разработчики, безопасники, никто не читает документацию, потому что если бы, ну, открыть спецификацию на Bluetooth и как бы внимательно ее прочитать, то это должно прямо резануть глаз. Вот, поэтому либо ее никто не читал, либо она прямо очень скверно написана. Я думаю, что, опять же, мы это уже обсуждали, что подобные проблемы можно починить, если все крупные компании скинутся и скажут, что у нас есть бакбаунти на поиск проблем в существующих технологиях, которые используются всем миром. То есть вот этот Bluetooth, он кому принадлежит? Да никому он не принадлежит. Ну, вот только подобные энтузиасты, которые хотят пейпер по секретике написать. Вы не помните, как сравнивали на бакбаунте у Яблока? Мне казалось, что у них там такая бакбаунт, что за любую уязвимость в их устройствах они будут платить. Все так, я как раз это и хотел сказать. Они платят за уязвимости в их продуктах, то есть какие технологии при этом используются, это не так важно. То есть если ты смог найти уязвимость в их продукте, там AirPods еще в чем-то, то как бы ты на коне. Прикольно. Может они и получат подобную штуку. Но они сказали, что они обнаружили ее, по-моему, в июне. Вот они сейчас только ее обнарудуют. Ну, короче, вот они всем разослали, все всем написали. И сейчас прошло время, когда они не имеют права сообщать.",
    "result": {
      "query": "Bluetooth ключ 1 байт уязвимость"
    }
  }
]