[
  {
    "segment_id": "3317f1b9-a1a5-4038-bbc0-69b9065dd5ba",
    "episode_id": "a8a09964-6317-4a54-af51-f884774b873a",
    "episode_number": 377,
    "segment_number": 7,
    "text": "Но я не уверен до конца, потому что я прям эти костыни не то что очень считал лично. Следующая коротенькая темка это статья на usenix.org, которая называется revisiting B plus trees versus lsm3. И статья рассказывает нам о том, что на рынок завезли в большом количестве SSD дисков со встроенным сжатем. Что очень разумно, потому что у тебя флешпамять имеет ограниченное количество циклов перезаписи. И сжимая данные, это речь даже не про то, чтобы у тебя больше данных впитнуть в тот же объем, а про то, что ты можешь либо меньше флешпамяти перезаписывать, либо меньше ее трогаешь, или трогаешь столько же, но в меньшем объеме. Твои диски дольше живут. Это первое. Ну и как побочный эффект у тебя может быть быстрее работа с памятью, потому что ты ее меньше, ты ее, скажем, записал в меньшем объеме, прочитал в меньшем объеме, разжал. У тебя опять же увеличивается скорость и как третий, прям самый-самый побочный эффект, который на самом деле мало кого волнует, потому что диски так дешевые, ну, со звездочкой, то, что ты можешь в тот же объем памяти впихнуть больше данных. Но по-моему, вот это не самое главное в дисках с сжатем. И статья говорит нам о том, что в свете появления вот этого нового железа неплохо бы снова посмотреть, а кто лучше, LSM деревья или B-Plus деревья. И авторы статьи, они берут две реализации, точнее три, сейчас мы перейдем к третьей. Они берут ROG's DB как наиболее продвинутую реализацию LSM деревьев, они берут WireTiger из MonkDB, я, кстати, не знаю, в смысле, я никогда не пробовал его, по-видимому можно вот прям как отдельный движок использовать, да. Они берут WireTiger и как наиболее продвинутую, ну как, короче, как ту реализацию B-Plus деревьев, которую они осилили и используют. И еще у них есть B-Minus деревья, я не очень понял, откуда они взялись, то есть это какая-то своя реализация для сравнения или что это. И статья Линды, но самое интересное, в ней вот прям в конце, перед Conclusions, там три графика приводятся, где сравнивается чтение случайно, случайно чтение по ренджам, то есть не одной записи, а случайно, но ренджами и случайная запись значений. И если посмотреть на эти графики, то по чтению WireTiger, который B-Plus деревья, он либо быстрее LSM3, либо намного быстрее LSM3, ну то есть мы говорим там про два плюс раз. На запись по вот этому исследованию... Погоди, погоди, я не вижу два плюс раз. Смотри, вот в самом конце Conclusions, да, три графика, да, смотрим левый, это случайное чтение. WireTiger он дает больше, но не в два раз. Да, 60 плюс против 80 тысяч. Потом второй график, у тебя чтение R&J, вот тут WireTiger уже в два раза быстрее. Да, да, да, и по записи, вроде как, вот, ну, конкретно эта реализация B-Plus деревьев оказалась медленнее, но это не обязательно очень плохо, потому что многие нагрузки, они чаще, намного чаще... От вашего шаблона поведения, ну, в смысле использования данных. Да, да, но большинство нагрузок, они намного чаще читают, чем пишут. Вот нагрузка, которая вот прям очень много пишет и редко читает, это какие-то грахаус-системы, и там все равно не используется ни B3, ни LSM3, насколько я представляю себя это. Так вот, я не убежден в том, что вот эта мейчмарка, она абсолютно показательная, но наброс хороший. Наброс хороший, что вы об этом думаете? Я четко уверен, что в связи с тем, что мы меняем наше железо, с которым мы работаем, мы очень должны постоянно пересматривать наши предыдущие выводы, которые мы сейчас считаем как дано. То есть мы пришли к тому, к чему мы пришли там 20 лет назад, грубо говоря, и почему-то мы их не пересматриваем. Надо обязательно все пересматривать. То есть как мы правильно используем все вот это, что лучше B-Plus или LSM. Отлично, давайте поглядим на новых версиях дисков, давайте посмотрим на новом, не знаю, на новом оборудовании, давайте посмотрим там, давайте посмотрим здесь, аналогично совсем. То есть я очень приветствую подобные статьи, они задают правильные вопросы, надо постоянно это проверять. А кто-нибудь помнит, разработчики из MongoDB, они как-то объясняли, почему они выбрали именно B-Plus деревья, а не LSM деревья. То есть на момент реализации в ArtTiger уже был большой ажиотаж вокруг LSM деревьев. Кажется очень неочевидным шагом в свете этого ажиотажа выбрать B-Plus деревья. Да, как бы очень скоро после начала ажиотажа вокруг LSM деревьев появилась так же ажиотаж об их недостатках. В частности, то что у тебя есть вот этот компакшн, который в случае, просто часто он создает как бы неочевидную нагрузку на систему. Это одна из вот кто React оперировал, или похожая система знает, что вот вот LevelDB он склонен, ну и все производные LevelDB, RoXDB, они в разной степени могут быть оптимизированы и в разной степени это может быть патологичным, но у них у всех есть и бывает проблема с тем, что, черт побери, процесс компактизации может очень сильно отражать ваших ресурсов на машине и это может сделать как бы совершенно не в то время, когда вы хотите.",
    "result": {
      "query": "B‑Plus vs LSM дерево SSD сжатие"
    }
  }
]