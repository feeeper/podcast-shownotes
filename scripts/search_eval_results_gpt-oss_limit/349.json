[
  {
    "segment_id": "4cfd647c-1a15-4858-92b9-12ec5eefeb15",
    "episode_id": "3815dc08-2219-4b94-a8fa-08dfd70c1840",
    "episode_number": 349,
    "segment_number": 3,
    "text": "Они вроде как пытались начать с какой-то каулс-стори из жизни, потом такие, а, кстати, вот там релиз нотас. Короче, пост он не связан. Сумбурный, я хочу сказать, наверное. Сумбурный, несвязанный в моем лексиконе, это синонима. Ну, в слие в итоге просто уточняют, что ты имеешь в виду. Да-да-да-да. Ну, такой, как будто в пятницу, вот, кто-то там, знаешь, так одним глазом глядя в другое место, так по-быстрому червоблажиком бросал. И сличонки подсвечивают такое, что раньше в PostgreSQL, если ты только добавлял данные в таблицу, но никогда их не удалял, то это триггерило аналайз на этой таблице, потому что, понятно, тебе нужно копить статистику по тиглам, но это не триггерило автовакуум, потому что, логично, ты не удалял данные, нечего вакуумить, там нечего сжимать, если ничего не удалялось. Но начиная с PostgreSQL 13, это больше не так. Только вставка данных, она будет все равно триггерить вакуум, и делается это по той причине, что, помимо своей основной задачи, типа дифрагментации вакуум, делают другие полезные вещи. Самое главное, он, секундочку, да, он может поставить биты в заголовке страниц о том, что все тюплы в этой странице видны всем транзакциям. Такие флажки есть, они ускоряют некоторые запросы, и, в частности, ускоряют индексон Liscans. Поэтому, когда вы обновляетесь на PostgreSQL 13, например, с 12, то у вас с одной стороны вакуум может гоняться чаще, а с другой стороны индексон Liscans могут стать быстрее. А до этого, возможно, вы делали вручную, ну, как-то по крону запускали вакуум. Еще здесь говорится, что вот этот запуск вакуума, он размазывает по времени работу по заморозке фризинг старых туплов. Честно говоря, вот я сейчас по памяти не готов сказать, что такое замороженный тюпл. Может быть, Валер, ты помнишь? Ааа, замороженный тюпл это... сейчас, я помню, что такое... Я же забыла, что это замороженные таблицы. Что такое замороженный тюпл? Наверное, тюпл, я сейчас боюсь соврать, но мне кажется, это тюпл, который точно уже никакой транзакции трогать не будет. Типа, вот мы его потрогали, и все, дальше вот сюда трогать нельзя, может только, не знаю, наверное, всю страницу переписывать. Наверное, что-нибудь такое. Я впервые ставлюсь, по-моему, с замороженным туплом. Я быстренько изучил вопрос при помощи популярной поисковой системы. Я так понимаю, что вот это... фрозный тюпл это синоним вот того, что я выше сказал про флажочки на таблице. То есть они это называют... Ну, то есть, казалось бы, это должна быть замороженная таблица, замороженная страница. Но они говорят, что вот когда страница имеет такой флажочек, то все тюплы на ней заморожены. Ага, да, и, в конце концов, это самая таблица, которая стоит только с замороженной страницей, замороженная таблица. Вот, я не знал такой терминологии, честно скажу. То есть, я знал про флажок. Я не знал про то, что вот если есть флажок в странице, тогда говорят, что тюпл заморожен. И, да, речь идет о том, что когда у тебя флажок уже проставлен, его не придется... Ну, никаким другим процессом не придется проверять, а не надо ли нам проставлять флажок, вот он уже стоит. То есть, как бы, здесь, в предыдущем предложении делался акцент на том, что эта работа, она размазана по времени. Тут еще есть такой важный момент, что на замороженных страницах там не может быть никаких пропараундов, там не может быть никаких... там, короче, не может быть работы для вакуум-процесса. То есть, чем хороши замороженные страницы, тем, что если страница уже прям точно заморожена, значит, как бы это просто... там дальше будет только нагрузка на чтение, и если у вас просто вакуума нужно......отсмотреть очень много страниц, чтобы найти те там полтора тупла, которые нужно завакуумить, и там заморозить, то это все еще очень много нагрузки на диск, потому что, чтобы... Если страница целиком не заморожена, если ему нужно реально, как бы, считывать эту страницу и идти по каждому туплу, то ему эту страницу нужно с диска поднять. И поднятия с диска каждой отдельной страницы очередной, это, ну, трафик с диском. Если у нас что-то заморожено, то, скорее всего, вакуум поднадж смотреть не начнет, потому что я-то понимаю, что у него есть какая-то маска того, что он уже заморожен. Речь про индекс омлескана я подчеркну. Я сейчас вообще про то, что замороженность, она не только для индексов омлесканов помогает, она помогает в целом для того, чтобы минимизировать количество нагрузки на диск, которое будет от вакуума, еще потом прилетать. А, ты... Я отдаленно понял. Нет, я решил про то, что если ты делаешь... Вот ты, Позгород, ты делаешь индекс омлескан, ты такой по индексу ведешь. Если ты знаешь, что вот у тебя в индексе, индекс омлескан, он использует данные прямо из индекса. Но в чем проблема, что, возможно, у тебя эти данные уже обновились. Но если ты знаешь, что ты ссылаешься на страницу, которая заморожена, тебе туда даже и ходить не надо. Ну вот да, и с вакуумом то же самое. Если я правильно помню все, что он даже не пойдет вакуумить что-то, что точно заморожено.",
    "result": {
      "query": "PostgreSQL 13 авто-вакуума вставки"
    }
  }
]