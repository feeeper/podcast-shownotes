[
  {
    "segment_id": "0fa95026-1a8e-4c05-bfff-f2b814c033e4",
    "episode_id": "5c8919d3-dfb4-4166-810f-fafd2ca6e84a",
    "episode_number": 346,
    "segment_number": 8,
    "text": "Очень хорошая техническая сача, где компании действительно... Ну, им дали ноутбук, который по квенте был украден, на нем используются обычные меры защиты для данной компании. По квенте, прости. Ну, по... Короче, им дали ноутбук, их клиент, как если бы ноутбук был украден, понимаешь? Потому что они... То есть, как бы по легенде, по истории. Ну, ты слово такое сказал какое-то, это квенти, что это значит? Ну, я... Давайте я скину в чате квента, квента, бэкграунд, синонимы. Бэк. Я впервые слышу это слово, я его раньше не видела. Ну, есть такое слово квента, ну, то есть, как бы по истории. Так вот, как будто мы тут не задроты, чем мы вообще в подкасте занимаемся? Я впервые это слово вижу, это какое-то явно нерусское слово, это что-то... Откуда оно? Это жаргон ролевиков. Как будто оно заимствованное. Так вот, по квенте ноутбук был украден, и вот этим аудиторам нужно понять, возможно ли иметь этот украденный ноутбук, попавшим в внутреннюю сеть компании. Хорошая техническая статья, рекомендую ее внимательно прочитать. У меня будет краткая выдержка, что в данной конкретной компании было допущено несколько ошибок. Во-первых, они использовали BitLocker, которая... Я не очень специалист по Windows, но вроде как это встроенная шифрования, которая есть в Windows. Ну, как Firewall на Mac. И там есть несколько возможностей шифрования, самое надежное, когда при включении ноутбука тебе нужно ввести пароль, который, собственно, используется для шифрования диска, ну или какая-то производная этого пароля используется. Но возможно также, что диск будет зашифрован паролем, который будет храниться в железе, в специальном чипе, который... TPM-чип, который будет этот пароль как-то отдавать, чтобы диск расшифровывался. Это тоже защита, но от другого. Это, например, для случаев, если... Короче, вот у меня есть ноутбук, я хочу в нём поменять диск. Я беру диск, вынимаю из ноутбука и просто его выбрасываю. Я знаю, что все данные на нём зашифрованы, это никто не расшифрует, потому что ключ, которым данные зашифрованы, он у меня прям в железе. Это тоже защита, но немножко от другого. И в данной конкретной компании использовался именно такой вариант, потому что понятно, неудобно сотрудникам постоянно вводить пароли. А сотрудники у тебя ещё приходят в компанию, увольняются, меняют отделы, меняют железо. Если у каждого компьютера будет вот такой пароль, который нужно где-то записать на бумажке или в Excel, то это неудобно и тоже не супер безопасно на самом деле. Поэтому такого пароля, который ты вводишь прямо перед загрузкой, его нет. И первый этап – атаки. Там, кстати, есть длинный список того, что было сделано правильно. Там был запаролен BIOS, нельзя было загрузиться с флешки, нельзя было загрузиться с неподписанной операционной системы, это настройки Secure Boot, и там ещё несколько списков. В целом оно было настроено окейно. Не считаю вот этой особенности с паролем. Оказывается, что пароль просто передавался от одного чай по другому по SPI, и его можно было сдампить, зная, где к шине подключиться логическим анализатором и зная, где на GitHub найти правильные скрипты. В скриптах были небольшие недоработки, их пришлось ребятам исправить. Но в целом они получили пароль от жесткого диска, они также его сдампили, чтобы хорошая практика в Security Research иметь дамп того, что ты намерен модифицировать. Потому что если система обновится, у тебя уже поменяет состояние того, что ты ломаешь, это неудобно. Оно может стать более Secure, чем было, например. Так вот, этот дамп они загрузили под виртуальной машиной, с помощью пароля расшифровали и получили доступ к файловой системе. Но напомню, их задача была попасть в сеть компании, а на самой файловой системе было мало чего-то полезного. Потому что, по сути, это был почти пустой ноутбук, там нет телеграмм с историей всех сообщений. Там фактически ничего нет. Но там был настроен VPN. Опять же, дофолтными настройками, как в этой компании принято. VPN тоже какой-то очень замороченный. Palo Alto Global Protect. Я так понимаю, это такой VPN-клиент и сервер. Наверное, есть компания Palo Alto Networks. Наверное, это вот от нее. И на самом деле VPN тоже правильно настроен. В том смысле, что тебе в нормальном сценарии нужно запустить VPN-клиент, ввести логин и пароль, и ты после этого получаешь полноценный доступ к внутренней сети. Однако, есть нюанс. Нюанс такой, что вот конкретно в этой реализации VPN-а есть фича, которая позволяет клиенту убедиться в аутентичности сервера. И реализовано это так, что когда ты подключаешься к VPN, еще до логин и пароля и так далее, ты уже подключен к VPN-у с самыми-самыми минимальными правами. То есть, ты как бы в сети, но типа под гостем. И через такую реализацию ты можешь проверить, что сервер имел правильные сертификаты и всякое такое. Вот теперь, когда я убежден, что я подключен к правильному серверу, я вот теперь авторизуюсь. Оказалось, что вот этих минимальных прав их достаточно, чтобы получить доступ к каким-то самбо-шарам. И некоторые из них были не очень правильно настроены. И ребята продемонстрировали, что могут зайти на какой-то чуть ли не сканер, на который можно было писать. И они продемонстрировали, что смотрите, мы туда можем кинуть какую-нибудь PDF-ку, которая в теории может быть трояненая. И дальше понеслась. Вот. Такая вот интересная история. Мне статья очень понравилась. Я узнал пару новых вещей и рекомендую ее к прочтению. Вопросы дополнения. А там не было второго фактора для VPN-клиента? Пароль и какой-то логин? И все? Я не очень понял. И мне кажется, ресерчеры сами в этом не разбирались. Им было достаточно того факта, что просто зная, куда подключаться, ты автоматически оказываешься в сети компании с какими-то минимальными правами. Тебе вроде как, наверное, нужно какой-то сертификат, все-таки на клиентской стороне. Слишком много деталей не приводится. Я спекулирую, что где-то у тебя на диске был специальный файл, который тебе позволяет подключаться к сети, но ты подключаешься с минимальными правами, чтобы их поднять. Вот тут тебе нужен то ли логин, пароль, то ли какой-то токен, какая-то двухфакторка. Но они это даже не смотрели на это. Им было достаточно этих минимальных прав, которые ты получаешь по дефруту. Интересно. Такое чувство, что VPN-клиент какой-то всячный. Это очевидная проблема с этим VPN-клиентом. Если бы они сразу делали какую-то двухфакторку, а потом делали свои проверки. Может быть, это было бы лучше? Я не согласен с этим. Ну, действительно, да. Интересно. Проблема с VPN-клиентом. Ну, и что на самом деле в том, что короче, первая проблема, до того как появляются проблемы с VPN-клиентом, появляются проблемы с тем, что у нас secure boot не такой уж secure, потому что в итоге все это чудесно secure, но и по плате передается как попало. То есть мы наинжинирили криптоключей, без которых у нас ничего не грузится, потом кто-то умный подключился просто проводками к нашей железке и привет. Ну, Валер, я думаю, что ты таксичен. Во-первых, secure boot, я опять же не очень эксперт, в моем понимании, что это штука, которая проверяет, что у тебя образ, это просто система подписана. Во-вторых, BitLocker работает нормально. Он работает ровно так, как ты его настроишь. В данном конкретном случае не было указано, не была выбрана необходимость ввода пользователям паралля от жесткого диска перед загрузкой системы. Да, это ошибка. Я не совсем понимаю, почему это ошибка. Почему я не могу пароль сохранить в том же самом Mac, есть secure enclave. И я так понимаю, что там довольно сильно аппаратная инженерия заморочена, чтобы конфиденциальные данные, это secure enclave, сами по себе не покидали. И короче, я подозреваю, что если, может быть, просто к SPI подключиться на плате и получить приватные данные, то, наверное, что-то пошло не так. Ну, смотри, ты в принципе можешь зашифровать вот этот канал между TPM чипом и кто с ним по SPI общается. И в принципе ты можешь вататься, прошить паралии в железе, чтобы у тебя канал был надежный. Но, во-первых, это дорого делать в embed, и, во-вторых, если ты сделаешь, что у тебя возникают всякие неудобные вопросы, то окей, ты получил ключ. Например, а в памяти ты все равно хранишь расшифрованные блоки из диска, что тебе мешает теперь дампить память? Ну, и всякие такие не очень удобные вопросы. Ну, смотри, короче, что мешает дампить память. Я так понимаю, что чтобы начать дампить память, тебе нужно вначале загрузиться в операционку. Если ты не можешь загрузиться в операционку, потому что не можешь расшифровать жесткий диск, то ты не попадаешь в эту точку, когда ты можешь дампить память. Ну, то есть ты согласен с тем, что нужно просто либо пароль, либо отмечателька пальца, либо что-то, что расшифровывает жесткий диск, вводить явно, а не хранить на компе. В смысле меша везет. Да, но я так понял, что тут еще просто даже... То есть, подожди, я вот еще не понимаю, даже если будет какая-то необходимость... То есть, я не верю, что там вообще Google без пароля. Давай так. Просто я так понимаю, что в Windows BitLocker у него есть как бы прям код диска. Это прям такой, знаешь, не человечеки запоминаемая фраза. Штука это про... Это не какой-то пароль, который задаешь как пользователь. Это UUID, по сути. И вот он, короче, в теории он сохраняется в TPM. По идее, когда ты вводишь пароль в Windows, у тебя происходит обмен с TPM, или... Я уже не совсем уверен, как это работает. Короче, на самом деле ты загружаешься до того, как ты вводишь свой пользователь. Поэтому, по идее, вот эта изначальная загрузка происходит, по идее, автоматом за счет того, что какие-то ключи сохранились в TPM, пока ты был залогинен. И вот по-хорошему у тебя этот обмен ключом между TPM и процессором должен быть безопасно организован, чтобы ты не мог загрузиться до... Чтобы ты даже... Сейчас. Чтобы ты не мог расшифровать диск без того, чтобы... Блин, даже интересно получается, что в Windows это в принципе нормально не работает. Я сейчас так подумал, что ты все равно расшифровываешь диск в какой-то степени. Так нет, оно нормально работает, если у тебя пользователь будет вводить пароль перед загрузкой в систему. Вот да, короче, это как-то в Mac организовано, по сути, потому что у тебя именно твой пароль, как вот пользователь, скажем, Fiscone, ты его будешь вводить в чем-то, что очень похоже на операционную систему, но на самом деле не является полноценно загруженным Mac OS. Ты его вначале вводишь его или отпечаток пальца, и потом уже у тебя все остальное загружается. А в Windows у тебя ты или вынужден вводить эти не человекозапоминаемые bitlocker пароли, я повторюсь, они не человекозапоминаемые, это...",
    "result": {
      "query": "BitLocker TPM защита ноутбука украденный"
    }
  }
]