[
  {
    "segment_id": "c223bfe0-32df-4050-99f3-7ac86fa3efea",
    "episode_id": "2dbe0e1a-cbbc-4005-92b4-c36949116dc6",
    "episode_number": 101,
    "segment_number": 4,
    "text": "И на Azure у них там Linux. И вы могли видеть, они наняли очень крутого чувака из Google, Брэндон Бёрнс, который придумал и сделал Kubernetes. И также они даже выпустили Skype для Linux. Так что теперь, может быть, все смогут пользоваться Skype на Linux без особых проблем. Skype для Linux? Это такая маленькая GUI-окошко, в котором браузер и веб RTC. Так что это такой так себе Skype для Linux. То есть я могу использовать сейчас веб-версию с тем же успехом? Да, наверное. У меня есть такой вопрос. На самом деле он частично от слушателей. Сейчас скажу, Семен Мартынов говорит, что вы сейчас обновитесь и вам всем конец. Это вообще-то нормально для докера. И у нас есть Ваня, который сегодня отсутствует. Но он говорил схожие вещи, что у тебя есть докер, в нем, например, парочка багов. Ты не можешь обновиться на следующей версии, потому что там чего-то немножко поломалось. И это не тянет тебя предлагать обновить еще до следующей версии. То есть там типа было 0.10, на 0.11 нельзя, сразу на 0.12, а в 0.12 еще каких-то багов занесли. Это справедливая критика докера? И если да, то планируется ли с этим что-то делать? Я думаю, вполне справедливо. Как это выразится? Я имею в виду, это вы, разработчики, сидите такие, ну забьем, исправим следующую версию. Или к вам приходит менеджер и говорит, что нет, не правите, в этой версии поправьте в следующей. Я не очень понимаю. Если кто-то приходит и у него есть фикс, и это серьезно, то выпускается минорная версия. Я не могу сказать, что такое прям... Это версия для предыдущей версии, текущая версия, которую используют люди. Если совсем старый докер, то надо обновляться. Давай по-другому сформулируем вопрос. Вот, допустим, у вас есть текущая стабильная версия. Производится ли бэкпорт каких-то багфиксов на предыдущей версии? На какие предыдущие? Те, которые до стабильной версии? У вас одна стабильная версия, вы только ее поддержите. Да, и мы в нее делаем бэкпорт. То есть поддерживается текущая версия и прошлая версия. Окей. Кстати, да, справедливости рай, такие же ситуации, как ты описал, бывают в куче проектов. На моей памяти таких же несколько в Postgres'е происходило. Почему некоторые серьезные продакшены до сих пор сидят на 9.2, 9.3 в Postgres, потому что в 9.4 поломали, в 9.5 починили, но не до конца. В итоге стабильность 9.2 перевешивала новые фичи, которые в 9.3, 9.4, 9.5, только к 6-й починили некоторые аспекты работы с файловой системой. Но это очень редкие вещи. Да, во-первых, это крайне редко, во-вторых, обычно фиксы бэкпортируются до 9.1. Нет, нет, это багфиксы. А здесь был, я вот говорил про какую-то конспектуальную вещь, то есть улучшили работу с файлами, добавили fadvises туда-сюда, и в итоге конспектуально это было не очень правильно. То есть не до конца доделанная штука. За год девелопмент-цикл Postgres не успели это сделать так, как оно должно было быть. Попробовали, но не самый лучший вариант. Вот что-то типа такого. Ну я могу сказать, что сейчас, наверное, со стабильностью докера стало получше, когда компания немного выросла. Конечно, полтора года назад было очень тяжело силами пяти девелоперов оттестировать весь продукт. И как бы не все-то были заинтересованы в том, чтобы его тестировать. То есть мы просылали имейлы всем, кто хотел протестировать, и не сказать, чтобы кто-то хотел тестировать, пока не появилась компания Rancheros, которая очень активно тестировала. И вот Дэрон, ее основатель, мне кажется, его можно благодарить за то, что люди потом не нашли какие-то баги у себя на работе. Потому что люди, я так понимаю, просто берут апдгейт, апгрейд, все, поехали, новый докер. Хотя на самом деле выпускается много релиз-кандидатов, везде это афишируется, но многие люди думают, ну типа это другие ребята, наверное, протестируют. Но, как понимаете, сейчас это проще, потому что у нас уже есть своя инфраструктура, люди, которые могут тестировать, то есть могут на докер 4 Mac накатить, чтобы увидеть какие-то проблемы. Раньше это было пять разработчиков с гитхаб-проектом, то есть пять лэптопов, очень сложно было прямо оттестировать все кейсы. А какого момента у вас было пятеро, то есть я думал, докер это большая контора уже давно. Я думаю, она большая контора где-то, может быть, год сейчас, как она большая. То есть от докера мы знаем года с 2012-2013, да? Да, мне кажется, он с начала 2013 года. То есть вот эти 3-4 года вы оставались командой совсем маленькой? Первый год это вообще там было 4 человека, включая основателя, которые писали код. Потом там начали появляться еще разработчики. Но она довольно долго была не очень большой, пока, видимо, не получили большие инвестиции. Саша, расскажи, как выглядит тестирование сейчас? То есть ты рассказал про альфа-бета период релиза, что теперь уже хватает пользователей, которые тестируют альфа-беты. А есть ли у вас автотесты, это все сидел QA ручной и так далее? Да, конечно, у нас есть. Теперь, когда я пришел, вообще не было ничего. Ну, были интеграционные тесты, юнит-тесты, но их надо было на каждом пул реквесты гонять самому. Но, в принципе, это не было большой проблемой, потому что они занимали 3 минуты. Теперь тесты занимают где-то 60-70 минут, и они запускаются на каждый пул реквест. У нас есть... ну, вы можете зайти в любой пул реквест, посмотреть, там многое проверяется. Есть у нас машина Jenki, которая тестирует просто Linux какой-то. Она выбирает сама и тестирует на нем. Прогоняет интеграционные тесты, юнит-тесты, тесты DockerPi, это API к докеру питоновский. То есть, просто так, на всякий случай. Ну, и, соответственно, пытается скомпилировать под все платформы, то есть, делает Cross-Compile гошный. Также есть машины Windows, которые нам помогают поддерживать Microsoft. Есть машина, которая тестирует Windows Client, она называется Win2Lin, то есть, клиент запускается на Windows. А сервер на Linux. Есть машина Windows там, что-то там, TP6 или что-то такое, которая тестирует, собственно, Docker для Windows, которая запускает Windows контейнеры, там, все серьезно. Есть машины для разных архитектур, чаще всего сейчас используется ARM, то есть, это тестирует Docker на ARM. И есть какая-то там... я не помню, что это за архитектура. Короче, это mainframe, я тоже там тестирую. И все это травит нас имейлами, если это падает. И все такое. То есть, оно запускается на каждый pull-request, и постоянно из мастера собирает все и тоже тестирует. То есть, тестирование довольно-таки обширное, но оно занимает много времени, ну, 60-70 минут. И все-таки проект довольно большой. И такой, скажем, что он использует фичи Linux, которые могут и другие пользователи использовать без участия Docker. И очень сложно предусмотреть все use-cases, которые используют пользователи, например, Rancheros. У них вообще там... то есть, у них есть главный Docker, который запускается вместо Enita. И он запускает у себя там какой-то еще Docker внутри в контейнере, который уже имеет привилегии поменьше. И это вообще суперсложный use-case. И это очень сложно предусмотреть, как люди будут использовать Docker у себя. Руслан, пожалуйста, задавай вопрос. Да, я хотел наполнить. Как раз, по-моему, в Rancheros появился этот баг, что так как Rancheros запускает Docker, по-моему, pidом 1, то у него в Enita, в Go, неинициализировался правильно randomizer, который defrandom, потому что ему самому нужно было его инициализировать потом, позже. Соответственно, генерацию видов, которая была изначально сделана не при запуске программы, а до запуска программы при инициализации, она там поломалась, потому что там в панику вылетало. Саш, расскажи, пожалуйста, мне интересно, какие инструменты разработчика ты используешь. Я имею в виду редактор, отладчик, профайлер, может, какие-то санитайзеры, ну вот это все. Ну, я пишу код в Vim с помощью плагина Vim Go. И я натравливаю некоторые линтеры, которые иногда есть, типа InEffAssign или Unused, чтобы просто посмотреть. Но в основном у нас на всех CI стоят проверки GoFmt, GoLint, GoVet и всякое такое для Go, которые проверяют стиль и ищут какие-то ошибочки. Отладчиком я не пользуюсь, профайлером я пользуюсь GoTool, GoProf. У нас в докере есть специальные урлики из пакета что-то типа PprofHttp стандартного, их можно прицепить, и они будут отдавать профили CPU и memory, и можно к ним подцепиться профайлером и смотреть, что там происходит. Ну и все это дело происходит в консоли, в Tmux. Вот, собственно, и все. Стас, у тебя есть какие-то вопросы? Да, ну вот последнее, за что я хотел поговорить, это Compose, API Compose. Я так понимаю, что вы движетесь в сторону того, что можно сделать какой-нибудь файлик, который описывает кучку контейнеров и как они взаимодействуют с друг с другом. Планируется ли у Compose API, или это в итоге будет смерджено все со свармом и унифицировано? То есть сейчас есть сварм, есть отдельный чуть-чуть композ. Что мне делать, если я хочу запустить пяток контейнеров и программно ими еще управлять, кроме этого? Ну, короче, сварм, который сейчас существует, который называется сварм, скорее всего, это уже прошлое. Он не разрабатывается, он только поддерживается. Будущее за SwarmKit, который встроен в Docker. И вот в Docker есть команда Docker Services, которая сможет запускать много контейнеров. Но помимо этого в Docker появится еще команда Docker Stack, которая будет принимать на вход файлы конфигурации, как раз похожие на Compose, но видимо в JSON. То есть я не уверен, но мне кажется, что в JSON. Ну и это будет похоже на Compose, только более заточено на несколько машин, на кластер. Получается, что в Docker будет встроены Swarm и Compose. А, ну круто. И через Docker Pi можно будет этим управлять. То есть вот, да? Я правильно понимаю? Да, да, будет внешняя API у Docker. Просто вот такой use case, тестирование всякого софта на Network Split и на падение, поднимание нод. Внезапно очень сложно протестировать софт на Network Split на одной машине. То есть вот против... Давай разговаривать со своими словами, на одном маке. На одном маке, да, спасибо, Саша. Именно для этого у меня сейчас стоит виртуалочка, в которой я это гоняю. Хотелось бы, конечно, найти его на маке, но я так понимаю, в маке нет никакой контейнеризации. Ну по идее там есть джейлы. Я вот не знаю, есть ли они джейлы. То есть это как бы fork там по-моему 4.4 bsd, и я не уверен, что там есть джейлы. Они есть? Может что-то пропустило. Я честно говоря не знаю, но скорее всего ты же все равно тестируешь Linux приложения, которые будут запускаться на Linux сервера. Manjale, но вот Manjale мне ничего не говорит, так что скорее всего нет. Вот, ну так вот, такая штука, что когда ты запускаешь много процессов, и ты хочешь там допустим, вот хотим потестить Network Split между процессами, и там возьмем, сделаем там firewall, закроем, то реально сложно, например, отловить порт, который операционка даст. Вот там закрыл один порт, сервис зареконнектился, ему исходящий порт новый назначился, и у тебя там над этим мало контроля. То есть реально это можно сделать в чем-то типа контейнеров, если эта операционка поддерживает. Есть такой проектик от Dell Cloud, Blockade, не знаю слышал ты или нет. Вот они тоже напилили поверх Docker что-то свое, что-то похожее сильно на Compose, но там ты еще можешь прямо вот этому сервису сказать, типа там порви сеточку или там через IP-Route добавь задержку, и вот такие штуки. То есть я так понимаю с выходом с WormKit это можно будет делать просто через питание API? Да, мне кажется можно будет делать через питание API, и более того, мне кажется это уже можно делать в Docker for Mac. То есть Docker for Mac сейчас открыт, можно его скачать и попробовать, и он может делать кластеры, и там вообще версия из ветки мастер. Но в Docker for Mac есть проблема с производительностью I.O. Если много файликов там писать, то оно притормаживает. Ну прикольно. То есть я почему этим так интересуюсь, потому что я вот этот, как раз эту Blockade, ну вот начал какое-то время ее тоже допиливать в NeoFitch и с ребятами списался, но там как достаточно все грустно в том плане, что я так понимаю, ребята фуллтайм работают в Dell, и у них действительно мало там времени остается, чтобы этот проект поддерживать, поэтому там нормально ждать неделю или две какой-то реакции на pull request. Так что скорее всего я попробую сделать, ну не попробую, даже наверное сделаю на WormKit. Если вопросов вот прямо сейчас каких-то горячих нет, я предлагаю дать гостю отдохнуть. Мы уже 45 минут его расспрашиваем, я думаю он немного устал. Вот, Саш, я надеюсь ты поддержишь остальные наши темы.",
    "result": {
      "query": "docker Linux support updates"
    }
  }
]