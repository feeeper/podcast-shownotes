[
  {
    "segment_id": "752b82e1-e397-4e88-a4a7-84846a190471",
    "episode_id": "c43e04a1-e9e8-4b61-a619-b241ba4284d3",
    "episode_number": 80,
    "segment_number": 6,
    "text": "Ты читаешь главы или по ссылкам ходишь? Я читаю, у меня прям pdf открыт, я просто ее когда есть время почитываю. А ты по ссылкам ходишь? И физическое издание включает в себя пейперы? Все в очереди на прочтение. Физическое издание включает пейперы? Да. Офигенно. Я, кстати, этого не знал. Нам же кто-то в комментариях, после того, как ты, Саша, сказал, что книжечка небольшая, на одну pdf, на пару страниц, кто-то пришел в комментарии или в твиттер и полистал эту книжечку в физическом мире. Я пропустил. Но в любом случае, я пока читаю вот эти обзоры, потому что они небольшие, на три странички каждый, и они реально интересные, то есть даже сама по себе, то, что в pdf доступно. Про уровни изоляции в базах данных. Во-первых, с чего начать. Немногие знают, что в базах данных, в современных погонях за скоростью, а не корректностью, по умолчанию используется не-serializable. Напомню, что по стандарту SQL есть четыре уровня. Это read uncommitted, в котором ты читаешь вообще любую фигню, read committed, repeatable read и самый суровый, serializable. В Postgres по умолчанию используется второй снизу, это read committed. При том, он чем отличается от serializable? Тем, что можно наблюдать ряд феноменов. Например, две последовательные select команды, то есть ты делаешь select, потом заново делаешь select, они могут вообще давать разные результаты, даже в одной транзакции. То есть понимаем, это в Postgres по дефолту, если вы не указали другой уровень изоляции. Авторы, как минимум, сообщают, что далеко не все программисты об этом знают. Из наших слушателей поднимите руки, и удивляются, как вообще у нас работают банковские системы, покупка авиабилетов и так далее в таких условиях, почему не все разваливается. Основной ответ на этот вопрос, по их мнению, в наиболее вероятном смысле, в том, что, наверное, у нас пока что не такой высокий уровень конкарнси в наших системах, чтобы эти эффекты достаточно часто проявлялись. А вообще, если уровень конкарнси будет увеличиваться, все начнет разъезжаться и будет более и более часто появляться конкурент. И, конечно, в нашем системе с NoSQL 9.1 честного Serializable не было вообще. Был только repeatable read. Только начиная с 9.2 появился Serializable. И еще интересное наблюдение. Мне оно больше всего понравилось. Когда начался этот бум NoSQL баз данных, то люди часто говорили, что нам не нужны транзакции, что это сюрприз. Вы не использовали транзакции, вы об этом знали? Я бы не сказал, что они не используют транзакции. Я бы сказал, что они не используют... То есть, транзакции есть, но у них низкий уровень изоляции. Мне кажется, это корректно говорить. Ну, хорошо, да, согласен. Но все, конечно, не так плохо. Можно включить Serializable и по оценкам в той же главе все начнет работать в раза 3 медленнее, но зато корректно. Будет проходить вот этот банковский тест. На самом деле у нас есть как бы Snapshot Isolation, который сейчас, в принципе, можно включить по умолчанию. Он, конечно, медленнее, чем Raid Committed. И он не идеально сериализуемый, но в нем почти нет аномалий. Те, которые есть, очень легко бороть. Другой момент, есть еще его развитие, называется Serializable Snapshot Isolation. И, насколько я понимаю, вот оно честно Serializable. То есть, оно не подвержено никаким аномалиям, там приводится как раз эта статья, цитирует, что была работа какого-то товарища, которая классифицировала все эти уровни изоляции по наблюдаемым аномалиям. И есть такой проект, Hermitage, кажется, или Hermitage, POMC Hermitage, который тестирует разные базы данных. И мне кажется, у них что-то такое тестировалось, которое SSA использует. И, по-моему, SSA никаких аномалий не предъявляет. Я могу ошибаться, но я помню в той же главе в Oracle по умолчанию используется не Serializable, а вот этот самый Snapshot Isolation, который на самом деле более слабая гарантия и имеет феномены. Так что, как в этом мире вообще что-то работает, я лично не знаю. Ну, то есть, колхоз доктрина, фигак-фигак F-production, вот это все. Потом удивляемся. Коммит, коммит и транзакшн. Следующая маленькая темка, я ее давно хотел упомянуть. Я тут пытался честно выяснить, вот честно, чем libEvent отличается от libUV. То есть, и та, и другая, они работают подо все. То есть, под Linux, Mac и Windows. Извини, перебью, я слышал мнение, что обе говно. Так, и? Это все? Это все, да. Принято к сведению, спасибо. Это для, там, вообще, чуть ли не клиентского кода, и, мол, на сервере это только там, вообще, только полный идиот использует, или всякие, ну, JS-ники, которым в один трет.",
    "result": {
      "query": "уровни изоляции баз данных PostgreSQL default"
    }
  }
]